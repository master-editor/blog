{"id":7423,"date":"2021-10-25T23:44:35","date_gmt":"2021-10-25T18:14:35","guid":{"rendered":"https:\/\/www.middlewareinventory.com\/?p=7423"},"modified":"2022-01-01T14:59:42","modified_gmt":"2022-01-01T09:29:42","slug":"ansible-selectattr-example","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/","title":{"rendered":"Ansible selectattr Example &#8211; Filter dictionary and select matching item"},"content":{"rendered":"<p>Ansible selectattr filter is to select matching objects\u00a0 from the dictionary by applying a test across all the objects in a dictionary\/sequence.<\/p>\n<p>Ansible selectattr filter is basically an inherited version of Jinja <code>selectattr<\/code> filter.\u00a0 As Ansible Quotes in their documentation besides the built-in Ansible filters, all JINJA2 filters can be used in Ansible playbooks.<\/p>\n<p>Be informed that, Only Ansible 2.7+ with Jinja2 supports the <code>selectattr<\/code> for those who are not there yet, you can use <a href=\"https:\/\/www.middlewareinventory.com\/blog\/ansible_json_query\/\">ansible json_query. Here is our article that can help<\/a><\/p>\n<p>To see what version of ansible that you are using and what version of JINJA does it support you can use the <code>ansible &#8211; version<\/code> command<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"generic\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">\u21d2 ansible &#8211; version | grep \"jinja\"\r\n  jinja version = 3.0.2<\/pre>\n<p>In the preceding output you can see that my ansible supports Jinja <code>3.0.2<\/code><\/p>\n<p>Having said that. Let&#8217;s go ahead in to our today topic.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr.png\"><img class=\"post-img alignnone wp-image-7431 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr.png\" alt=\"ansible select_attr\" width=\"1748\" height=\"1240\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr.png 1748w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr-300x213.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr-1024x726.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr-768x545.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr-1536x1090.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr-90x65.png 90w\" sizes=\"(max-width: 1748px) 100vw, 1748px\" \/><\/a><\/p>\n<h2>List of Objects \/ Dictionary we are going to use<\/h2>\n<p>Consider the following dataset<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"yaml\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">[\r\n    {\r\n      \"name\": \"Shanmugam\",\r\n      \"gender\": \"male\",\r\n      \"mobile\": \"9875643210\",\r\n      \"dose1completed\" : \"yes\",\r\n      \"dose2completed\" : \"yes\",\r\n      \"age\": \"25\",\r\n      \"city\": \"pudukottai\",\r\n      \"state\": \"Tamilnadu\"\r\n    },\r\n    {\r\n      \"name\": \"Lakshmi\",\r\n      \"gender\": \"female\",\r\n      \"mobile\": \"9875623410\",\r\n      \"dose1completed\" : \"yes\",\r\n      \"dose2completed\" : \"no\",\r\n      \"age\": \"32\",\r\n      \"city\": \"Chennai\",\r\n      \"state\": \"Tamilnadu\"\r\n    },\r\n    {\r\n      \"name\": \"Albert\",\r\n      \"gender\": \"male\",\r\n      \"mobile\": \"9875634510\",\r\n      \"dose1completed\" : \"yes\",\r\n      \"dose2completed\" : \"yes\",\r\n      \"age\": \"65\",\r\n      \"city\": \"Coimbatore\",\r\n      \"state\": \"Tamilnadu\"\r\n    },\r\n    {\r\n      \"name\": \"Abdul\",\r\n      \"gender\": \"male\",\r\n      \"mobile\": \"9875632341\",\r\n      \"dose1completed\" : \"no\",\r\n      \"dose2completed\" : \"no\",\r\n      \"age\": \"45\",\r\n      \"city\": \"Hosur\",\r\n      \"state\": \"Tamilnadu\"\r\n    }\r\n]<\/pre>\n<p>&nbsp;<\/p>\n<p>It is a list of objects\/dictionary with few fields about the vaccination status and personal details of individuals.<\/p>\n<p>On a side note, If you have not vaccinated yet. Please do it. Vaccination is our only hope now.<\/p>\n<p>Back to the subject.<\/p>\n<p>this is a sample dataset I have taken with 4 objects\/persons but you can add more if you would like to.<\/p>\n<p>From this dataset, Let us create some statistics of<\/p>\n<ul>\n<li>individuals with in age group of 18 to 45<\/li>\n<li>individuals with age group 45 and above<\/li>\n<li>who are yet to put their second dose of vaccination<\/li>\n<li>people who are not vaccinated at all<\/li>\n<li>who are living in red zone ( based on the active cases)<\/li>\n<li>who are living in green zone<\/li>\n<li>People who are living in cities<\/li>\n<\/ul>\n<p>you can create N number of stats based on this dataset. but how it is related to our ansible selectattr filter.<\/p>\n<p>we are going to use ansible <code>selectattr<\/code> function to create these assertions\/stats.<\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<p>&nbsp;<\/p>\n<h2>Ansible Playbook with selectattr filter<\/h2>\n<p>Here is a playbook with ansible selectattr filter which creates these various stats for us.<\/p>\n<p>we have used some nice formatting in the playbook using <code>debug<\/code> module and <code>msg<\/code><\/p>\n<p>The complete playbook runs on <code>localhost<\/code> and has only one task with some variable declaration and printing on the same place.<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"yaml\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">---\r\n - name: selectattr example - Vaccination Report\r\n   hosts: localhost\r\n   tasks:\r\n    -  name: debug\r\n       vars:\r\n          - userdata: [\r\n                        {\r\n                          \"name\": \"Shanmugam\",\r\n                          \"gender\": \"male\",\r\n                          \"mobile\": \"9875643210\",\r\n                          \"dose1completed\" : \"yes\",\r\n                          \"dose2completed\" : \"yes\",\r\n                          \"age\": \"25\",\r\n                          \"city\": \"pudukottai\",\r\n                          \"state\": \"Tamilnadu\"\r\n                        },\r\n                        {\r\n                          \"name\": \"Lakshmi\",\r\n                          \"gender\": \"female\",\r\n                          \"mobile\": \"9875623410\",\r\n                          \"dose1completed\" : \"yes\",\r\n                          \"dose2completed\" : \"no\",\r\n                          \"age\": \"32\",\r\n                          \"city\": \"Chennai\",\r\n                          \"state\": \"Tamilnadu\"\r\n                        },\r\n                        {\r\n                          \"name\": \"Albert\",\r\n                          \"gender\": \"male\",\r\n                          \"mobile\": \"9875634510\",\r\n                          \"dose1completed\" : \"yes\",\r\n                          \"dose2completed\" : \"yes\",\r\n                          \"age\": \"65\",\r\n                          \"city\": \"Coimbatore\",\r\n                          \"state\": \"Tamilnadu\"\r\n                        },\r\n                        {\r\n                          \"name\": \"Abdul\",\r\n                          \"gender\": \"male\",\r\n                          \"mobile\": \"9875632341\",\r\n                          \"dose1completed\" : \"no\",\r\n                          \"dose2completed\" : \"no\",\r\n                          \"age\": \"45\",\r\n                          \"city\": \"Hosur\",\r\n                          \"state\": \"Tamilnadu\"\r\n                        },\r\n                      ]\r\n          - agegroup18to45: \"{{ userdata | selectattr('age','&gt;=','18') | selectattr('age','&lt;=','45'  ) }}\"\r\n          - agegroup45above: \"{{ userdata | selectattr('age','gt','45')  }}\"\r\n          - dose2pending: \"{{ userdata | selectattr('dose2completed','==','no') | selectattr('dose1completed','eq','yes') }}\"\r\n          - nonvaccinated: \"{{ userdata | selectattr('dose1completed','equalto','no')}}\"\r\n          - redzoneresidents: \"{{ userdata | selectattr('city','in','Coimbatore,Chennai')}}\"\r\n          - greenzoneresidents: \"{{ userdata | rejectattr('city','in','Coimbatore,Chennai')}}\"\r\n          - cityresidents: \"{{ userdata | selectattr('city','in','Coimbatore,Chennai')}}\"\r\n       debug: \r\n          msg:\r\n          - \"-------------------\" \r\n          - \"Age Group 18 to 45\"\r\n          - \"-------------------\"\r\n          - \"{{agegroup18to45}}\"\r\n          - \"-------------------\"\r\n          - \"-------------------\" \r\n          - \"Age Group 45 Above\"\r\n          - \"-------------------\"\r\n          - \"{{agegroup45above}}\"\r\n          - \"-------------------\"\r\n          - \"-------------------\" \r\n          - \"Second dose pending\"\r\n          - \"-------------------\"\r\n          - \"{{dose2pending}}\"\r\n          - \"-------------------\" \r\n          - \"Yet to Vaccinate\"\r\n          - \"-------------------\"\r\n          - \"{{nonvaccinated}}\"\r\n          - \"-------------------\" \r\n          - \"Containment Zone\"\r\n          - \"-------------------\"\r\n          - \"{{redzoneresidents}}\"\r\n          - \"-------------------\" \r\n          - \"Non Containment Zone\"\r\n          - \"-------------------\"\r\n          - \"{{greenzoneresidents}}\"\r\n          - \"-------------------\" \r\n          - \"Urbanites\"\r\n          - \"-------------------\"\r\n          - \"{{greenzoneresidents}}\"\r\n\r\n\r\n\r\n              \r\n\r\n<\/pre>\n<p>Since the variables are created in the sequential order, we are able to do our all our data processing right in the <code>vars<\/code> section itself<\/p>\n<p>except the <code>userdata<\/code> variable all other variables are used to create our stats reports.<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"json\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">- agegroup18to45: \"{{ userdata | selectattr('age','&gt;=','18') | selectattr('age','&lt;=','45'  ) }}\"\r\n- agegroup45above: \"{{ userdata | selectattr('age','gt','45')  }}\"\r\n- dose2pending: \"{{ userdata | selectattr('dose2completed','==','no') | selectattr('dose1completed','eq','yes') }}\"\r\n- nonvaccinated: \"{{ userdata | selectattr('dose1completed','equalto','no')}}\"\r\n- redzoneresidents: \"{{ userdata | selectattr('city','in','Coimbatore,Chennai')}}\"\r\n- greenzoneresidents: \"{{ userdata | rejectattr('city','in','Coimbatore,Chennai')}}\"\r\n- cityresidents: \"{{ userdata | selectattr('city','in','Coimbatore,Chennai')}}\"<\/pre>\n<p>In every single variable declaration we are using <code>selectattr<\/code> except the second last <code>greenzoneresidents<\/code> there we are using <code>rejectattr<\/code> just to give you a perspective<\/p>\n<p>The Syntax of Ansible selectattr filter consists of three elements<\/p>\n<ul>\n<li>attribute in an object or operand<\/li>\n<li>comparison operator or test<\/li>\n<li>value to compare with<\/li>\n<\/ul>\n<pre>selectattr('variable\/attribute in an object','comparison operator \/ tests','Value to compare with')<\/pre>\n<p>Read more about <a href=\"https:\/\/jinja.palletsprojects.com\/en\/3.0.x\/templates\/#comparisons\">comparison operators in Jinja2 here<\/a> like <code>==, !=, &gt;, &lt;<\/code> \u00a0etc<\/p>\n<p>Read more about <a href=\"https:\/\/jinja.palletsprojects.com\/en\/3.0.x\/templates\/#list-of-builtin-tests\">tests in Jinja2 here<\/a> like <code>eq, ne, ge, gt, in, not<\/code> etc<\/p>\n<p>In most cases the test and comparison operator do the same operation i.e <code>eq<\/code> and <code>==<\/code><\/p>\n<p>We are printing all the variables we have created dynamically just now within the <code>vars<\/code> section with <code>msg<\/code> block with nice formatting<\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<p>&nbsp;<\/p>\n<h2>Execute and Validate the output<\/h2>\n<p>Here is the execution output of the playbook for your reference.<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"yaml\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">Ansible|\u21d2 ansible-playbook selectattr-ex1.yml\r\n[WARNING]: No inventory was parsed, only implicit localhost is available\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nPLAY [selectattr example] ***************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [debug] ****************************************************************************************************************************************************************\r\nok: [localhost] =&gt; {\r\n    \"msg\": [\r\n        \"-------------------\",\r\n        \"Age Group 18 to 45\",\r\n        \"-------------------\",\r\n        [\r\n            {\r\n                \"age\": \"25\",\r\n                \"city\": \"pudukottai\",\r\n                \"dose1completed\": \"yes\",\r\n                \"dose2completed\": \"yes\",\r\n                \"gender\": \"male\",\r\n                \"mobile\": \"9875643210\",\r\n                \"name\": \"Shanmugam\",\r\n                \"state\": \"Tamilnadu\"\r\n            },\r\n            {\r\n                \"age\": \"32\",\r\n                \"city\": \"Chennai\",\r\n                \"dose1completed\": \"yes\",\r\n                \"dose2completed\": \"no\",\r\n                \"gender\": \"female\",\r\n                \"mobile\": \"9875623410\",\r\n                \"name\": \"Lakshmi\",\r\n                \"state\": \"Tamilnadu\"\r\n            },\r\n            {\r\n                \"age\": \"45\",\r\n                \"city\": \"Hosur\",\r\n                \"dose1completed\": \"no\",\r\n                \"dose2completed\": \"no\",\r\n                \"gender\": \"male\",\r\n                \"mobile\": \"9875632341\",\r\n                \"name\": \"Abdul\",\r\n                \"state\": \"Tamilnadu\"\r\n            }\r\n        ],\r\n        \"-------------------\",\r\n        \"-------------------\",\r\n        \"Age Group 45 Above\",\r\n        \"-------------------\",\r\n        [\r\n            {\r\n                \"age\": \"65\",\r\n                \"city\": \"Coimbatore\",\r\n                \"dose1completed\": \"yes\",\r\n                \"dose2completed\": \"yes\",\r\n                \"gender\": \"male\",\r\n                \"mobile\": \"9875634510\",\r\n                \"name\": \"Albert\",\r\n                \"state\": \"Tamilnadu\"\r\n            }\r\n        ],\r\n        \"-------------------\",\r\n        \"-------------------\",\r\n        \"Second dose pending\",\r\n        \"-------------------\",\r\n        [\r\n            {\r\n                \"age\": \"32\",\r\n                \"city\": \"Chennai\",\r\n                \"dose1completed\": \"yes\",\r\n                \"dose2completed\": \"no\",\r\n                \"gender\": \"female\",\r\n                \"mobile\": \"9875623410\",\r\n                \"name\": \"Lakshmi\",\r\n                \"state\": \"Tamilnadu\"\r\n            }\r\n        ],\r\n        \"-------------------\",\r\n        \"Yet to Vaccinate\",\r\n        \"-------------------\",\r\n        [\r\n            {\r\n                \"age\": \"45\",\r\n                \"city\": \"Hosur\",\r\n                \"dose1completed\": \"no\",\r\n                \"dose2completed\": \"no\",\r\n                \"gender\": \"male\",\r\n                \"mobile\": \"9875632341\",\r\n                \"name\": \"Abdul\",\r\n                \"state\": \"Tamilnadu\"\r\n            }\r\n        ],\r\n        \"-------------------\",\r\n        \"Containment Zone\",\r\n        \"-------------------\",\r\n        [\r\n            {\r\n                \"age\": \"32\",\r\n                \"city\": \"Chennai\",\r\n                \"dose1completed\": \"yes\",\r\n                \"dose2completed\": \"no\",\r\n                \"gender\": \"female\",\r\n                \"mobile\": \"9875623410\",\r\n                \"name\": \"Lakshmi\",\r\n                \"state\": \"Tamilnadu\"\r\n            },\r\n            {\r\n                \"age\": \"65\",\r\n                \"city\": \"Coimbatore\",\r\n                \"dose1completed\": \"yes\",\r\n                \"dose2completed\": \"yes\",\r\n                \"gender\": \"male\",\r\n                \"mobile\": \"9875634510\",\r\n                \"name\": \"Albert\",\r\n                \"state\": \"Tamilnadu\"\r\n            }\r\n        ],\r\n        \"-------------------\",\r\n        \"Non Containment Zone\",\r\n        \"-------------------\",\r\n        [\r\n            {\r\n                \"age\": \"25\",\r\n                \"city\": \"pudukottai\",\r\n                \"dose1completed\": \"yes\",\r\n                \"dose2completed\": \"yes\",\r\n                \"gender\": \"male\",\r\n                \"mobile\": \"9875643210\",\r\n                \"name\": \"Shanmugam\",\r\n                \"state\": \"Tamilnadu\"\r\n            },\r\n            {\r\n                \"age\": \"45\",\r\n                \"city\": \"Hosur\",\r\n                \"dose1completed\": \"no\",\r\n                \"dose2completed\": \"no\",\r\n                \"gender\": \"male\",\r\n                \"mobile\": \"9875632341\",\r\n                \"name\": \"Abdul\",\r\n                \"state\": \"Tamilnadu\"\r\n            }\r\n        ],\r\n        \"-------------------\",\r\n        \"Urbanites\",\r\n        \"-------------------\",\r\n        [\r\n            {\r\n                \"age\": \"25\",\r\n                \"city\": \"pudukottai\",\r\n                \"dose1completed\": \"yes\",\r\n                \"dose2completed\": \"yes\",\r\n                \"gender\": \"male\",\r\n                \"mobile\": \"9875643210\",\r\n                \"name\": \"Shanmugam\",\r\n                \"state\": \"Tamilnadu\"\r\n            },\r\n            {\r\n                \"age\": \"45\",\r\n                \"city\": \"Hosur\",\r\n                \"dose1completed\": \"no\",\r\n                \"dose2completed\": \"no\",\r\n                \"gender\": \"male\",\r\n                \"mobile\": \"9875632341\",\r\n                \"name\": \"Abdul\",\r\n                \"state\": \"Tamilnadu\"\r\n            }\r\n        ]\r\n    ]\r\n}\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************************\r\nlocalhost                  : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0<\/pre>\n<p>&nbsp;<\/p>\n<h2>Realtime Example for Ansible selectattr &#8211; AWS EFS report<\/h2>\n<p>The playbook we have designed earlier in this article, is designed to cover all the usage of <code>selectattr<\/code>\u00a0 however we thought of giving one more realtime example.<\/p>\n<p>This playbook we have written a while ago to create AWS EFS report can serve as a one best real time example of <code>selectattr<\/code> along with <code>map<\/code> filters. Do take a look.<\/p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"WJGOlN3ciP\"><p><a href=\"https:\/\/www.middlewareinventory.com\/blog\/collect-efs-ec2-ansible\/\">Find EC2 instances using EFS &#8211; EFS Usage Report<\/a><\/p><\/blockquote>\n<p><iframe class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" title=\"&#8220;Find EC2 instances using EFS &#8211; EFS Usage Report&#8221; &#8212; Middleware Inventory\" src=\"https:\/\/www.middlewareinventory.com\/blog\/collect-efs-ec2-ansible\/embed\/#?secret=WJGOlN3ciP\" data-secret=\"WJGOlN3ciP\" width=\"600\" height=\"338\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"><\/iframe><\/p>\n<p>&nbsp;<\/p>\n<h2>Difference between Ansible Select and Selectattr (Additional)<\/h2>\n<p>Though this is not in the objective of this article, I wanted to go little deeper to give some clarity on this topic<\/p>\n<p>As I have mentioned in the beginning, All Jinja2 filters can be used in Ansible.<\/p>\n<p>Having said that, there are two filters named <code>select<\/code> and <code>selectattr<\/code>\u00a0 in jinja2 so does in ansible.<\/p>\n<p>So how they are different and where to use them. ?<\/p>\n<p>Both these filters helps to filter an object from a sequence or list<\/p>\n<p>One difference is that<\/p>\n<p><code>select<\/code> Filters a sequence of objects <strong><span style=\"color: #800000;\">by applying a test to each object<\/span><\/strong>, and only selecting the objects with the test succeeding.<\/p>\n<p><code>selectattr<\/code> Filters a sequence of objects<span style=\"color: #003366;\"><strong> by applying a test to the specified attribute of each object<\/strong><\/span>, and only selecting the objects with the test succeeding.<\/p>\n<p>the difference here is selectattr\u00a0 runs a test on a specific attribute of the object while the select does it on the object itself.<\/p>\n<p>The elements inside the list\/sequence would have attributes only when they are <code>dictionary<\/code>\u00a0 or proper object.<\/p>\n<pre>numbers: ['10','20','30']<\/pre>\n<p>&nbsp;<\/p>\n<p>the preceding list <code>numbers<\/code>\u00a0 does not ( cannot) have any attributes so here you can use <code>select<\/code> to run any test on the elements directly<\/p>\n<p>the following JINJA2 snippet would print numbers <code>greater than or equal to 20<\/code>\u00a0which is directly applied on the elements of list<\/p>\n<div>\n<pre>\"{{ numbers | select('ge','20') }}\"<\/pre>\n<\/div>\n<p>So the verdict here is that<\/p>\n<ul>\n<li><code>select<\/code> is to filter elements\/objects of a simple list\u00a0 <code>[x,y,z,1,2,3]<\/code><\/li>\n<li><code>selectattr<\/code> is to filter elements\/objects of list with nested objects <code>[{},{},{}]<\/code><\/li>\n<\/ul>\n<p>Here is the quick playbook for you to understand this practically<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"yaml\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">---\r\n- name: filter test\r\n  hosts: localhost\r\n  vars: \r\n    numbers: ['10','20','30']\r\n    names: [ \r\n      {\r\n        \"first\": \"Sarav\",\r\n        \"last\": \"AK\",\r\n        \"mobile\": \"+919876543210\",\r\n        \"ctc\": \"200000\",\r\n        \"address\": {\r\n          \"city\": \"Chennai\",\r\n          \"country\": \"India\"\r\n        }\r\n\r\n      }]\r\n  tasks:\r\n    - name: Ansible Select vs SelectAttr\r\n      debug: \r\n        msg: \r\n          - \"===========================\"\r\n          - \"With SelectAttr - Filter using Attribute name of Object\"\r\n          - \"===========================\"\r\n          - '{{ names | selectattr(\"first\", \"eq\", \"Sarav\")}}'\r\n          - \"\"\r\n          - \"===========================\"\r\n          - \"With Select - We are filtering using regex as the elements of list are treated as a normal string not as object\/dict\"\r\n          - \"===========================\"\r\n          - '{{ names | select(\"match\", \".+first.+:.+Sarav.+\")}}'\r\n          - \"\"\r\n          - \"===========================\"\r\n          - \"With Select - Rule is directly applied on the Object\"\r\n          - \"===========================\"\r\n          - \"{{ numbers | select('ge','20') }}\"\r\n<\/pre>\n<p>Output of this playbook is given below as an image<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Screenshot-2021-11-21-at-12.19.53-AM.png\"><img class=\"post-img alignnone wp-image-7465 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Screenshot-2021-11-21-at-12.19.53-AM.png\" alt=\"Ansible Select vs Selectattr\" width=\"3082\" height=\"2154\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Screenshot-2021-11-21-at-12.19.53-AM.png 3082w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Screenshot-2021-11-21-at-12.19.53-AM-300x210.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Screenshot-2021-11-21-at-12.19.53-AM-1024x716.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Screenshot-2021-11-21-at-12.19.53-AM-768x537.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Screenshot-2021-11-21-at-12.19.53-AM-1536x1074.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Screenshot-2021-11-21-at-12.19.53-AM-2048x1431.png 2048w\" sizes=\"(max-width: 3082px) 100vw, 3082px\" \/><\/a><\/p>\n<h2><\/h2>\n<h2>Conclusion<\/h2>\n<p>Hope this article helps you understand the Ansible selectattr filter and how to use it\u00a0 along with few other subtopics like<\/p>\n<ul>\n<li>How to Pretty print or do formatting in Ansible Debug<\/li>\n<li>How to do inversive action with <code>rejectattr<\/code><\/li>\n<li>How to use Jinja2 Comparison operators and tests in Ansible filters<\/li>\n<li>What is Ansible Select and Selectattr and difference between them<\/li>\n<li>Realtime example of Ansible Selectattr with EFS<\/li>\n<\/ul>\n<p>If you have any more questions or feed back please free to update on the comments section<\/p>\n<p>If you are looking for any Professional Support in Devops\/SRE\/Cloud Consider <a href=\"https:\/\/gritfy.com\">Gritfy<\/a><\/p>\n<a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\"><img class=\"post-img\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\" alt=\"gritfy\" width=\"1047\" height=\"415\" class=\"alignnone size-full wp-image-6623\" \/><\/a>\n<p>&nbsp;<\/p>\n<p>Cheers<br \/>\nRumen Lishkov<\/p>\n<div id=\"postfollow\">\r\n<a href='https:\/\/ko-fi.com\/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='https:\/\/az743702.vo.msecnd.net\/cdn\/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' \/><\/a>\r\n<p>Follow us on<a href=\"http:\/\/www.facebook.com\/middlewareinventory\">Facebook<\/a> or<a href=\"http:\/\/www.twitter.com\/mwinventory\">Twitter<\/a>\r\n<\/br>\r\nFor more practical videos and tutorials. <a href=\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw?sub_confirmation=1\">Subscribe to our channel<\/a>\r\n<\/br>\r\nFollow me on Linkedin <a href=\"https:\/\/www.linkedin.com\/comm\/mynetwork\/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=saravakmwinventory\">My Profile<\/a>\r\n<\/br>\r\n<\/i>For any Consultation or to hire us <a href=\"mailto:rumenlishkoff@gmail.com\"> rumenlishkoff@gmail.com<\/a>\r\n<\/br>\r\nIf you like this article. Show your Support! <a href=\"https:\/\/ko-fi.com\/middlewareinventory\">Buy me a Coffee.<\/a>\r\n<\/br>\r\n<\/p>\r\n<p style=\"color: palevioletred !important;\">Signup for Exclusive \"Subscriber-only\" Content<\/p>\r\n\n\t\t<div class=\"emaillist\">\n\t\t\t<form action=\"#\" method=\"post\" class=\"es_subscription_form es_shortcode_form\" id=\"es_subscription_form_1670576925\" data-source=\"ig-es\">\n\t\t\t\t\t\t\t\t<div class=\"es-field-wrap\"><label>Name*<br \/><input type=\"text\" name=\"name\" class=\"ig_es_form_field_name\" placeholder=\"\" value=\"\" required=\"required\" \/><\/label><\/div><div class=\"es-field-wrap\"><label>Email*<br \/><input class=\"es_required_field es_txt_email ig_es_form_field_email\" type=\"email\" name=\"email\" value=\"\" placeholder=\"\" required=\"required\" \/><\/label><\/div><input type=\"hidden\" name=\"lists[]\" value=\"1\" \/><input type=\"hidden\" name=\"form_id\" value=\"3\" \/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page\" value=\"7423\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page_url\" value=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"status\" value=\"Unconfirmed\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es-subscribe\" id=\"es-subscribe\" value=\"7aebfb1a9b\"\/>\n\t\t\t\t<label style=\"position:absolute;top:-99999px;left:-99999px;z-index:-99;\"><input type=\"email\" name=\"es_hp_email\" class=\"es_required_field\" tabindex=\"-1\" autocomplete=\"-1\" value=\"\"\/><\/label>\n\t\t\t\t\t\t\t\t<input type=\"submit\" name=\"submit\" class=\"es_subscription_form_submit es_submit_button es_textbox_button\" id=\"es_subscription_form_submit_1670576925\" value=\"Subscribe\"\/>\n\n\t\t\t\t\n\t\t\t\t<span class=\"es_spinner_image\" id=\"spinner-image\"><img src=\"https:\/\/www.middlewareinventory.com\/wp-content\/plugins\/email-subscribers\/lite\/public\/images\/spinner.gif\" alt=\"Loading\"\/><\/span>\n\n\t\t\t<\/form>\n\n\t\t\t<span class=\"es_subscription_message\" id=\"es_subscription_message_1670576925\"><\/span>\n\t\t<\/div>\n\n\t\t\r\n<\/div>\r\n<hr>\n","protected":false},"excerpt":{"rendered":"<p>Ansible selectattr filter is to select matching objects\u00a0 from the dictionary by applying a test across all the objects in a dictionary\/sequence. Ansible selectattr filter is basically an inherited version of Jinja selectattr filter.\u00a0 As Ansible Quotes in their documentation besides the built-in Ansible filters, all JINJA2 filters can be[&#8230;]<\/p>\n","protected":false},"author":1,"featured_media":7431,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[98],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Ansible selectattr Example - Filter dictionary and select matching item<\/title>\n<meta name=\"description\" content=\"Ansible Selectattr example. Filter and Select items from Ansible dictionary using selectattr example. How to select attributes from Ansible dictorinary.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Ansible selectattr Example - Filter dictionary and select matching item\" \/>\n<meta property=\"og:description\" content=\"Ansible Selectattr example. Filter and Select items from Ansible dictionary using selectattr example. How to select attributes from Ansible dictorinary.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2021-10-25T18:14:35+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-01-01T09:29:42+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr.png\" \/>\n\t<meta property=\"og:image:width\" content=\"1748\" \/>\n\t<meta property=\"og:image:height\" content=\"1240\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/Ansible_select_attr.png\",\"width\":1748,\"height\":1240,\"caption\":\"ansible select_attr\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/\",\"name\":\"Ansible selectattr Example - Filter dictionary and select matching item\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/#primaryimage\"},\"datePublished\":\"2021-10-25T18:14:35+00:00\",\"dateModified\":\"2022-01-01T09:29:42+00:00\",\"description\":\"Ansible Selectattr example. Filter and Select items from Ansible dictionary using selectattr example. How to select attributes from Ansible dictorinary.\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\"},\"headline\":\"Ansible selectattr Example &#8211; Filter dictionary and select matching item\",\"datePublished\":\"2021-10-25T18:14:35+00:00\",\"dateModified\":\"2022-01-01T09:29:42+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/#webpage\"},\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/#primaryimage\"},\"articleSection\":\"Ansible\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/ansible-selectattr-example\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\",\"name\":\"Rumen Lishkov\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g\",\"caption\":\"Rumen Lishkov\"}}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/7423"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=7423"}],"version-history":[{"count":5,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/7423\/revisions"}],"predecessor-version":[{"id":7467,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/7423\/revisions\/7467"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media\/7431"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=7423"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=7423"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=7423"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}