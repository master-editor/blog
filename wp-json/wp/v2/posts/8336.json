{"id":8336,"date":"2022-04-23T17:01:29","date_gmt":"2022-04-23T11:31:29","guid":{"rendered":"https:\/\/www.middlewareinventory.com\/?p=8336"},"modified":"2022-04-23T22:13:33","modified_gmt":"2022-04-23T16:43:33","slug":"aws-pulumi-ebs-example","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/","title":{"rendered":"Clone EBS Volumes between AWS EC2 with Pulumi  | Devops Junction"},"content":{"rendered":"<p>I had an Infrastructure as an automation requirement recently, where <strong>I had to create a solution that will find EBS volumes attached to an EC2 instance and create snapshots of the same and clone it and attach these cloned volumes to another EC2 instance.<\/strong><\/p>\n<p>I know it was a little complex to put in a single sentence. Let&#8217;s go once again<\/p>\n<p>Requirement is to<\/p>\n<ol>\n<li>Scan the Source EC2 instance and find the EBS volumes attached<\/li>\n<li>Create Snapshots ( Copy ) for all the EBS Volumes found<\/li>\n<li>Using the Snapshot, create a new EBS Volumes ( Clone )<\/li>\n<li>Attach the newly created Clone EBS Volumes to the Target EC2 instance<\/li>\n<\/ol>\n<p>I did start with Terraform and spent some time and noticed it was a little complex as usual.<\/p>\n<p>No question that Terraform is highly customizable and I am a big fan of it too.<\/p>\n<p>However, I was looking for another option and wanted to give it a try for <a href=\"https:\/\/pulumi.com\">pulumi<\/a> A Modern Infrastructure as Code.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction.jpg\"><img class=\"post-img alignnone wp-image-8358 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction.jpg\" alt=\"AWS Pulumi\" width=\"1748\" height=\"1240\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction.jpg 1748w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction-300x213.jpg 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction-1024x726.jpg 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction-768x545.jpg 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction-1536x1090.jpg 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction-90x65.jpg 90w\" sizes=\"(max-width: 1748px) 100vw, 1748px\" \/><\/a><\/p>\n<p>So basically my solution is expected to do the below set of tasks<\/p>\n<ul>\n<li>Get details of all EBS volumes attached to an EC2 instance (Source &#8211; EC2 Instance)<\/li>\n<li>Create a Snapshot of each EBS volume attached to the source EC2 Instance<\/li>\n<li>Create volumes from the above-created snapshots (Here we need to clone EBS volumes)<\/li>\n<li>Attach these newly created cloned EBS volumes to target EC2 Instance<\/li>\n<\/ul>\n<p>&nbsp;<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/ec2-instance.png\"><img class=\"post-img aligncenter wp-image-8337 size-large\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/ec2-instance-1024x218.png\" alt=\"\" width=\"840\" height=\"179\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/ec2-instance-1024x218.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/ec2-instance-300x64.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/ec2-instance-768x163.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/ec2-instance-1536x327.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/ec2-instance-2048x436.png 2048w\" sizes=\"(max-width: 840px) 100vw, 840px\" \/><\/a><\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/source-ec2.png\"><img class=\"post-img aligncenter wp-image-8339 size-large\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/source-ec2-1024x584.png\" alt=\"\" width=\"840\" height=\"479\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/source-ec2-1024x584.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/source-ec2-300x171.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/source-ec2-768x438.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/source-ec2-1536x875.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/source-ec2-2048x1167.png 2048w\" sizes=\"(max-width: 840px) 100vw, 840px\" \/><\/a><\/p>\n<p>For this use case, I chose &#8216;Pulumi&#8217;\u00a0 over Terraform for its simplicity.<\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<h3 id=\"what-is-pulumi\">What is Pulumi?<\/h3>\n<p><strong>Pulumi is an open-source infrastructure as a code tool<\/strong> for creating, deploying and managing cloud infrastructure.<\/p>\n<p>It is similar to terraform which can be termed as its twin sister,<\/p>\n<p>Unlike Terraform, Pulumi can fit right into your application environment and it can be written in any of the following Languages<\/p>\n<ul>\n<li>Python<\/li>\n<li>TypeScript<\/li>\n<li>JavaScript<\/li>\n<li>Go<\/li>\n<li>C#<\/li>\n<li>F#<\/li>\n<\/ul>\n<p>So that you don&#8217;t have to learn an additional language like HCL for Terraform.<\/p>\n<p>I will try to explain how I was able to achieve our objective using pulumi.<\/p>\n<blockquote><p>\u00a0 In fact, we were also able to acheive the same in Terraform after spending hours of efforts.\u00a0 We feel Pulumi is the winner here as it is simple and straight forward and easy to adopt and learn.<br \/>\nwe will explain how did we do this objective on Terraform in our next article. Stay Connected.<\/p><\/blockquote>\n<h3><\/h3>\n<p>Read more about the <a href=\"https:\/\/www.pulumi.com\/docs\/intro\/vs\/terraform\/#differences\">Terraform vs pulumi here<\/a><\/p>\n<p>&nbsp;<\/p>\n<h3>Pre-requisites<\/h3>\n<ul>\n<li>An AWS Account<\/li>\n<li>An AWS CLI needs to be installed<\/li>\n<li>Your AWS credentials.\n<ul>\n<li>You can create a new Access Key on this page.<a href=\"https:\/\/console.aws.amazon.com\/iam\/home?#\/security_credentials\" rel=\"nofollow\">link<\/a><\/li>\n<\/ul>\n<\/li>\n<li>Python3 needs to be installed in machine<\/li>\n<li>Pulumi Engine needs to be installed in machine.\u00a0<a href=\"https:\/\/www.pulumi.com\/docs\/get-started\/aws\/begin\/\" rel=\"nofollow\">link<\/a><\/li>\n<\/ul>\n<h3><\/h3>\n<h3>Set-up Instructions<\/h3>\n<ul>\n<li>\n<p dir=\"auto\">Install Python3, pulumi locally.<\/p>\n<ul>\n<li><a href=\"https:\/\/linuxconcept.com\/how-to-install-python-3-on-rhel-8-red-hat-enterprise-linux\/\" rel=\"nofollow\">Python3 installation<\/a><\/li>\n<li>Pulumi :\n<ul>\n<li><a href=\"https:\/\/www.pulumi.com\/docs\/get-started\/aws\/begin\/\" rel=\"nofollow\">Download Pulumi<\/a><\/li>\n<li><a href=\"https:\/\/www.pulumi.com\/docs\/get-started\/aws\/begin\/\" rel=\"nofollow\">Install Pulumi<\/a><\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/li>\n<li>\n<p dir=\"auto\">Set up AWS credentials in ~\/.aws\/credentials.<\/p>\n<ul>\n<li>The easiest way to do so is by setting up the AWS CLI.\n<ul>\n<li><a href=\"https:\/\/docs.aws.amazon.com\/cli\/latest\/userguide\/cli-chap-install.html\" rel=\"nofollow\">Install CLI<\/a><\/li>\n<li><a href=\"https:\/\/docs.aws.amazon.com\/cli\/latest\/userguide\/install-cliv2-linux.html\" rel=\"nofollow\">Install CLI on Linux<\/a><\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/li>\n<li>\n<p dir=\"auto\">once <code>aws-cli<\/code> is installed in the host machine, set up AWS credentials using the below command<\/p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\">\n<pre class=\"notranslate\"><code class=\"notranslate\">$ aws configure\r\n<\/code><\/pre>\n<\/div>\n<ul>\n<li>This will ask for your AWS access key and AWS Secret as below\n<ul>\n<li>AWS Access Key ID [None] : ******<\/li>\n<li>AWS Secret Access Key [None] : ******<\/li>\n<li>Default region name : [leave it none, press enter]<\/li>\n<li>Default output format : [leave it none, press enter]<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<h3><\/h3>\n<h3>Creating a workspace and Initializing Pulumi<\/h3>\n<p>Create an empty directory and then run <strong>&#8216;pulumi new&#8217;<\/strong> command as this command generates a set of pre-defined files (requirements.txt, Pulumi.yaml,__<strong>main__<\/strong>.py)<\/p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\">\n<pre class=\"notranslate\"><code class=\"notranslate\">$ pulumi new\r\n<\/code><\/pre>\n<\/div>\n<p dir=\"auto\">The pulumi new command creates a new Pulumi project with some basic set of files based on the cloud and language specified.<\/p>\n<p dir=\"auto\">If you are running <code>pulumi new<\/code>\u00a0or most other\u00a0<code>pulumi<\/code> commands for the first time, you will be prompted to log in to the <a href=\"https:\/\/app.pulumi.com\/\" target=\"_blank\" rel=\"noopener noreferrer\">Pulumi service<\/a>. The\u00a0<a href=\"https:\/\/www.pulumi.com\/docs\/reference\/cli\/\">Pulumi CLI<\/a> works in the background with the Pulumi service in order to deliver a reliable experience. It is free for individual use.<\/p>\n<p>Create a directory with some valid name<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"raw\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">mkdir pulumi-devops-junction<\/pre>\n<p>&nbsp;<\/p>\n<p>Get into that directory<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"raw\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">cd pulumi-devops-junction<\/pre>\n<p>&nbsp;<\/p>\n<p>Inside that directory execute the <code>pulumi new<\/code> command<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"raw\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">pulumi new<\/pre>\n<p>&nbsp;<\/p>\n<p>Once you execute the &#8216;Pulumi new&#8217; command, you should see an output similar to below<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-new.png\"><img class=\"post-img aligncenter wp-image-8341 size-large\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-new-1024x508.png\" alt=\"\" width=\"840\" height=\"417\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-new-1024x508.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-new-300x149.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-new-768x381.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-new.png 1446w\" sizes=\"(max-width: 840px) 100vw, 840px\" \/><\/a><\/p>\n<p>Using the up-down arrow key, select the <code>aws-python<\/code> option. Press Enter<\/p>\n<p>Specify the following information<\/p>\n<ol>\n<li style=\"list-style-type: none;\">\n<ol>\n<li>Project Name<\/li>\n<li>Project Description<\/li>\n<li>Stack Name<\/li>\n<li>Aws Region<\/li>\n<\/ol>\n<\/li>\n<\/ol>\n<p>If you hit enter without giving any values pulumi will consider default values.\u00a0 Once you specify all details, pulumi will run and try to install all necessary libs. You should see output similar to below<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-values.png\"><img class=\"post-img aligncenter wp-image-8346 size-large\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-values-1024x384.png\" alt=\"\" width=\"840\" height=\"315\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-values-1024x384.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-values-300x113.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-values-768x288.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-values-1536x576.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-values-2048x768.png 2048w\" sizes=\"(max-width: 840px) 100vw, 840px\" \/><\/a><br \/>\nNow our pulumi project is set up and ready!! and we are ready to go and make changes in the placeholder code.<\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n<h3>Pulumi Python script to Clone EBS Volumes and attach to other EC2<\/h3>\n<p>Now we have the default files created, Its time to update the placeholder file with our sourcecode.<\/p>\n<p>copy the below content into <code>__main.py__<\/code>and replace the existing content.<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"python\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">\"\"\"An AWS Python Pulumi program\"\"\"\r\nimport pulumi\r\nimport pulumi_aws as aws\r\nimport datetime\r\nimport logging\r\n\r\nlogger = logging.getLogger(__name__)\r\nct = datetime.datetime.now()\r\nts = ct.timestamp()\r\nconfig = pulumi.Config()\r\ndata = config.require_object(\"data\")\r\n# print (\"Source Instance :\",data.get(\"source_instance_id\"))\r\nsource_instance = aws.ec2.get_instance(instance_id=data.get(\"source_instance_id\"))\r\ntarget_instance = aws.ec2.get_instance(instance_id=data.get(\"target_instance_id\"))\r\n\r\nebslist = source_instance.ebs_block_devices\r\nsnapshot_name = \"vol_snapshots\"+\"-\"+str(ts)\r\ncloned_vol_name = \"cloned_vol\"+\"-\"+str(ts)\r\nvol_attachment = \"vol_attachment\"+\"-\"+str(ts)\r\ntry:\r\n    for i in ebslist:\r\n        logger.info(\"Loop over EBS list to get volume-id and device_name\")\r\n        try:\r\n         source_snapshot = aws.ebs.Snapshot(snapshot_name+str(i.volume_id),volume_id=i.volume_id)\r\n        except RuntimeError:\r\n            logger.exception(\"Snapshot creation failed\")\r\n            raise\r\n        try:\r\n            source_cloned_volume = aws.ebs.Volume(cloned_vol_name+str(i.volume_id),availability_zone=data.get(\"az\"),snapshot_id=source_snapshot.id)\r\n        except RuntimeError:\r\n            logger.exception(\"Volume creation from snapshots failed\")\r\n            raise\r\n        try:\r\n            cloned_vol_attachment = aws.ec2.VolumeAttachment(vol_attachment+str(i.volume_id),device_name=i.device_name,volume_id=source_cloned_volume.id,instance_id=target_instance.instance_id)\r\n        except RuntimeError:\r\n            logger.exception(\"Volume attachment to target instance failed\")\r\n            raise\r\nexcept RuntimeError:\r\n    logger.exception(\"Looping through EBS block list failed\")\r\n    raise<\/pre>\n<p>Yes, that&#8217;s all and it is simple Python. In terraform it was not this easy ( wait for our next article to compare )<\/p>\n<p>The Preceding python program will take <code>Source_Instance_Id<\/code>, <code>Target_Instance_Id<\/code> and <code>region<\/code> as input parameter and it will checks volumes attached to the Source instance and create snapshots of it.<\/p>\n<p>Next, It will create a second set of volumes from these snapshots and attach these volumes to the target instance.<\/p>\n<p>&nbsp;<\/p>\n<h3>Update the Values and Pulumi up ( Run the script )<\/h3>\n<p>Please change the following set of parameters in <code>pulumi.dev.yaml<\/code> file.<\/p>\n<ul>\n<li>source_instance<\/li>\n<li>target_instance<\/li>\n<li>region<\/li>\n<\/ul>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/pulumi-variablefile.png\"><img class=\"post-img alignnone wp-image-8368 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/pulumi-variablefile.png\" alt=\"aws pulumi\" width=\"1430\" height=\"602\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/pulumi-variablefile.png 1430w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/pulumi-variablefile-300x126.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/pulumi-variablefile-1024x431.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/pulumi-variablefile-768x323.png 768w\" sizes=\"(max-width: 1430px) 100vw, 1430px\" \/><\/a><\/p>\n<p><code>Pulumi.*.yaml<\/code> is a configuration file where we can maintain our input parameters and the same can be used in our code. more like a variables file. in terraform it is <code>*.tfvars<\/code> file<\/p>\n<p>Now run the <strong>Pulumi up<\/strong> command.<\/p>\n<p>Like <code>Terraform plan<\/code>\u00a0 or <code>Terraform apply<\/code> command Pulumi will try to get your confirmation before moving on.<\/p>\n<p>You can simply choose <code>no<\/code> if you just want to plan or dry run and choose <code>yes<\/code> to apply the changes.<\/p>\n<p>You should see output similar to below<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up.png\"><img class=\"post-img aligncenter wp-image-8344 size-large\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-1024x520.png\" alt=\"\" width=\"840\" height=\"427\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-1024x520.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-300x152.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-768x390.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-1536x780.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-2048x1040.png 2048w\" sizes=\"(max-width: 840px) 100vw, 840px\" \/><\/a><\/p>\n<p>Select <strong>Yes<\/strong>\u00a0 for the question <strong>Do you want to perform this update <\/strong>question and pulumi will create your desired infrastructure for you.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-2.png\"><img class=\"aligncenter size-large wp-image-8343\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-2-1024x481.png\" alt=\"\" width=\"840\" height=\"395\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-2-1024x481.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-2-300x141.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-2-768x361.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-2-1536x722.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-up-2.png 1676w\" sizes=\"(max-width: 840px) 100vw, 840px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<p>That&#8217;s all. Sit back and relax for a minute or a few.<\/p>\n<p>You can validate and confirm if your infra is created as per requirement by logging into the AWS console<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/target-ec2.png\"><img class=\"post-img aligncenter wp-image-8338 size-large\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/target-ec2-1024x572.png\" alt=\"\" width=\"840\" height=\"469\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/target-ec2-1024x572.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/target-ec2-300x168.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/target-ec2-768x429.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/target-ec2-1536x858.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/target-ec2-2048x1144.png 2048w\" sizes=\"(max-width: 840px) 100vw, 840px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<p>Once this exercise is done, do not forget to clean up resources using <strong>pulumi destroy<\/strong> command in order to avoid unnecessary charges<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-destroy.png\"><img class=\"post-img aligncenter wp-image-8342 size-large\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-destroy-1024x482.png\" alt=\"\" width=\"840\" height=\"395\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-destroy-1024x482.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-destroy-300x141.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-destroy-768x361.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-destroy-1536x723.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/p-destroy.png 1858w\" sizes=\"(max-width: 840px) 100vw, 840px\" \/><\/a><\/p>\n<p>Voila!!.. You have achieved your requirement with pulumi.<\/p>\n<p>This highly scalable solution where we can read and clone multiple numbers of volumes attached to EC2 instances in no time<\/p>\n<p>&nbsp;<\/p>\n<h3>GitHub Link for the Sourcecode<\/h3>\n<p>You can download the source code from <a href=\"https:\/\/github.com\/sheldon-cooper26\/pulumi_ebs_vol_snapshot\">this github link\u00a0<\/a><\/p>\n<p>&nbsp;<\/p>\n<h3>Conclusion<\/h3>\n<p>We have learnt how to clone EBS Volumes attached to One Ec2 instance (Source) and attach them to another EC2 instance (Target)<\/p>\n<p>During the implementation, we learned how Pulumi is set up and configured.<\/p>\n<p>Hope you would give it a go for Pulumi. Stay connected with us to learn how to do this objective on Terraform.<\/p>\n<p>We are already halfway through and it is not as easy as Pulumi. Stay Connected.<\/p>\n<p>For any DevOps or IaaS consultation reach out to us at rumenlishkoff@gmail.com<\/p>\n<a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\"><img class=\"post-img\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\" alt=\"gritfy\" width=\"1047\" height=\"415\" class=\"alignnone size-full wp-image-6623\" \/><\/a>\n<p>&nbsp;<\/p>\n<p>Co Authored by<\/p>\n<p>Tapan Hegde\u00a0 &amp; Rumen Lishkov<\/p>\n<div id=\"postfollow\">\r\n<a href='https:\/\/ko-fi.com\/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='https:\/\/az743702.vo.msecnd.net\/cdn\/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' \/><\/a>\r\n<p>Follow us on<a href=\"http:\/\/www.facebook.com\/middlewareinventory\">Facebook<\/a> or<a href=\"http:\/\/www.twitter.com\/mwinventory\">Twitter<\/a>\r\n<\/br>\r\nFor more practical videos and tutorials. <a href=\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw?sub_confirmation=1\">Subscribe to our channel<\/a>\r\n<\/br>\r\nFollow me on Linkedin <a href=\"https:\/\/www.linkedin.com\/comm\/mynetwork\/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=saravakmwinventory\">My Profile<\/a>\r\n<\/br>\r\n<\/i>For any Consultation or to hire us <a href=\"mailto:rumenlishkoff@gmail.com\"> rumenlishkoff@gmail.com<\/a>\r\n<\/br>\r\nIf you like this article. Show your Support! <a href=\"https:\/\/ko-fi.com\/middlewareinventory\">Buy me a Coffee.<\/a>\r\n<\/br>\r\n<\/p>\r\n<p style=\"color: palevioletred !important;\">Signup for Exclusive \"Subscriber-only\" Content<\/p>\r\n\n\t\t<div class=\"emaillist\">\n\t\t\t<form action=\"#\" method=\"post\" class=\"es_subscription_form es_shortcode_form\" id=\"es_subscription_form_1670577594\" data-source=\"ig-es\">\n\t\t\t\t\t\t\t\t<div class=\"es-field-wrap\"><label>Name*<br \/><input type=\"text\" name=\"name\" class=\"ig_es_form_field_name\" placeholder=\"\" value=\"\" required=\"required\" \/><\/label><\/div><div class=\"es-field-wrap\"><label>Email*<br \/><input class=\"es_required_field es_txt_email ig_es_form_field_email\" type=\"email\" name=\"email\" value=\"\" placeholder=\"\" required=\"required\" \/><\/label><\/div><input type=\"hidden\" name=\"lists[]\" value=\"1\" \/><input type=\"hidden\" name=\"form_id\" value=\"3\" \/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page\" value=\"8336\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page_url\" value=\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"status\" value=\"Unconfirmed\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es-subscribe\" id=\"es-subscribe\" value=\"7aebfb1a9b\"\/>\n\t\t\t\t<label style=\"position:absolute;top:-99999px;left:-99999px;z-index:-99;\"><input type=\"email\" name=\"es_hp_email\" class=\"es_required_field\" tabindex=\"-1\" autocomplete=\"-1\" value=\"\"\/><\/label>\n\t\t\t\t\t\t\t\t<input type=\"submit\" name=\"submit\" class=\"es_subscription_form_submit es_submit_button es_textbox_button\" id=\"es_subscription_form_submit_1670577594\" value=\"Subscribe\"\/>\n\n\t\t\t\t\n\t\t\t\t<span class=\"es_spinner_image\" id=\"spinner-image\"><img src=\"https:\/\/www.middlewareinventory.com\/wp-content\/plugins\/email-subscribers\/lite\/public\/images\/spinner.gif\" alt=\"Loading\"\/><\/span>\n\n\t\t\t<\/form>\n\n\t\t\t<span class=\"es_subscription_message\" id=\"es_subscription_message_1670577594\"><\/span>\n\t\t<\/div>\n\n\t\t\r\n<\/div>\r\n<hr>\n","protected":false},"excerpt":{"rendered":"<p>I had an Infrastructure as an automation requirement recently, where I had to create a solution that will find EBS volumes attached to an EC2 instance and create snapshots of the same and clone it and attach these cloned volumes to another EC2 instance. I know it was a little[&#8230;]<\/p>\n","protected":false},"author":271,"featured_media":8358,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[445,233],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Clone EBS Volumes between AWS EC2 with Pulumi | Devops Junction<\/title>\n<meta name=\"description\" content=\"Clone AWS EBS Volumes between two Ec2 instances. Clone AWS EBS Disk from one to Ec2 to another with Pulumi. AWS Pulumi EC2 EBS Volume Example. How to Copy EBS Volumes between Ec2 instances.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Clone EBS Volumes between AWS EC2 with Pulumi | Devops Junction\" \/>\n<meta property=\"og:description\" content=\"Clone AWS EBS Volumes between two Ec2 instances. Clone AWS EBS Disk from one to Ec2 to another with Pulumi. AWS Pulumi EC2 EBS Volume Example. How to Copy EBS Volumes between Ec2 instances.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2022-04-23T11:31:29+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-04-23T16:43:33+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction.jpg\" \/>\n\t<meta property=\"og:image:width\" content=\"1748\" \/>\n\t<meta property=\"og:image:height\" content=\"1240\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/04\/aws-pulumi-devopsjunction.jpg\",\"width\":1748,\"height\":1240,\"caption\":\"AWS Pulumi\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/\",\"name\":\"Clone EBS Volumes between AWS EC2 with Pulumi | Devops Junction\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/#primaryimage\"},\"datePublished\":\"2022-04-23T11:31:29+00:00\",\"dateModified\":\"2022-04-23T16:43:33+00:00\",\"description\":\"Clone AWS EBS Volumes between two Ec2 instances. Clone AWS EBS Disk from one to Ec2 to another with Pulumi. AWS Pulumi EC2 EBS Volume Example. How to Copy EBS Volumes between Ec2 instances.\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/a3628fb28665348f6aab4f472ebf7837\"},\"headline\":\"Clone EBS Volumes between AWS EC2 with Pulumi | Devops Junction\",\"datePublished\":\"2022-04-23T11:31:29+00:00\",\"dateModified\":\"2022-04-23T16:43:33+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/#webpage\"},\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/#primaryimage\"},\"articleSection\":\"Pulumi,Terraform\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/aws-pulumi-ebs-example\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/a3628fb28665348f6aab4f472ebf7837\",\"name\":\"Tapan Hegde\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/cc6f526212cdbf66b6a32db548fa54b8?s=96&d=mm&r=g\",\"caption\":\"Tapan Hegde\"}}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/8336"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/271"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=8336"}],"version-history":[{"count":5,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/8336\/revisions"}],"predecessor-version":[{"id":8371,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/8336\/revisions\/8371"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media\/8358"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=8336"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=8336"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=8336"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}