{"id":4352,"date":"2018-07-24T02:39:10","date_gmt":"2018-07-24T07:39:10","guid":{"rendered":"https:\/\/middlewaregyan.wordpress.com\/?p=2"},"modified":"2020-09-29T16:57:51","modified_gmt":"2020-09-29T11:27:51","slug":"remote-denial-of-service-attack-in-iis-6-7","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/","title":{"rendered":"Remote Denial of Service Attack in IIS 6\/7"},"content":{"rendered":"<p><em><strong>Overview<\/strong><\/em><\/p>\n<p><strong>CVE-2007-2897<\/strong><\/p>\n<p>Microsoft Internet Information Services (IIS) 6.0 allows remote attackers to cause a denial of service (server instability or device hang), and possibly obtain sensitive information (device communication traffic); and might allow attackers with physical access to execute arbitrary code after connecting a data stream to a device COM port; via requests for a URI containing a \u2018\/\u2019 immediately before and after the name of a DOS device, as demonstrated by the \/AUX\/.aspx URI, which bypasses a blacklist for DOS device requests.<\/p>\n<p>This kind of sensitive attack can be avoided by installing URLScan in Windows machine.<br \/>\nUrlScan 3.1 can be configured to filter HTTP querystring values and other HTTP headers to mitigate SQL injection attacks while the root cause is being fixed in the application.<\/p>\n<p><strong>UrlScan 3.1 actively works with the following IIS versions:<\/strong><\/p>\n<p>IIS 5.1 on Windows XP<br \/>\nIIS 6.0 on Windows Server 2003<br \/>\nIIS 7.0 and above on Windows Server 2008 and Windows Vista<br \/>\nAdministrators may configure UrlScan to reject HTTP requests based on the following criteria:<\/p>\n<p>The HTTP request method or verb<br \/>\nThe file name extension of the requested resource<br \/>\nSuspicious URL encoding<br \/>\nPresence of non-ASCII characters in the URL<br \/>\nPresence of specified character sequences in the URL<br \/>\nPresence of specified headers in the request<br \/>\nLets get into the work !!<br \/>\n<strong>Prerequisites<\/strong><\/p>\n<p>\u2022 Windows XP, Windows Server 2003, Windows Vista or Windows Server 2008.<br \/>\n\u2022 IIS version 5.1, 6.0 or 7.0 or above (depending on the platform).<\/p>\n<p><strong>Installation Steps<\/strong><\/p>\n<p>\u2022 Run UrlScan v3.1 MSI installer for either x86 or x64 version depending on your platform.<\/p>\n<p>\u2022 On successful installation you should have a &#8220;UrlScan&#8221; folder with UrlScan.dll under %windir%\\system32\\inetsrv and additionally under %windir%\\syswow64\\inetsrv as well for x64 installations.<\/p>\n<p>\u2022 Folder above will also contain the configuration file, UrlScan.ini. In the x64 case, only the system32 directory will have the UrlScan.ini file since the filter will turn off redirection when attempting to access UrlScan.ini, so both versions of the filter will access the same configuration under system32 directory<\/p>\n<p>\u2022 Upgrading from UrlScan v2.5 or UrlScan v3.0 will leave your old UrlScan.ini file intact.<\/p>\n<p>\u2022 The default installation will install UrlScan as a global filter only. Please refer to the Setting Up UrlScan v3.1 section for details.<\/p>\n<p>\u2022 UrlScan is required to be the highest priority filter for it to function properly. The MSI installer will do so for the global filter case, but if you are installing UrlScan as a site filter you will need to set UrlScan as the highest order filter.<\/p>\n<p><strong>Global Filter<\/strong><\/p>\n<p>The default installation of UrlScan v3.1 installs the filter as a global filter. See the Site Filter section on how to setup your filter as a site filter<br \/>\nIf you are upgrading from UrlScan v2.5 or from UrlScan v3.0 your old UrlScan.ini file will be persisted and all your old settings will apply. If you want to check out the new defaults for the UrlScan.ini file, download the new UrlScan.ini file here.<\/p>\n<p>x86 &#8211;&gt; https:\/\/www.iis.net\/downloads\/microsoft\/urlscan<br \/>\nx64 &#8211;&gt; https:\/\/www.iis.net\/downloads\/microsoft\/urlscan<\/p>\n<p>The default logging directory is the &#8220;logs&#8221; directory underneath the &#8220;UrlScan&#8221; directory where your global filter is installed. Change this to point to wherever you want your log files to be located. Make sure that IIS worker processes have write permissions to this folder. For IIS 6.0 make sure you give IIS_WPG write permissions to this folder, and for IIS 7.0 and above make sure you give IIS_IUSRS write permission to this folder.<br \/>\nThe default UrlScan.ini file has detailed descriptions of what all the configuration options do. Read through it and update the values for them according to your needs. Check out the &#8220;Common Scenarios&#8221; section for some common configurations.<\/p>\n<p><strong>Site Filter<\/strong><\/p>\n<p>Upon installation of UrlScan v3.1 as a site filter requests for that particular site will run through both the site and the global filter if the global filter is not un-mapped. There would be two instances of the filter running in this case.<\/p>\n<p>If you have a site called &#8220;Site1&#8221; setup on the server under c:\\site1 folder and you want to use UrlScan v3.1 as a site filter for this site, here is how you would set it up.<\/p>\n<p>1. Copy UrlScan.dll and UrlScan.ini from the default installation location to c:\\site1.<\/p>\n<p>2. Modify c:\\site1\\UrlScan.ini with all the options that you want for your site filter. The default UrlScan.ini file that you can download here has the options listed with comments on what they do.<\/p>\n<p>3. Register c:\\site1\\UrlScan.dll as a site filter. Run &#8220;inetmgr&#8221; and drill down to &#8220;Site1&#8221; in your left hand pane. For IIS 5.1 and 6.0, right-click on &#8220;Site1&#8221; and select &#8220;Properties&#8221; then go to the &#8220;ISAPI Filters&#8221; tab and add a new filter and point the executable to c:\\site1\\UrlScan.dll. For IIS 7.0 and above, you should see an ISAPI Filters icon under the IIS category and double-clicking this will bring up an &#8220;Add\u2026&#8221; action which you can then point the executable to c:\\site1\\UrlScan.dll<\/p>\n<p>4. Using the up arrow key, move the UrlScan filter to the top to make it the highest priority filter. This step is essential for the filter to function correctly.<\/p>\n<p>5. if your site has multiple dots (.) in its address, change the value &#8220;AllowDotInPath=0&#8221; to &#8220;AllowDotInPath=1&#8221; in Urlscan.ini file and reset IIS to reflect changes.<\/p>\n<p>Now hit the site and voila !!!<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Overview CVE-2007-2897 Microsoft Internet Information Services (IIS) 6.0 allows remote attackers to cause a denial of service (server instability or device hang), and possibly obtain sensitive information (device communication traffic); and might allow attackers with physical access to execute arbitrary code after connecting a data stream to a device COM[&#8230;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[353,356],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Remote Denial of Service Attack in IIS 6\/7<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Remote Denial of Service Attack in IIS 6\/7\" \/>\n<meta property=\"og:description\" content=\"Overview CVE-2007-2897 Microsoft Internet Information Services (IIS) 6.0 allows remote attackers to cause a denial of service (server instability or device hang), and possibly obtain sensitive information (device communication traffic); and might allow attackers with physical access to execute arbitrary code after connecting a data stream to a device COM[...]\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2018-07-24T07:39:10+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2020-09-29T11:27:51+00:00\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/\",\"name\":\"Remote Denial of Service Attack in IIS 6\/7\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"datePublished\":\"2018-07-24T07:39:10+00:00\",\"dateModified\":\"2020-09-29T11:27:51+00:00\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\"},\"headline\":\"Remote Denial of Service Attack in IIS 6\/7\",\"datePublished\":\"2018-07-24T07:39:10+00:00\",\"dateModified\":\"2020-09-29T11:27:51+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/#webpage\"},\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"articleSection\":\"IIS,Vulnerabilities &amp; Fixes\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/remote-denial-of-service-attack-in-iis-6-7\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\",\"name\":\"Rumen Lishkov\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g\",\"caption\":\"Rumen Lishkov\"}}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/4352"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=4352"}],"version-history":[{"count":1,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/4352\/revisions"}],"predecessor-version":[{"id":4479,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/4352\/revisions\/4479"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=4352"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=4352"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=4352"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}