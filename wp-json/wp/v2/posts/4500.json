{"id":4500,"date":"2019-11-25T22:04:26","date_gmt":"2019-11-25T16:34:26","guid":{"rendered":"https:\/\/www.middlewareinventory.com\/?p=4500"},"modified":"2022-06-19T11:24:48","modified_gmt":"2022-06-19T05:54:48","slug":"ansible-ec2-ssh-key","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/","title":{"rendered":"Add SSH Key to EC2 instances with Ansible &#8211; Automated"},"content":{"rendered":"<div style=\"display: none;\"><\/div>\n<div style=\"display: none;\"><\/div>\n<p>Whether it is On-Prem (or) Cloud-hosted, A Typical Non-Containerized Enterprise infrastructure would have ample of Virtual Machines aka Servers [ Linux ]<\/p>\n<p>Let us suppose that you work for the DevOps team of a Big Organization where you manage <strong>100+ ec2 instances<\/strong>. You have a new hire in your team and you ought to give him access to all these boxes\/machines<\/p>\n<p>Now you have two options to give the new user(s) their SSH access to EC2 servers.<\/p>\n<ol>\n<li>Copy the user&#8217;s public key to all the server&#8217;s default user (ubuntu, centos, ec2-user, admin) &#8211; <strong>Discussed in this article<\/strong><\/li>\n<li>\u00a0Create a user ID for the new user[s] and copy their SSH public key for them to login with their own user ID and SSH Private Key &#8211; <strong>Refer our another article<\/strong><\/li>\n<\/ol>\n<p>&nbsp;<\/p>\n<p>In this post, we are discussing how to add a user&#8217;s SSH public key to the default user-id of the remote EC2 servers.\u00a0 the remote servers can be different distributions and have different user ids or the same.<\/p>\n<p>Ec2 servers have different default user&#8217;ids based on the AMI being used. Refer the following screenshot taken from Amazon Documentation<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-2.10.41-PM.png\"><img class=\"alignnone size-full wp-image-6405\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-2.10.41-PM.png\" alt=\"\" width=\"1590\" height=\"534\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-2.10.41-PM.png 1590w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-2.10.41-PM-300x101.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-2.10.41-PM-1024x344.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-2.10.41-PM-768x258.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-2.10.41-PM-1536x516.png 1536w\" sizes=\"(max-width: 1590px) 100vw, 1590px\" \/><\/a><\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM.jpg\"><img class=\"alignnone size-full wp-image-6402\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM.jpg\" alt=\"\" width=\"2274\" height=\"1526\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM.jpg 2274w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM-300x201.jpg 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM-1024x687.jpg 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM-768x515.jpg 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM-1536x1031.jpg 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM-2048x1374.jpg 2048w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM-120x80.jpg 120w\" sizes=\"(max-width: 2274px) 100vw, 2274px\" \/><\/a><\/p>\n<p><span style=\"color: #003366;\"><strong>The objective of this article is to add a new SSH Key to Multiple EC2 instances at the same time<\/strong><\/span>. How are we going to do it?<\/p>\n<p>I am an ansible fan for its capability and simplicity and this post is about one thing which is to give a new member access to the existing EC2 instances.<\/p>\n<p>We may refer to this in different ways as follows.<\/p>\n<p>How to add SSH Key to EC2 instance, Add new Key pair to EC2 instance,\u00a0 EC2 add Key to instance,\u00a0 add keypair to existing EC2 instance, Add SSH key to Ec2 with ansible etc<\/p>\n<p>&nbsp;<\/p>\n<h3>What are we going to do?<\/h3>\n<p>Add a user SSH key into the running EC2 instances. We are going to use Ansible to add new EC2 SSH Key to multiple EC2 instances at the same time.<\/p>\n<p>Basically, we are copying the user public key and adding it to the authorized_host file of the default remote user of EC2 instances such as <code>ubuntu<\/code> , <code>centos<\/code>, <code>ec2user<\/code> etc.<\/p>\n<p>This playbook can help you add SSH Key to multiple servers at the same time. the servers can be different in distribution (RHEL, ubuntu, Centos)\u00a0 or the same.<\/p>\n<p>&nbsp;<\/p>\n<p><strong>What we are not going to do<\/strong><\/p>\n<p>It is also important that you understand that We are not creating any new user in the remote server.<\/p>\n<p>We are going to simply add the public Keys under the authorized_users file of a single user on the EC2 instance.<\/p>\n<p>Simply put, This post presumes that multiple users are using the same account\u00a0 (or) default account. we are not creating any new user ID on the remote system.<\/p>\n<p>If you would like to create a dedicated user account and copy their SSH key into their own user ID on the EC2 instance &#8211; Refer to our another article.<\/p>\n<p>&nbsp;<\/p>\n<h3>How we are going to do?<\/h3>\n<p>Using Ansible and its authorized_key module. This playbook serves as an example to <code>authorized_key<\/code> module of ansible.<\/p>\n<p>&nbsp;<\/p>\n<h3>What you might need<\/h3>\n<ol>\n<li>A Private Key of a key pair of your AWS account, associated with the instances to which you are going to add the Key<\/li>\n<li>Ansible Control machine ( A machine with Ansible installed)<\/li>\n<\/ol>\n<h3><\/h3>\n<h3>Steps to Add SSH Key to EC2 Instances<\/h3>\n<ol>\n<li>Copy the playbook (or) Clone our Git Repo<\/li>\n<li>Get your Desired instance&#8217;s IP\/hostname into Ansible inventory file aka hosts file.<\/li>\n<li>Run the playbook.<\/li>\n<li>SSH to verify.<\/li>\n<\/ol>\n<p>&nbsp;<\/p>\n<h3>Step1: Create a Playbook<\/h3>\n<p>This is playbook we are going to use you can copy this to your local (or) get it from Github repo <a href=\"https:\/\/github.com\/AKSarav\/Add-SSH-Key-EC2-Ansible.git\">https:\/\/github.com\/AKSarav\/Add-SSH-Key-EC2-Ansible.git<\/a><\/p>\n<p>Copy this content and save it as <code>add-key.yml<\/code> or clone the preceding Git repo.<\/p>\n<pre>---\r\n- name: \"Playbook to Add Key to EC2 Instances\"\r\n  hosts: hosts_to_add_key\r\n  vars:\r\n    - status : \"present\"\r\n    - key : \"~\/.ssh\/id_rsa.pub\"\r\n\r\n  tasks:\r\n\r\n  - name: \"Copy the authorized key file from\"\r\n    authorized_key:\r\n      user: \"{{ansible_user}}\"\r\n      state: \"{{status}}\"\r\n      key: \"{{ lookup('file', '{{ key }}')}}\"\r\n<\/pre>\n<p>Here we have defined a few variables<\/p>\n<p><code>status<\/code>\u00a0 &#8211; to indicate whether to keep or remove the SSH Key from the remote server. ( Add or Delete)<\/p>\n<p><code>key<\/code> &#8211; The default value for the SSH Key file, If not mentioned at the run time your current user&#8217;s default public key would be copied to the remote server.<\/p>\n<p><code>ansible_user<\/code>\u00a0 &#8211; A remote machine or EC2 instance user name which would be given at the runtime as well.<\/p>\n<p>&nbsp;<\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<p>&nbsp;<\/p>\n<h3>Step2: Add the List of EC2 Public IPs\/Private IPs into the Ansible inventory file<\/h3>\n<p>If you have cloned <a href=\"https:\/\/github.com\/AKSarav\/Add-SSH-Key-EC2-Ansible.git\">my Git repo,<\/a> You would have ended up a directory structure similar to what is shown below.<\/p>\n<pre>\u279c ansible tree ec2-addkey\r\nec2-addkey\r\n\u251c\u2500\u2500 add-key.yml\r\n\u2514\u2500\u2500 ansible_hosts\r\n\r\n0 directories, 2 files<\/pre>\n<p>Beneath the main directory named <code>ec2-addkey<\/code>\u00a0 there are two files as you can see.<\/p>\n<p>One is the playbook named <code>add-key.yml<\/code> and the other is the inventory file named <code>ansible_hosts<\/code><\/p>\n<p>Here is the content of the inventory file<\/p>\n<pre>[hosts_to_add_key] \r\n<span class=\"hljs-number\">34.83<\/span><span class=\"hljs-number\">.178<\/span><span class=\"hljs-number\">.254<\/span> \r\n<span class=\"hljs-number\">104.12<\/span><span class=\"hljs-number\">.32<\/span><span class=\"hljs-number\">.122<\/span> \r\n\r\n[hosts_to_add_key:vars] \r\nansible_ssh_common_args=<span class=\"hljs-string\">\"-o StrictHostKeyChecking=no\"<\/span><\/pre>\n<p>&nbsp;<\/p>\n<p>Here, I have added two of my public IPs ( sample ) to which I need to add some new SSH Key, You can replace the IPs with your actual ones but the <code>hostgroup<\/code>\u00a0should not be changed unless you change them in a <code>playbook<\/code>\u00a0as well.<\/p>\n<blockquote><p>\u00a0You can use your hostnames or Private IP addresses if you have setup\u00a0 your Amazon Infra with VPN and\/or Route 53 Private Zone DNS. Sign up to mailing list. I am writing an article about this already.<\/p><\/blockquote>\n<p>Now. we have the list of servers under the ansible <code>hostgroup<\/code>\u00a0named <code>hosts_to_add_key<\/code>\u00a0and we have set some generic variables to instruct ansible to ignore hostname verification.<\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<p>&nbsp;<\/p>\n<h3>Step3: Run the playbook.<\/h3>\n<p>Now it is time to run the playbook with necessary run time variables. Ansible playbook overrides all the inline variables with the ones given at runtime also known as extra args<\/p>\n<p>Here is the basic syntax on how to righteously execute this playbook.<\/p>\n<pre>ansible-playbook add-key.yml \r\n-i ansible_hosts \r\n--user &lt;remote user name&gt; \r\n--key-file &lt;Your_Private_key_file.pem&gt; \r\n-e <span class=\"hljs-string\">\"key=&lt;User's public key file full qualified path&gt;\"<\/span><\/pre>\n<p>&nbsp;<\/p>\n<p>Now let&#8217;s pretend that these two IPs belong to an RHEL Virtual machine with default user of <code>ec2-user<\/code><\/p>\n<pre>ansible-playbook add-key.yml \r\n-i ansible_hosts \r\n--user<\/pre>\n<p><strong>ec2-user<\/strong><\/p>\n<pre>--key-file SaravAK-Privatekey.pem \r\n-e <span class=\"hljs-string\">\"key=\/tmp\/rohit_new_employee.pub\"<\/span><\/pre>\n<p>In case if the servers are UBUNTU machines, then we need to change the base user to\u00a0 <code>ubuntu<\/code>\u00a0as shown below.<\/p>\n<pre>ansible-playbook add-key.yml \r\n-i ansible_hosts \r\n--user<\/pre>\n<p><strong>ubuntu<\/strong><\/p>\n<pre> \r\n--key-file SaravAK-Privatekey.pem \r\n-e <span class=\"hljs-string\">\"key=\/tmp\/rohit_new_employee.pub\"<\/span><\/pre>\n<p>&nbsp;<\/p>\n<blockquote><p>\u00a0If you want to use different distributions of remote machines like linux, centos, ubuntu\u00a0 at the same time.\u00a0 scroll down to see the another approach.<\/p><\/blockquote>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<p>Here is the Brief Video recording of me running this playbook and explaining the steps. Refer this if you have any questions.<\/p>\n<div class=\"lyte-wrapper\" style=\"width:640px;max-width:100%;margin:5px;\"><div class=\"lyMe\" id=\"WYL_kfWfj76-am8\"><div id=\"lyte_kfWfj76-am8\" data-src=\"\/\/i.ytimg.com\/vi\/kfWfj76-am8\/hqdefault.jpg\" class=\"pL\"><div class=\"tC\"><div class=\"tT\"><\/div><\/div><div class=\"play\"><\/div><div class=\"ctrl\"><div class=\"Lctrl\"><\/div><div class=\"Rctrl\"><\/div><\/div><\/div><noscript><a href=\"https:\/\/youtu.be\/kfWfj76-am8\"><img src=\"https:\/\/i.ytimg.com\/vi\/kfWfj76-am8\/0.jpg\" alt=\"\" width=\"640\" height=\"340\" \/><br \/>Watch this video on YouTube<\/a><\/noscript><\/div><\/div><div class=\"lL\" style=\"max-width:100%;width:640px;margin:5px;\"><\/div><\/p>\n<p>&nbsp;<\/p>\n<h3>Step4: SSH to verify<\/h3>\n<p>You can ask the new user now to try to SSH with his private key<\/p>\n<p>If the Security Group is allowing the SSH connection. the newly added user should be able to SSH to the server henceforth using his private key.<\/p>\n<pre class=\"hljs\" style=\"display: block; overflow-x: auto; padding: 0.5em; background: #232323; color: #e6e1dc;\"><span style=\"color: #ffcc00;\">ssh -i<\/span> &lt;user's privatekey file&gt; &lt;username&gt;<span style=\"color: #ffcc00;\">@<\/span>&lt;public ip of the AWS instance&gt;<\/pre>\n<p>You can refer the video if you have questions on how to SSH.<\/p>\n<p>&nbsp;<\/p>\n<h3><strong>How to use different Linux Distributions at the same time Linux, RHEL, Ubuntu <\/strong><\/h3>\n<p>The whole purpose of this playbook is to let you be able to add SSH Key into multiple EC2 instances at the same time.<\/p>\n<p>So we got it covered.<\/p>\n<p>You have to make two changes prior to execution comparing to the previous process<\/p>\n<p><span style=\"color: #003366;\"><strong>Change1:<\/strong> Define the variables for each host like user, port number etc.<\/span><strong><br \/>\n<\/strong><\/p>\n<pre>[hosts_to_add_key]\r\n54.34.23.112 ansible_ssh_port=2222 ansible_user=ubuntu\r\nserver1.gritfy.local ansible_user=ec2-user\r\nwebserver.gritfy.com ansible_user=centos\r\n\r\n[hosts_to_add_key:vars]\r\nansible_ssh_common_args=\"-o StrictHostKeyChecking=no\"<\/pre>\n<p>&nbsp;<\/p>\n<p><span style=\"color: #003366;\"><strong>Change2:<\/strong> Run the playbook without &#8211; user at run time<\/span><strong><br \/>\n<\/strong><\/p>\n<p>You do not have specify the user at run time since you have mentioned it on the ansible inventory configuration or host file for each host.<\/p>\n<pre>ansible-playbook add-key.yml \r\n-i ansible_hosts \r\n--key-file SaravAK-Privatekey.pem \r\n-e <span class=\"hljs-string\">\"key=\/tmp\/rohit_new_employee.pub\"<\/span><\/pre>\n<p>&nbsp;<\/p>\n<h3><strong>How to remove the SSH Public Key (or) user using this Playbook &#8211; Deleting user access<br \/>\n<\/strong><\/h3>\n<p>To remove the Public Key you have just added (or) to revoke the Access of the employee you have added earlier.\u00a0 All you have to do is pass an additional argument to the playbook and inverse the action it does.<\/p>\n<p>If you have noticed the playbook. there is a variable named <code>status<\/code>\u00a0which is set to <code>present<\/code>\u00a0 which is to tell ansible that the key has to be added.<\/p>\n<p>To tell ansible to remove it. you have to change the status to <code>absent<\/code> at the run time. thats it.<\/p>\n<p>You can use the following command to change it at the run time without modifying the Ansible Playbook.<\/p>\n<pre class=\"hljs\">ansible-playbook add-key.yml \r\n-i ansible_hosts \r\n--user<\/pre>\n<p><strong>ubuntu<\/strong><\/p>\n<pre class=\"hljs\">--key-file SaravAK-Privatekey.pem\r\n-e <span class=\"hljs-string\">\"key=\/tmp\/rohit_new_employee.pub status=absent\"<\/span><\/pre>\n<p>&nbsp;<\/p>\n<p>Hope this helps.<\/p>\n<blockquote><p>Do you have any requirements where you need our professional assistance write an email to <strong>rumenlishkoff@gmail.com . <\/strong><\/p>\n<p>We like challanges just the way you do.<\/p><\/blockquote>\n<p>Let me know your comments over the comments section.<\/p>\n<p>Cheers<br \/>\nRumen Lishkov<\/p>\n<div id=\"postfollow\">\r\n<a href='https:\/\/ko-fi.com\/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='https:\/\/az743702.vo.msecnd.net\/cdn\/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' \/><\/a>\r\n<p>Follow us on<a href=\"http:\/\/www.facebook.com\/middlewareinventory\">Facebook<\/a> or<a href=\"http:\/\/www.twitter.com\/mwinventory\">Twitter<\/a>\r\n<\/br>\r\nFor more practical videos and tutorials. <a href=\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw?sub_confirmation=1\">Subscribe to our channel<\/a>\r\n<\/br>\r\nFollow me on Linkedin <a href=\"https:\/\/www.linkedin.com\/comm\/mynetwork\/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=saravakmwinventory\">My Profile<\/a>\r\n<\/br>\r\n<\/i>For any Consultation or to hire us <a href=\"mailto:rumenlishkoff@gmail.com\"> rumenlishkoff@gmail.com<\/a>\r\n<\/br>\r\nIf you like this article. Show your Support! <a href=\"https:\/\/ko-fi.com\/middlewareinventory\">Buy me a Coffee.<\/a>\r\n<\/br>\r\n<\/p>\r\n<p style=\"color: palevioletred !important;\">Signup for Exclusive \"Subscriber-only\" Content<\/p>\r\n\n\t\t<div class=\"emaillist\">\n\t\t\t<form action=\"#\" method=\"post\" class=\"es_subscription_form es_shortcode_form\" id=\"es_subscription_form_1670577835\" data-source=\"ig-es\">\n\t\t\t\t\t\t\t\t<div class=\"es-field-wrap\"><label>Name*<br \/><input type=\"text\" name=\"name\" class=\"ig_es_form_field_name\" placeholder=\"\" value=\"\" required=\"required\" \/><\/label><\/div><div class=\"es-field-wrap\"><label>Email*<br \/><input class=\"es_required_field es_txt_email ig_es_form_field_email\" type=\"email\" name=\"email\" value=\"\" placeholder=\"\" required=\"required\" \/><\/label><\/div><input type=\"hidden\" name=\"lists[]\" value=\"1\" \/><input type=\"hidden\" name=\"form_id\" value=\"3\" \/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page\" value=\"4500\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page_url\" value=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"status\" value=\"Unconfirmed\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es-subscribe\" id=\"es-subscribe\" value=\"7aebfb1a9b\"\/>\n\t\t\t\t<label style=\"position:absolute;top:-99999px;left:-99999px;z-index:-99;\"><input type=\"email\" name=\"es_hp_email\" class=\"es_required_field\" tabindex=\"-1\" autocomplete=\"-1\" value=\"\"\/><\/label>\n\t\t\t\t\t\t\t\t<input type=\"submit\" name=\"submit\" class=\"es_subscription_form_submit es_submit_button es_textbox_button\" id=\"es_subscription_form_submit_1670577835\" value=\"Subscribe\"\/>\n\n\t\t\t\t\n\t\t\t\t<span class=\"es_spinner_image\" id=\"spinner-image\"><img src=\"https:\/\/www.middlewareinventory.com\/wp-content\/plugins\/email-subscribers\/lite\/public\/images\/spinner.gif\" alt=\"Loading\"\/><\/span>\n\n\t\t\t<\/form>\n\n\t\t\t<span class=\"es_subscription_message\" id=\"es_subscription_message_1670577835\"><\/span>\n\t\t<\/div>\n\n\t\t\r\n<\/div>\r\n<hr>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Whether it is On-Prem (or) Cloud-hosted, A Typical Non-Containerized Enterprise infrastructure would have ample of Virtual Machines aka Servers [ Linux ] Let us suppose that you work for the DevOps team of a Big Organization where you manage 100+ ec2 instances. You have a new hire in your team[&#8230;]<\/p>\n","protected":false},"author":1,"featured_media":6402,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[98,234],"tags":[364],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Add SSH Key to EC2 instances with Ansible - Automated<\/title>\n<meta name=\"description\" content=\"How to Add SSH Key to AWS EC2 instance. Add new SSH user keys to multiple EC2 instances at a time with ansible. Add new SSH keys to AWS EC2 with ansible.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Add SSH Key to EC2 instances with Ansible - Automated\" \/>\n<meta property=\"og:description\" content=\"How to Add SSH Key to AWS EC2 instance. Add new SSH user keys to multiple EC2 instances at a time with ansible. Add new SSH keys to AWS EC2 with ansible.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2019-11-25T16:34:26+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-06-19T05:54:48+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM.jpg\" \/>\n\t<meta property=\"og:image:width\" content=\"2274\" \/>\n\t<meta property=\"og:image:height\" content=\"1526\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/11\/Screenshot-2020-11-07-at-7.00.04-AM.jpg\",\"width\":2274,\"height\":1526,\"caption\":\"add ssh key to EC2 instance\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/\",\"name\":\"Add SSH Key to EC2 instances with Ansible - Automated\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/#primaryimage\"},\"datePublished\":\"2019-11-25T16:34:26+00:00\",\"dateModified\":\"2022-06-19T05:54:48+00:00\",\"description\":\"How to Add SSH Key to AWS EC2 instance. Add new SSH user keys to multiple EC2 instances at a time with ansible. Add new SSH keys to AWS EC2 with ansible.\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\"},\"headline\":\"Add SSH Key to EC2 instances with Ansible &#8211; Automated\",\"datePublished\":\"2019-11-25T16:34:26+00:00\",\"dateModified\":\"2022-06-19T05:54:48+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/#webpage\"},\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/#primaryimage\"},\"keywords\":\"Add SSH Key to EC2 Instance example\",\"articleSection\":\"Ansible,AWS\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/ansible-ec2-ssh-key\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\",\"name\":\"Rumen Lishkov\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g\",\"caption\":\"Rumen Lishkov\"}}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/4500"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=4500"}],"version-history":[{"count":19,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/4500\/revisions"}],"predecessor-version":[{"id":6989,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/4500\/revisions\/6989"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media\/6402"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=4500"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=4500"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=4500"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}