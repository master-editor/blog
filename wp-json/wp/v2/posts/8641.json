{"id":8641,"date":"2022-06-16T00:03:56","date_gmt":"2022-06-15T18:33:56","guid":{"rendered":"https:\/\/www.middlewareinventory.com\/?p=8641"},"modified":"2022-06-16T15:34:45","modified_gmt":"2022-06-16T10:04:45","slug":"postgres-startup-and-stop-script","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/","title":{"rendered":"PostgreSQL Start and Stop Shell Script | Devops Junction"},"content":{"rendered":"<p>In this quick article, we are presenting you with the shell script to start and stop PostgreSQL DB instance.<\/p>\n<p>You can use these scripts as part of <code>rc.d<\/code> or <code>init.d<\/code>to be executed during the server shutdown and boot up.<\/p>\n<p>Feel free to modify it further to suit your needs. Hope this helps.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts.png\"><img class=\"post-img alignnone wp-image-8657 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts.png\" alt=\"\" width=\"1748\" height=\"1240\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts.png 1748w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts-300x213.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts-1024x726.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts-768x545.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts-1536x1090.png 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts-90x65.png 90w\" sizes=\"(max-width: 1748px) 100vw, 1748px\" \/><\/a><\/p>\n<h3><strong>Shell script to STOP PostgreSQL instance<\/strong><\/h3>\n<p>You need to update a few key values on the script before executing.<\/p>\n<ul>\n<li>PATH &#8211; the path where the PostgreSQL binaries are present<\/li>\n<li>PGDATA &#8211; Data directory of your Postgres DB instance<\/li>\n<li>PG_LOG_FILE &#8211; log file location for this DB instance.<\/li>\n<\/ul>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"shell\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">#!\/usr\/bin\/env bash\r\n# script to stop Postgres Database\r\n\r\nexport PATH=\/cdwapps\/local\/pgsql\/bin:$PATH\r\n\r\nexport PGDATA=\/cdwsapps\/airflow\/database\r\n\r\nPG_LOG_FILE=\/cdwapps\/airflow\/logs\/postgres.log\r\n\r\nnum_trys=0\r\n\r\nwhile [[ ${num_trys} -lt 3 ]];do\r\n    if ! pg_ctl status; then\r\n        echo -e \"postgre is running for PGDATA Location ${PGDATA} \\n\"\r\n        echo -e \"Attempt: ${num_trys} to stop...\"\r\n\r\n        pg_ctl stop -D ${PGDATA} -t 180\r\n\r\n        if [ $? -eq 0 ]\r\n        then\r\n            echo -e \"Stop command Successful.\"\r\n        else\r\n            echo -e \"Stop command Failed\"\r\n        fi\r\n\r\n        echo -e \"Waiting 30 seconds for DB Gracefully shutdown...\"\r\n        sleep 30\r\n\r\n        if ! pg_ctl status; then\r\n            echo -e \"PG ${PGDATA} has been stopped successfully...\"\r\n            break\r\n        fi\r\n        \r\n        ((num_trys++))\r\n    else\r\n        break\r\n    fi\r\ndone\r\n\r\n\r\n<\/pre>\n<p>&nbsp;<\/p>\n<h3><strong>Shell script to start PostgreSQL instance<\/strong><\/h3>\n<p>you need to update the following variables before using the script<\/p>\n<ul>\n<li>PATH &#8211; the path where the PostgreSQL binaries are present<\/li>\n<li>PGDATA &#8211; Data directory of your Postgres DB instance<\/li>\n<li>PG_LOG_FILE &#8211; log file location for this DB instance.<\/li>\n<\/ul>\n<p>&nbsp;<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"shell\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">#!\/usr\/bin\/env bash\r\n\r\n\r\nexport PATH=\/usr\/lib\/postgresql\/10\/bin:$PATH\r\n\r\nexport PGDATA=\/var\/lib\/postgresql\/10\/main\r\n\r\nPG_LOG_FILE=\/tmp\/postgres.log\r\n\r\nnum_trys=0\r\n\r\nwhile [[ ${num_trys} -lt 3 ]];do\r\n    if pg_ctl status; then\r\n        echo -e \"postgre is running for PGDATA Location ${PGDATA} \\n\"\r\n        break\r\n    else\r\n        ((num_trys++))\r\n        echo -e \"Airflow PG ${PGDATA} not running \\n\"\r\n        echo -e \"Attempt: ${num_trys} to restart...\"\r\n\r\n        pg_ctl start -D ${PGDATA} -l ${PG_LOG_FILE}\r\n\r\n        echo -e \"Waiting 30 seconds for DB to come up...\"\r\n        sleep 30\r\n\r\n        if pg_ctl status; then\r\n            echo -e \"PG ${PGDATA} has been started successfully...\"\r\n            break\r\n        fi\r\n    fi\r\ndone\r\n<\/pre>\n<p>&nbsp;<\/p>\n<p>Are you in need of any Automation? you give us the challenge\/problem statement we will solve it for you. reach out to us at <a href=\"mailto:rumenlishkoff@gmail.com\">rumenlishkoff@gmail.com\u00a0<\/a><\/p>\n<a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\"><img class=\"post-img\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\" alt=\"gritfy\" width=\"1047\" height=\"415\" class=\"alignnone size-full wp-image-6623\" \/><\/a>\n<p>Cheers<br \/>\nRumen Lishkov<\/p>\n<div id=\"postfollow\">\r\n<a href='https:\/\/ko-fi.com\/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='https:\/\/az743702.vo.msecnd.net\/cdn\/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' \/><\/a>\r\n<p>Follow us on<a href=\"http:\/\/www.facebook.com\/middlewareinventory\">Facebook<\/a> or<a href=\"http:\/\/www.twitter.com\/mwinventory\">Twitter<\/a>\r\n<\/br>\r\nFor more practical videos and tutorials. <a href=\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw?sub_confirmation=1\">Subscribe to our channel<\/a>\r\n<\/br>\r\nFollow me on Linkedin <a href=\"https:\/\/www.linkedin.com\/comm\/mynetwork\/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=saravakmwinventory\">My Profile<\/a>\r\n<\/br>\r\n<\/i>For any Consultation or to hire us <a href=\"mailto:rumenlishkoff@gmail.com\"> rumenlishkoff@gmail.com<\/a>\r\n<\/br>\r\nIf you like this article. Show your Support! <a href=\"https:\/\/ko-fi.com\/middlewareinventory\">Buy me a Coffee.<\/a>\r\n<\/br>\r\n<\/p>\r\n<p style=\"color: palevioletred !important;\">Signup for Exclusive \"Subscriber-only\" Content<\/p>\r\n\n\t\t<div class=\"emaillist\">\n\t\t\t<form action=\"#\" method=\"post\" class=\"es_subscription_form es_shortcode_form\" id=\"es_subscription_form_1670577800\" data-source=\"ig-es\">\n\t\t\t\t\t\t\t\t<div class=\"es-field-wrap\"><label>Name*<br \/><input type=\"text\" name=\"name\" class=\"ig_es_form_field_name\" placeholder=\"\" value=\"\" required=\"required\" \/><\/label><\/div><div class=\"es-field-wrap\"><label>Email*<br \/><input class=\"es_required_field es_txt_email ig_es_form_field_email\" type=\"email\" name=\"email\" value=\"\" placeholder=\"\" required=\"required\" \/><\/label><\/div><input type=\"hidden\" name=\"lists[]\" value=\"1\" \/><input type=\"hidden\" name=\"form_id\" value=\"3\" \/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page\" value=\"8641\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page_url\" value=\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"status\" value=\"Unconfirmed\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es-subscribe\" id=\"es-subscribe\" value=\"7aebfb1a9b\"\/>\n\t\t\t\t<label style=\"position:absolute;top:-99999px;left:-99999px;z-index:-99;\"><input type=\"email\" name=\"es_hp_email\" class=\"es_required_field\" tabindex=\"-1\" autocomplete=\"-1\" value=\"\"\/><\/label>\n\t\t\t\t\t\t\t\t<input type=\"submit\" name=\"submit\" class=\"es_subscription_form_submit es_submit_button es_textbox_button\" id=\"es_subscription_form_submit_1670577800\" value=\"Subscribe\"\/>\n\n\t\t\t\t\n\t\t\t\t<span class=\"es_spinner_image\" id=\"spinner-image\"><img src=\"https:\/\/www.middlewareinventory.com\/wp-content\/plugins\/email-subscribers\/lite\/public\/images\/spinner.gif\" alt=\"Loading\"\/><\/span>\n\n\t\t\t<\/form>\n\n\t\t\t<span class=\"es_subscription_message\" id=\"es_subscription_message_1670577800\"><\/span>\n\t\t<\/div>\n\n\t\t\r\n<\/div>\r\n<hr>\n","protected":false},"excerpt":{"rendered":"<p>In this quick article, we are presenting you with the shell script to start and stop PostgreSQL DB instance. You can use these scripts as part of rc.d or init.dto be executed during the server shutdown and boot up. Feel free to modify it further to suit your needs. Hope[&#8230;]<\/p>\n","protected":false},"author":1,"featured_media":8657,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[453,12],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>PostgreSQL Start and Stop Shell Script | Devops Junction<\/title>\n<meta name=\"description\" content=\"PostgreSQL start and stop shell script. Shell script to start and stop PostgreSQL instance using data directory. pg_ctl inside the shellscript.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"PostgreSQL Start and Stop Shell Script | Devops Junction\" \/>\n<meta property=\"og:description\" content=\"PostgreSQL start and stop shell script. Shell script to start and stop PostgreSQL instance using data directory. pg_ctl inside the shellscript.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2022-06-15T18:33:56+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-06-16T10:04:45+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts.png\" \/>\n\t<meta property=\"og:image:width\" content=\"1748\" \/>\n\t<meta property=\"og:image:height\" content=\"1240\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/shell-scripts.png\",\"width\":1748,\"height\":1240},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/\",\"name\":\"PostgreSQL Start and Stop Shell Script | Devops Junction\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/#primaryimage\"},\"datePublished\":\"2022-06-15T18:33:56+00:00\",\"dateModified\":\"2022-06-16T10:04:45+00:00\",\"description\":\"PostgreSQL start and stop shell script. Shell script to start and stop PostgreSQL instance using data directory. pg_ctl inside the shellscript.\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\"},\"headline\":\"PostgreSQL Start and Stop Shell Script | Devops Junction\",\"datePublished\":\"2022-06-15T18:33:56+00:00\",\"dateModified\":\"2022-06-16T10:04:45+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/#webpage\"},\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/#primaryimage\"},\"articleSection\":\"PostgreSQL,Shell Scripting\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/postgres-startup-and-stop-script\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\",\"name\":\"Rumen Lishkov\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g\",\"caption\":\"Rumen Lishkov\"}}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/8641"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=8641"}],"version-history":[{"count":5,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/8641\/revisions"}],"predecessor-version":[{"id":8659,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/8641\/revisions\/8659"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media\/8657"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=8641"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=8641"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=8641"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}