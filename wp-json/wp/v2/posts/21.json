{"id":21,"date":"2018-07-26T05:58:47","date_gmt":"2018-07-26T10:58:47","guid":{"rendered":"https:\/\/middlewaregyan.wordpress.com\/?p=21"},"modified":"2020-09-29T16:57:51","modified_gmt":"2020-09-29T11:27:51","slug":"oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/","title":{"rendered":"Oracle WebLogic Java Deserialization Vulnerability (CVE-2018-2628)"},"content":{"rendered":"<p><strong>\u00a0Overview<\/strong><\/p>\n<p>Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware (subcomponent: WLS Core Components). Supported versions that are affected are 10.3.6.0, 12.1.3.0, 12.2.1.2 and 12.2.1.3. Easily exploitable vulnerability allows unauthenticated attacker with network access via T3 to compromise Oracle WebLogic Server via unsafe deserialization of Java objects. Successful attacks of this vulnerability can result in takeover of Oracle WebLogic Server.<\/p>\n<p>In a vulnerable system, WebLogic administrators can identify possible Java deserialization attacks if similar exceptions are seen in their WebLogic logs:<\/p>\n<p>To exploit the CVE-2018-2628 vulnerability, the first step is to establish a socket connection with the T3 service available on the service port of WebLogic Server. Therefore, the attack can be blocked by controlling access to the T3 protocol. WebLogic Server provides a default connection filter called weblogic.security.net.ConnectionFilterImpl. This filter accepts all inbound connections. It is advisable to configure a rule through this filter to control access to T3 and T3S protocols.<\/p>\n<p><strong>Connection filter from Weblogic Console<\/strong><\/p>\n<ol>\n<li>Access the administration console of WebLogic Server.<\/li>\n<li>Click\u00a0Base_domain\u00a0in the left pane and then click the\u00a0Security\u00a0and\u00a0Filter\u00a0tabs successively to open the filter configuration page.<\/li>\n<li>Type\u00a0<strong>security.net.ConnectionFilterImpl<\/strong>in the\u00a0Connection Filter\u00a0field and\u00a0* * 7001 deny t3 t3s\u00a0in the\u00a0Connection Filter Rules\u00a0field.<\/li>\n<\/ol>\n<p>Note : Protocols\u00a0specifies the protocols to be filtered. (The value must be\u00a0http,\u00a0https,\u00a0t3,\u00a0t3s,\u00a0iiop,\u00a0iiops,\u00a0 and\/or\u00a0ftp.) If no protocol is specified, all protocols will be filtered.<\/p>\n<ol start=\"4\">\n<li>Click\u00a0Save. Then this rule takes effect immediately without needing a restart.<\/li>\n<\/ol>\n<p><strong>\u00a0<\/strong><\/p>\n<p><strong>Connection filter through Weblogic Server command line<\/strong><\/p>\n<ol>\n<li><strong>\u00a0<\/strong>Access the WebLogic Server through command line Go to <strong>basefolder\/weblogic\/version-directory\/user-projects\/base-domain\/config.<\/strong><\/li>\n<li>Vi <strong>Config.xml<\/strong> and update for\u00a0 weblogic connection filter lines as\u00a0<strong>\u00a0<\/strong>below nodemanager line.<\/li>\n<\/ol>\n<p><em>\u00a0 \u00a0 \u00a0 \u00a0<\/em><em>\u00a0 \u00a0 \u00a0 &lt;connection-filter&gt;weblogic.security.net.ConnectionFilterImpl&lt;\/connection-filter&gt;<\/em><\/p>\n<p><em>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0&lt;connection-filter-rule&gt;10.1.xx.xx 10.1.xx.xx 7001 deny http&lt;\/connection-filter-rule&gt;<\/em><\/p>\n<p><em>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0&lt;connection-logger-enabled&gt;true&lt;\/connection-logger-enabled&gt;<\/em><\/p>\n<p>&nbsp;<\/p>\n<p>Note : Protocols\u00a0specifies the protocols to be filtered. (The value must be\u00a0http,\u00a0https,\u00a0t3,\u00a0t3s,\u00a0iiop,\u00a0iiops,\u00a0 and\/or\u00a0ftp.) If no protocol is specified, all protocols will be filtered.<\/p>\n<ol start=\"2\">\n<li>Click\u00a0Save. Then this rule takes effect immediately without needing a restart . but restarting domain is recommended.<\/li>\n<\/ol>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u00a0Overview Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware (subcomponent: WLS Core Components). Supported versions that are affected are 10.3.6.0, 12.1.3.0, 12.2.1.2 and 12.2.1.3. Easily exploitable vulnerability allows unauthenticated attacker with network access via T3 to compromise Oracle WebLogic Server via unsafe deserialization of Java objects. Successful[&#8230;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[356,21],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Oracle WebLogic Java Deserialization Vulnerability (CVE-2018-2628)<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Oracle WebLogic Java Deserialization Vulnerability (CVE-2018-2628)\" \/>\n<meta property=\"og:description\" content=\"\u00a0Overview Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware (subcomponent: WLS Core Components). Supported versions that are affected are 10.3.6.0, 12.1.3.0, 12.2.1.2 and 12.2.1.3. Easily exploitable vulnerability allows unauthenticated attacker with network access via T3 to compromise Oracle WebLogic Server via unsafe deserialization of Java objects. Successful[...]\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2018-07-26T10:58:47+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2020-09-29T11:27:51+00:00\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/\",\"name\":\"Oracle WebLogic Java Deserialization Vulnerability (CVE-2018-2628)\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"datePublished\":\"2018-07-26T10:58:47+00:00\",\"dateModified\":\"2020-09-29T11:27:51+00:00\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\"},\"headline\":\"Oracle WebLogic Java Deserialization Vulnerability (CVE-2018-2628)\",\"datePublished\":\"2018-07-26T10:58:47+00:00\",\"dateModified\":\"2020-09-29T11:27:51+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/#webpage\"},\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"articleSection\":\"Vulnerabilities &amp; Fixes,weblogic\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/oracle-weblogic-java-deserialization-vulnerability-cve-2018-2628\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\",\"name\":\"Rumen Lishkov\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g\",\"caption\":\"Rumen Lishkov\"}}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/21"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=21"}],"version-history":[{"count":1,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/21\/revisions"}],"predecessor-version":[{"id":4474,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/21\/revisions\/4474"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=21"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=21"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=21"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}