{"id":2715,"date":"2019-01-12T23:39:16","date_gmt":"2019-01-12T18:09:16","guid":{"rendered":"https:\/\/www.middlewareinventory.com\/?p=2715"},"modified":"2022-02-03T17:38:47","modified_gmt":"2022-02-03T12:08:47","slug":"ansible-update-etc-hosts-file-across-all-hosts","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/","title":{"rendered":"ansible update \/etc\/hosts file with IP of all hosts across all hosts"},"content":{"rendered":"<p>In Ansible, SSH Communication is everything. Let it be connecting to remote servers from your controller laptop\/desktop (mac\/windows) or to enable connectivity between servers on the host group.<\/p>\n<p>Especially this will be a huge task to accomplish when you do not have a DNS\u00a0 where each remote host can easily look up the IP of another host.<\/p>\n<p>We all create so many instances in the cloud or in local vagrant for our task or testing, and how we can make them talk to each other and make them be aware of each other.<\/p>\n<p>Let us pretend that we are working on a local environment setup using VAGRANT\u00a0 and trying to build three nodes and build SSH communication between them as well as SSH Key-based authentication.<\/p>\n<p>In order to do that. We need to perform two tasks<\/p>\n<ol class=\"ol1\">\n<li class=\"li1\">Making sure that <strong>each server is aware of the other server&#8217;s IP address in the host group<\/strong> and could resolve the IP using the hostname<\/li>\n<li class=\"li1\">Exchange the SSH public key between each other.<\/li>\n<\/ol>\n<p>The First and primary step is the whole objective of this post. The second item is already covered in my another post <a href=\"https:\/\/www.middlewareinventory.com\/blog\/ssh-key-based-authentication-using-ansible-ad-hoc-and-playbook\/\">Enable SSH Authentication between remote hosts<\/a><\/p>\n<p>Let us proceed.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Ansible-HostUpdate.png\"><img class=\"alignnone size-full wp-image-2730\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Ansible-HostUpdate.png\" alt=\"\" width=\"916\" height=\"559\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Ansible-HostUpdate.png 916w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Ansible-HostUpdate-300x183.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Ansible-HostUpdate-768x469.png 768w\" sizes=\"(max-width: 916px) 100vw, 916px\" \/><\/a><\/p>\n<p>The Pictorial representation of what we are trying to achieve is given above. Hope it makes sense.<\/p>\n<p>&nbsp;<\/p>\n<h2>Domain Name Resolution or DNS Lookup<\/h2>\n<p>As mentioned earlier, if you are at industrial infrastructure with internal DNS available.<\/p>\n<p>Each server you provision will have an entry in there and you should be able to resolve an IP and\u00a0perform DNS lookup across the hosts you provision in your infrastructure with no further hurdles.<\/p>\n<p>But in the local environmental setup like VAGRANT with NO dedicated DNS server. Or if you are not having any internal DNS system.<\/p>\n<p>There is no option other than placing an entry manually into <code>\/etc\/hosts<\/code> file ( I presume you are aware of this file and what it does).<\/p>\n<p>We call it a Local DNS lookup or First level DNS lookup. This helps me achieve the same thing that external DNS does.<\/p>\n<p>So what we are trying to do here is that.<strong>\u00a0<span style=\"font-size: 14pt; color: #0b487a;\">I should be able to resolve the IP of all other hosts from the server I am trying without a DNS server in place<\/span><\/strong><\/p>\n<p>&nbsp;<\/p>\n<h2>Practical Implementation\/Example<\/h2>\n<p>I have three hosts newly built and named as follows<\/p>\n<ul>\n<li>mwivmapp01 (192.168.16.11)<\/li>\n<li>mwivmapp02 (192.168.16.12)<\/li>\n<li>mwisqldb01 (192.168.16.13)<\/li>\n<\/ul>\n<blockquote><p>To enable communication between them and to transfer files between these remote server, I should be able to resolve the IP of all other hosts from the server I am trying.<\/p>\n<p>For Instance, From<code>mwiapp01<\/code>\u00a0If I\u00a0\u00a0nslookup\u00a0<code>mwiapp02<\/code> and <code>mwiapp03<\/code>. I should get their corresponding IP address resolved\u00a0 the important thing here is that we have to do it with out DNS server in place.<\/p>\n<p>So we need to make an entry using in \/etc\/hosts of all servers with other server IP and hostnames<\/p><\/blockquote>\n<p>Let us look at the before and after snapshots of \/etc\/hosts file of each individual host\/server for more clarity before implementing.<\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<h3>Before \/etc\/hosts file update<\/h3>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.50.41-PM.png\"><img class=\"alignnone size-full wp-image-2718\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.50.41-PM.png\" alt=\"\" width=\"928\" height=\"264\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.50.41-PM.png 928w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.50.41-PM-300x85.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.50.41-PM-768x218.png 768w\" sizes=\"(max-width: 928px) 100vw, 928px\" \/><\/a><\/p>\n<h3>After \/etc\/hosts\/ file update ( Expected Result )<\/h3>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.42.46-PM.png\"><img class=\"alignnone size-full wp-image-2717\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.42.46-PM.png\" alt=\"ansible \/etc\/hosts\/ file update\" width=\"919\" height=\"421\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.42.46-PM.png 919w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.42.46-PM-300x137.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Screen-Shot-2019-01-12-at-7.42.46-PM-768x352.png 768w\" sizes=\"(max-width: 919px) 100vw, 919px\" \/><\/a><\/p>\n<p>Here, you can see All the servers have their fellow group member&#8217;s IP addresses including their own. Thanks to Jinja2 and variables of Ansible.<\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<h2>Playbook to make an entry of all server IPs across all the servers in the hosts file.<\/h2>\n<p>This Playbook given here is <strong>generic<\/strong>. It will work for any number of servers as long as they are in the same host group.<\/p>\n<p>All you have to do is change the host group from <code>multi<\/code> to whatever you are going to use. ( in two places)<\/p>\n<pre class=\"hljs\" style=\"display: block; overflow-x: auto; padding: 0.5em; background: #282a36; color: #f8f8f2;\"><span class=\"hljs-meta\" style=\"color: #6272a4;\">---<\/span>\r\n<span class=\"hljs-attr\">  - name:<\/span> host file update - Local DNS setup across all the servers\r\n<span class=\"hljs-attr\">    hosts:<\/span> multi\r\n<span class=\"hljs-attr\">    gather_facts:<\/span> <span class=\"hljs-literal\" style=\"color: #8be9fd; font-weight: bold;\">yes<\/span>\r\n<span class=\"hljs-attr\">    tasks:<\/span>\r\n\r\n<span class=\"hljs-attr\">    - name:<\/span> Update the \/etc\/hosts file with node name\r\n<span class=\"hljs-attr\">      tags:<\/span> etchostsupdate\r\n<span class=\"hljs-attr\">      become:<\/span> <span class=\"hljs-literal\" style=\"color: #8be9fd; font-weight: bold;\">yes<\/span>\r\n<span class=\"hljs-attr\">      become_user:<\/span> root\r\n<span class=\"hljs-attr\">      lineinfile:<\/span>\r\n<span class=\"hljs-attr\">        path:<\/span> <span class=\"hljs-string\" style=\"color: #f1fa8c;\">\"\/etc\/hosts\"<\/span>\r\n<span class=\"hljs-attr\">        regexp:<\/span> <span class=\"hljs-string\" style=\"color: #f1fa8c;\">\"<span style=\"color: #ffff00;\">.*<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #f1fa8c;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #f1fa8c;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\">        line:<\/span> <span class=\"hljs-string\" style=\"color: #f1fa8c;\">\"<span class=\"hljs-template-variable\" style=\"color: #f1fa8c;\">{{ hostvars[item]['ansible_env'].SSH_CONNECTION.split(' ')[2] }}<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #f1fa8c;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #f1fa8c;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\">        state:<\/span> present\r\n<span class=\"hljs-attr\">        backup:<\/span> <span class=\"hljs-literal\" style=\"color: #8be9fd; font-weight: bold;\">yes<\/span>\r\n<span class=\"hljs-attr\">      register:<\/span> etchostsupdate\r\n<span class=\"hljs-attr\">      when:<\/span> ansible_hostname != <span class=\"hljs-string\" style=\"color: #f1fa8c;\">\"<span class=\"hljs-template-variable\" style=\"color: #f1fa8c;\">{{ item }}<\/span>\"<\/span> or ansible_hostname == <span class=\"hljs-string\" style=\"color: #f1fa8c;\">\"<span class=\"hljs-template-variable\" style=\"color: #f1fa8c;\">{{ item }}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\">      with_items:<\/span> <span class=\"hljs-string\" style=\"color: #f1fa8c;\">\"<span class=\"hljs-template-variable\" style=\"color: #f1fa8c;\">{{groups['multi']}}<\/span>\"<\/span><\/pre>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n<h2>For AWS EC2 instances &#8211; To Exchange the Private IP between hosts<\/h2>\n<p>The following snippet is designed to exchange the private IP address of host group members. this example is most suitable when you want to use the private IP address while updating the<code>\/etc\/hosts<\/code>\u00a0file<\/p>\n<pre class=\"hljs\" style=\"display: block; overflow-x: auto; padding: 0.5em; background: #232323; color: #e6e1dc;\"><span class=\"hljs-attr\" style=\"color: #6d9cbe;\">- name:<\/span> Update the \/etc\/hosts file with node name\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  tags:<\/span> etchostsupdate\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  become:<\/span> <span class=\"hljs-literal\">yes<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  become_user:<\/span> root\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  lineinfile:<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    dest:<\/span> <span class=\"hljs-string\" style=\"color: #a5c261;\">\"\/etc\/hosts\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    regexp:<\/span> <span class=\"hljs-string\" style=\"color: #a5c261;\">\".*\\t<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    line:<\/span> <span class=\"hljs-string\" style=\"color: #a5c261;\">\"<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ hostvars[item]['ansible_default_ipv4']['address'] }}<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    state:<\/span> present\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    backup:<\/span> <span class=\"hljs-literal\">yes<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  register:<\/span> etchostsupdate\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  when:<\/span> ansible_hostname != <span class=\"hljs-string\" style=\"color: #a5c261;\">\"<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ item }}<\/span>\"<\/span> or ansible_hostname == <span class=\"hljs-string\" style=\"color: #a5c261;\">\"<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ item }}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  with_items:<\/span> <span class=\"hljs-string\" style=\"color: #a5c261;\">\"<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{groups['launched']}}<\/span>\"<\/span><\/pre>\n<p>&nbsp;<\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<p>&nbsp;<\/p>\n<h2>For AWS EC2 instances &#8211; To Exchange the Public IP between hosts<\/h2>\n<p>While Private IP addresses are merely for internal communication. we might sometimes need to do the same task of\u00a0<code>\/etc\/hosts<\/code>\u00a0file update amongst the host group members with <code>public ip addresses<\/code><\/p>\n<p>Let&#8217;s suppose you have a few AWS EC2 instances and you are trying to connect to all of them from your local machine and you want all of these EC2 instances to talk to themselves over public IP, Then this is for you.<\/p>\n<p>the EC2 instance would not be aware of its public IP so there would be no public IP related references on the Ansible Facts or variables. The only way to determine the public IP is to rely on the <code>ansible_hosts<\/code>\u00a0file.<\/p>\n<blockquote><p>So this method would work only if you are using the Public IP to connect to the remote hosts from the control machine. In other words, Public IPs should have been used for this type to work.<\/p><\/blockquote>\n<pre class=\"hljs\" style=\"display: block; overflow-x: auto; padding: 0.5em; background: #232323; color: #e6e1dc;\"><span class=\"hljs-attr\" style=\"color: #6d9cbe;\">- name:<\/span> Update the \/etc\/hosts file with node name\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  tags:<\/span> etchostsupdate\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  become:<\/span> <span class=\"hljs-literal\">yes<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  become_user:<\/span> root\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  lineinfile:<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    dest:<\/span> <span class=\"hljs-string\" style=\"color: #a5c261;\">\"\/etc\/hosts\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    regexp:<\/span> <span class=\"hljs-string\" style=\"color: #a5c261;\">\".*\\t<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    line:<\/span> <span class=\"hljs-string\" style=\"color: #a5c261;\">\"<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ inventory_hostname }}<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\\t<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ hostvars[item]['ansible_hostname']}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    state:<\/span> present\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">    backup:<\/span> <span class=\"hljs-literal\">yes<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  register:<\/span> etchostsupdate\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  when:<\/span> inventory_hostname != <span class=\"hljs-string\" style=\"color: #a5c261;\">\"<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ item }}<\/span>\"<\/span> or inventory_hostname == <span class=\"hljs-string\" style=\"color: #a5c261;\">\"<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{ item }}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #6d9cbe;\">  with_items:<\/span> <span class=\"hljs-string\" style=\"color: #a5c261;\">\"<span class=\"hljs-template-variable\" style=\"color: #a5c261;\">{{groups['launched']}}<\/span>\"<\/span>\r\n<\/pre>\n<p>&nbsp;<\/p>\n<h2>See it in Action<\/h2>\n<div class=\"lyte-wrapper\" style=\"width:640px;max-width:100%;margin:5px;\"><div class=\"lyMe\" id=\"WYL_B3dly71WB6s\"><div id=\"lyte_B3dly71WB6s\" data-src=\"\/\/i.ytimg.com\/vi\/B3dly71WB6s\/hqdefault.jpg\" class=\"pL\"><div class=\"tC\"><div class=\"tT\"><\/div><\/div><div class=\"play\"><\/div><div class=\"ctrl\"><div class=\"Lctrl\"><\/div><div class=\"Rctrl\"><\/div><\/div><\/div><noscript><a href=\"https:\/\/youtu.be\/B3dly71WB6s\"><img src=\"https:\/\/i.ytimg.com\/vi\/B3dly71WB6s\/0.jpg\" alt=\"\" width=\"640\" height=\"340\" \/><br \/>Watch this video on YouTube<\/a><\/noscript><\/div><\/div><div class=\"lL\" style=\"max-width:100%;width:640px;margin:5px;\"><\/div><\/p>\n<p>As said earlier, this is a First Step of enabling an SSH Key-based authentication between remote hosts.<\/p>\n<p>The Next step is to exchange the key between remote servers so that Passwordless SSH Key-based authentication can be achieved.\u00a0 Continue to read,\u00a0<a href=\"https:\/\/www.middlewareinventory.com\/blog\/ssh-key-based-authentication-using-ansible-ad-hoc-and-playbook\/\"> Enable SSH Authentication between remote hosts<\/a><\/p>\n<p>Hope this helps.<\/p>\n<p>Cheers,<br \/>\nRumen Lishkov<\/p>\n<div id=\"postfollow\">\r\n<a href='https:\/\/ko-fi.com\/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='https:\/\/az743702.vo.msecnd.net\/cdn\/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' \/><\/a>\r\n<p>Follow us on<a href=\"http:\/\/www.facebook.com\/middlewareinventory\">Facebook<\/a> or<a href=\"http:\/\/www.twitter.com\/mwinventory\">Twitter<\/a>\r\n<\/br>\r\nFor more practical videos and tutorials. <a href=\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw?sub_confirmation=1\">Subscribe to our channel<\/a>\r\n<\/br>\r\nFollow me on Linkedin <a href=\"https:\/\/www.linkedin.com\/comm\/mynetwork\/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=saravakmwinventory\">My Profile<\/a>\r\n<\/br>\r\n<\/i>For any Consultation or to hire us <a href=\"mailto:rumenlishkoff@gmail.com\"> rumenlishkoff@gmail.com<\/a>\r\n<\/br>\r\nIf you like this article. Show your Support! <a href=\"https:\/\/ko-fi.com\/middlewareinventory\">Buy me a Coffee.<\/a>\r\n<\/br>\r\n<\/p>\r\n<p style=\"color: palevioletred !important;\">Signup for Exclusive \"Subscriber-only\" Content<\/p>\r\n\n\t\t<div class=\"emaillist\">\n\t\t\t<form action=\"#\" method=\"post\" class=\"es_subscription_form es_shortcode_form\" id=\"es_subscription_form_1670577890\" data-source=\"ig-es\">\n\t\t\t\t\t\t\t\t<div class=\"es-field-wrap\"><label>Name*<br \/><input type=\"text\" name=\"name\" class=\"ig_es_form_field_name\" placeholder=\"\" value=\"\" required=\"required\" \/><\/label><\/div><div class=\"es-field-wrap\"><label>Email*<br \/><input class=\"es_required_field es_txt_email ig_es_form_field_email\" type=\"email\" name=\"email\" value=\"\" placeholder=\"\" required=\"required\" \/><\/label><\/div><input type=\"hidden\" name=\"lists[]\" value=\"1\" \/><input type=\"hidden\" name=\"form_id\" value=\"3\" \/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page\" value=\"2715\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page_url\" value=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"status\" value=\"Unconfirmed\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es-subscribe\" id=\"es-subscribe\" value=\"7aebfb1a9b\"\/>\n\t\t\t\t<label style=\"position:absolute;top:-99999px;left:-99999px;z-index:-99;\"><input type=\"email\" name=\"es_hp_email\" class=\"es_required_field\" tabindex=\"-1\" autocomplete=\"-1\" value=\"\"\/><\/label>\n\t\t\t\t\t\t\t\t<input type=\"submit\" name=\"submit\" class=\"es_subscription_form_submit es_submit_button es_textbox_button\" id=\"es_subscription_form_submit_1670577890\" value=\"Subscribe\"\/>\n\n\t\t\t\t\n\t\t\t\t<span class=\"es_spinner_image\" id=\"spinner-image\"><img src=\"https:\/\/www.middlewareinventory.com\/wp-content\/plugins\/email-subscribers\/lite\/public\/images\/spinner.gif\" alt=\"Loading\"\/><\/span>\n\n\t\t\t<\/form>\n\n\t\t\t<span class=\"es_subscription_message\" id=\"es_subscription_message_1670577890\"><\/span>\n\t\t<\/div>\n\n\t\t\r\n<\/div>\r\n<hr>\n","protected":false},"excerpt":{"rendered":"<p>In Ansible, SSH Communication is everything. Let it be connecting to remote servers from your controller laptop\/desktop (mac\/windows) or to enable connectivity between servers on the host group. Especially this will be a huge task to accomplish when you do not have a DNS\u00a0 where each remote host can easily[&#8230;]<\/p>\n","protected":false},"author":1,"featured_media":2730,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[98],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>ansible update \/etc\/hosts file with IP of all hosts across all hosts<\/title>\n<meta name=\"description\" content=\"In this post, we are going to discuss how to update \/etc\/hosts file of all servers in ansible, thereby enabling a host-based communication between all hosts. The servers in the ansible hosts group should be able to resolve the IP of each other. Ansible playbook to add an entry in hosts file.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"ansible update \/etc\/hosts file with IP of all hosts across all hosts\" \/>\n<meta property=\"og:description\" content=\"In this post, we are going to discuss how to update \/etc\/hosts file of all servers in ansible, thereby enabling a host-based communication between all hosts. The servers in the ansible hosts group should be able to resolve the IP of each other. Ansible playbook to add an entry in hosts file.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2019-01-12T18:09:16+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-02-03T12:08:47+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Ansible-HostUpdate.png\" \/>\n\t<meta property=\"og:image:width\" content=\"916\" \/>\n\t<meta property=\"og:image:height\" content=\"559\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2019\/01\/Ansible-HostUpdate.png\",\"width\":916,\"height\":559},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/\",\"name\":\"ansible update \/etc\/hosts file with IP of all hosts across all hosts\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/#primaryimage\"},\"datePublished\":\"2019-01-12T18:09:16+00:00\",\"dateModified\":\"2022-02-03T12:08:47+00:00\",\"description\":\"In this post, we are going to discuss how to update \/etc\/hosts file of all servers in ansible, thereby enabling a host-based communication between all hosts. The servers in the ansible hosts group should be able to resolve the IP of each other. Ansible playbook to add an entry in hosts file.\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\"},\"headline\":\"ansible update \/etc\/hosts file with IP of all hosts across all hosts\",\"datePublished\":\"2019-01-12T18:09:16+00:00\",\"dateModified\":\"2022-02-03T12:08:47+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/#webpage\"},\"commentCount\":2,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/#primaryimage\"},\"articleSection\":\"Ansible\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\",\"name\":\"Rumen Lishkov\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g\",\"caption\":\"Rumen Lishkov\"}}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/2715"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=2715"}],"version-history":[{"count":5,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/2715\/revisions"}],"predecessor-version":[{"id":8086,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/2715\/revisions\/8086"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media\/2730"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=2715"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=2715"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=2715"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}