{"id":1667,"date":"2018-08-29T14:45:27","date_gmt":"2018-08-29T09:15:27","guid":{"rendered":"http:\/\/www.middlewareinventory.com\/?p=1667"},"modified":"2022-06-19T11:33:42","modified_gmt":"2022-06-19T06:03:42","slug":"how-to-copy-files-between-remote-servers-ansible-fetch-sync","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/","title":{"rendered":"How to Copy files between remote hosts in ansible"},"content":{"rendered":"<p><strong>How to copy files between remote servers in Ansible ?<\/strong>. is the purpose behind this article.\u00a0 Every article I went and read was giving me suggestions but nothing practical. I simply wanted to do make ansible rsync. I wanted to execute <code>rsync<\/code> between remote hosts and copy files between remote hosts.<\/p>\n<p>So here is the example oriented article.\u00a0 In this post, we are going to discuss the two major options available to copy the files between remote servers or remote to remote.<\/p>\n<p>When we want to copy files from one host to another host, in general, the first thing comes in our mind is SCP and ansible have a dedicated module for the same-named <code>COPY<\/code><\/p>\n<p>If you want to copy a file from an Ansible Control Master to remote hosts, the COPY (scp) module would be just fine. But we need something more when we want to copy the files between the remote hosts or to copy files between remote to remote.<\/p>\n<p>We are going to use some of the ansible modules like <strong>copy<\/strong>, <strong>fetch<\/strong>, <strong>synchronize<\/strong> to accomplish the requirement of copying the files between hosts in ansible.<\/p>\n<p>While we are already aware of what is Ansible Copy module is used for.<\/p>\n<p>Here is the Simple introduction to Ansible Fetch and Ansible Synchronize.<\/p>\n<blockquote><p>Ansible <strong>Fetch<\/strong> is to pull the files from the remote server to the control machine.<\/p>\n<p>Ansible <strong>Synchronize<\/strong> is used to copy the files between remote servers (or) target hosts.\u00a0 This is more like performing RSYNC with help of Ansible.<\/p><\/blockquote>\n<p>&nbsp;<\/p>\n<h2><span style=\"color: #003366;\">The <span style=\"color: #eb1773;\">Index<\/span><\/span><\/h2>\n<ol>\n<li>The Plan \/ The Requirement<\/li>\n<li>Method1: Copy files between remote hosts using fetch module<\/li>\n<li>Method2: Copy file between remote hosts using synchronize module\n<ol style=\"list-style-type: lower-alpha;\">\n<li>Synchronize Push<\/li>\n<li>Synchronize Pull<\/li>\n<\/ol>\n<\/li>\n<li>The Execution Output<\/li>\n<li>References and Other Related Articles.<\/li>\n<\/ol>\n<p>&nbsp;<\/p>\n<h2 id=\"sec1\"><span style=\"color: #003366;\">The <span style=\"color: #eb1773;\">Plan<\/span> \/ The Requirement<\/span><\/h2>\n<p>To get started, let us define some requirement ourselves so that, we could relate and be on the same page.<\/p>\n<p>We have two servers named as follows<\/p>\n<ol>\n<li>mwiappi01<\/li>\n<li>mwiapp02<\/li>\n<\/ol>\n<p>The requirement is to <strong>copy a file from mwiapp01 to mwiapp02.<\/strong> Before we proceed, This is the infrastructure\u00a0diagram of our setup.<\/p>\n<blockquote><p>\u00a0Do not get confused by the name Master.\u00a0 It is just a control machine. Remember\u00a0 Ansible is agent less. so there is no master and slave.<\/p><\/blockquote>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Infra1.png\"><img class=\"size-full wp-image-1669 aligncenter\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Infra1.png\" alt=\"\" width=\"618\" height=\"267\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Infra1.png 618w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Infra1-300x130.png 300w\" sizes=\"(max-width: 618px) 100vw, 618px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n<h2 id=\"sec2\"><span style=\"color: #003366;\">Method1: Copy from app01 to app02 using <span style=\"color: #eb1773;\">fetch<\/span> module<\/span><\/h2>\n<p><strong>\u00a0 NO SSH Authentication required between remote nodes for this method<\/strong><\/p>\n<p>This is the best\u00a0and easiest option to transfer files between the remote nodes When you do not have SSH Key based Authentication enabled between the remote nodes. Though, it is\u00a0not the shortest path (or) beeline. It\u00a0works well where our primary focus is to get the job done whatsoever the approach may be.<\/p>\n<p>it is a two-step process when it comes to this method.<\/p>\n<p><strong>Step1:\u00a0<\/strong> <strong>Fetch<\/strong> the file from the remote server (source) to the ansible master<\/p>\n<p><strong>Step2:<\/strong>\u00a0 Push (<strong>Copy<\/strong>) the file from the ansible master to the remote server ( destination)<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-28-at-2.08.30-PM.png\"><img class=\"alignnone size-full wp-image-1674\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-28-at-2.08.30-PM.png\" alt=\"\" width=\"736\" height=\"317\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-28-at-2.08.30-PM.png 736w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-28-at-2.08.30-PM-300x129.png 300w\" sizes=\"(max-width: 736px) 100vw, 736px\" \/><\/a><\/p>\n<p>Here the master acts like a buffer where the files are temporarily stored and then transferred.<\/p>\n<p>Consider the following playbook which performs both these above-mentioned tasks.<\/p>\n<pre class=\"hljs\" style=\"display: block; background: #ffffff; padding: 0.5em; color: #333333; overflow-x: auto;\"><span class=\"hljs-meta\" style=\"color: #969896;\">---<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #795da3;\"> - hosts:<\/span> app\r\n<span class=\"hljs-attr\" style=\"color: #795da3;\">   tasks:<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #795da3;\">     - name:<\/span> Fetch the file from the mwiapp01 to master\r\n<span class=\"hljs-attr\" style=\"color: #795da3;\">       run_once:<\/span> <span class=\"hljs-literal\" style=\"color: #0086b3;\">yes<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #795da3;\">       fetch:<\/span> src=\/tmp\/app01-to-app02.jar dest=buffer\/ flat=<span class=\"hljs-literal\" style=\"color: #0086b3;\">yes<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #795da3;\">       when:<\/span> <span class=\"hljs-string\" style=\"color: #df5000;\">\"<span class=\"hljs-template-variable\" style=\"color: #df5000;\">{{ inventory_hostname == 'mwiapp01' }}<\/span>\"<\/span>\r\n\r\n<span class=\"hljs-attr\" style=\"color: #795da3;\">     - name:<\/span> Copy the file from master to mwiapp02\r\n<span class=\"hljs-attr\" style=\"color: #795da3;\">       copy:<\/span> src=buffer\/app01-to-app02.jar dest=\/tmp\/\r\n<span class=\"hljs-attr\" style=\"color: #795da3;\">       when:<\/span> <span class=\"hljs-string\" style=\"color: #df5000;\">\"<span class=\"hljs-template-variable\" style=\"color: #df5000;\">{{ inventory_hostname == 'mwiapp02' }}<\/span>\"<\/span><\/pre>\n<p>here we use <code>\"when\" <\/code>\u00a0to perform\u00a0the conditional based execution and\u00a0\u00a0<code>inventory_hostname<\/code> is the ansible built-in variable which will point the current execution remote hostname.<\/p>\n<blockquote><p>\u00a0Sometimes you might need to use <code>ansible_hostname<\/code> in place of <code>inventory_hostname<\/code><\/p>\n<p>Read<a href=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-inventory_hostname-ansible_hostname-variables\/\"> this article<\/a> to know the difference\u00a0 between ansible_hostname and inventory_hostname<\/p><\/blockquote>\n<p>We are basically instructing the Ansible to execute the\u00a0 Fetch task only on the <code>mwiapp01<\/code>\u00a0server and copy task only when the <code>mwiapp02<\/code> is the current remote execution host.<\/p>\n<p><script id=\"asciicast-0ARrBU5GOdNzPZnf0s8oyAX5p\" src=\"https:\/\/asciinema.org\/a\/0ARrBU5GOdNzPZnf0s8oyAX5p.js\" async><\/script><br \/>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script><\/p>\n<p>&nbsp;<\/p>\n<h2 id=\"sec3\"><span style=\"font-size: 18pt;\"><span style=\"color: #003366;\">Method 2:<\/span>\u00a0<span style=\"color: #003366;\">Copy from app01 to app02 using\u00a0<span style=\"color: #eb1773;\">synchronize<\/span> module <\/span><\/span><\/h2>\n<p><strong>SSH Key based authentication must be enabled between remote hosts<\/strong><\/p>\n<p>For Synchronize module to work hassle-free,SSH Key-based authentication must be enabled between remote nodes. otherwise, the synchronize task will get stuck and so does your Ansible play.<\/p>\n<p>In other words, the remote nodes should be able to login to each other without having to enter the password manually. We achieve\u00a0this mostly with the help of SSH key.<\/p>\n<p>As said earlier. Ansible Synchronize is more like Ansible RSYNC. the typical <code>rsync<\/code> feature of Linux.<\/p>\n<p>To know how to enable Key-based Authentication just in seconds, Refer to the following article<\/p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"efVpRO3WU6\"><p><a href=\"https:\/\/www.middlewareinventory.com\/blog\/ssh-key-based-authentication-using-ansible-ad-hoc-and-playbook\/\">Enable SSH Key based authentication using Ansible<\/a><\/p><\/blockquote>\n<p><iframe class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https:\/\/www.middlewareinventory.com\/blog\/ssh-key-based-authentication-using-ansible-ad-hoc-and-playbook\/embed\/#?secret=efVpRO3WU6\" data-secret=\"efVpRO3WU6\" width=\"600\" height=\"338\" title=\"&#8220;Enable SSH Key based authentication using Ansible&#8221; &#8212; Middleware Inventory\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"><\/iframe><\/p>\n<p>Once we are ready with the SSH Key-based authentication. We are ready to play the play. ( playbook).<\/p>\n<p>There are two methods to copy files using the Synchronize module<\/p>\n<ol>\n<li>Synchronize Pull<\/li>\n<li>Synchronize Push<\/li>\n<\/ol>\n<p>Consider the following playbooks which copies the file from <code>mwiapp01<\/code> to <code>mwiapp02<\/code> using both <strong>Synchronize Pull<\/strong> and <strong>Synchronize Push<\/strong> method<\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n<h3 id=\"sec4\"><span style=\"color: #003366;\">Synchronize <span style=\"color: #e61263;\">Pull<\/span><\/span><\/h3>\n<p><strong>Targeted to:\u00a0<\/strong>\u00a0Source Server (mwiapp01)<\/p>\n<p><strong>Delegated to and Executed on:<\/strong>\u00a0Destination Server (mwiapp02)<\/p>\n<p><strong>Explanation:<\/strong>\u00a0 As it is being executed in the destination server where the file has to arrive.\u00a0 The task is to pull the file from the Origin (or) source server.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/SyncPull.png\"><img class=\"size-full wp-image-1691 aligncenter\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/SyncPull.png\" alt=\"\" width=\"522\" height=\"353\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/SyncPull.png 522w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/SyncPull-300x203.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/SyncPull-120x80.png 120w\" sizes=\"(max-width: 522px) 100vw, 522px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<p>Here is the playbook which gets executed on the destination server <code>mwiapp02<\/code>\u00a0 with help of delegation and <code>pulls<\/code> the file from mwiapp01 to mwiapp02<\/p>\n<pre class=\"hljs\" style=\"display: block; overflow-x: auto; padding: 0.5em; background: #ffffff; color: #000000;\"><span class=\"hljs-meta\" style=\"color: #1c00cf;\">---<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">- name:<\/span> Sync Pull task - Executed on  the Destination host <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{groups['app'][1]}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">  hosts:<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{groups['app'][0]}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">  user:<\/span> wlsusr\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">  tasks:<\/span>   \r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">    - name:<\/span> Copy the file from mwiapp01 to mwiapp02 using Method Pull\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      tags:<\/span> sync-pull\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      synchronize:<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">        src:<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{ item }}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">        dest:<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{ item }}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">        mode:<\/span> pull\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      delegate_to:<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{groups['app'][1]}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      register:<\/span> syncfile\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      run_once:<\/span> <span class=\"hljs-literal\" style=\"color: #aa0d91;\">true<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      with_items:<\/span>\r\n<span class=\"hljs-bullet\" style=\"color: #1c00cf;\">       -<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"\/tmp\/app01-to-app02.jar\"<\/span><\/pre>\n<p>&nbsp;<\/p>\n<p>You might think the playbook is set to execute on the first server as the <code>hosts<\/code>\u00a0directive is targeting the first server. <code>hosts: \"{{group[app][0]}}\"<\/code>\u00a0mwiapp01<\/p>\n<p>But you have to notice that we are actually executing this task on the second server <code>mwiapp02\u00a0<\/code>\u00a0with the help of <code>delegate_to<\/code><\/p>\n<p>Look at the following Screen record to understand this better.<\/p>\n<p><script id=\"asciicast-ObeyD6EKRjUyN9akCElnfP6eF\" src=\"https:\/\/asciinema.org\/a\/ObeyD6EKRjUyN9akCElnfP6eF.js\" async><\/script><\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n<h3 id=\"sec5\"><span style=\"color: #003366;\">Synchronize <span style=\"color: #e61263;\">Push<\/span><\/span><\/h3>\n<p><strong>Targeted to: <\/strong>Destination Server (mwiapp02)<\/p>\n<p><strong>Delegated to and Executed on:\u00a0<\/strong>Source Server (mwiapp01)<\/p>\n<p><strong>Explanation:<\/strong>\u00a0 As it is being executed in the source server where the file is already present.\u00a0 The task is to push the file to the destination server<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/SyncPush-1.png\"><img class=\"size-full wp-image-1692 aligncenter\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/SyncPush-1.png\" alt=\"\" width=\"632\" height=\"306\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/SyncPush-1.png 632w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/SyncPush-1-300x145.png 300w\" sizes=\"(max-width: 632px) 100vw, 632px\" \/><\/a><\/p>\n<p>Here is the playbook which gets executed on the source server <code>mwiapp01<\/code>\u00a0and <code>pushes<\/code> the file from 01 to 02<\/p>\n<pre class=\"hljs\" style=\"display: block; overflow-x: auto; padding: 0.5em; background: #ffffff; color: #000000;\"><span class=\"hljs-attr\" style=\"color: #5c2699;\">\r\n- name:<\/span> Sync Push task - Executed on source host <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{groups['app'][0]}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">  hosts:<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{groups['app'][1]}}<\/span>\"<\/span> \r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">  user:<\/span> wlsusr\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">  tasks:<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">    - name:<\/span> Copy the file from mwiapp01 to mwiapp02 using Method Push\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      tags:<\/span> sync-push\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      synchronize:<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">        src:<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{ item }}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">        dest:<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{ item }}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">        mode:<\/span> push\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      delegate_to:<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"<span class=\"hljs-template-variable\" style=\"color: #666600;\">{{groups['app'][0]}}<\/span>\"<\/span>\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      register:<\/span> syncfile\r\n<span class=\"hljs-attr\" style=\"color: #5c2699;\">      with_items:<\/span>\r\n<span class=\"hljs-bullet\" style=\"color: #1c00cf;\">       -<\/span> <span class=\"hljs-string\" style=\"color: #c41a16;\">\"\/tmp\/app01-to-app02.jar\"<\/span><\/pre>\n<p>&nbsp;<\/p>\n<p>You might think the playbook is set to execute on the second server as the <code>hosts<\/code>\u00a0directive is targeting the first server. <code>hosts: \"{{group[app][1]}}\"<\/code>\u00a0mwiapp02<\/p>\n<p>But you have to notice that we are actually executing this task on the first server <code>mwiapp01<\/code> with the help of <code>delegate_to<\/code><\/p>\n<p>The Playbook is made up of two host-based tasks list.\u00a0 The First one runs using Synchronize Pull will run on <code>mwiapp02<\/code>and the second one with Synchronize Push will run on <code>mwiapp01<\/code><\/p>\n<p>Though the playbook is intelligible ( easy to understand).\u00a0 I feel there are some peculiar lines which need more explanation, like\u00a0<code>\"{{groups['app'][0]}}\"\u00a0<\/code><\/p>\n<p>It represents the first element\u00a0 (or) server of the host group named <strong>&#8220;app&#8221; <\/strong>just like an array<\/p>\n<p>Hope the following image would make it clear.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-1.29.43-PM.png\"><img class=\"alignnone size-full wp-image-1696\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-1.29.43-PM.png\" alt=\"\" width=\"992\" height=\"274\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-1.29.43-PM.png 992w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-1.29.43-PM-300x83.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-1.29.43-PM-768x212.png 768w\" sizes=\"(max-width: 992px) 100vw, 992px\" \/><\/a><\/p>\n<p>Other two important lines in the file are as follows<\/p>\n<ul>\n<li><strong>mode<\/strong>\u00a0 It represents the model of the Synchronize. Either Synchronize pull or Synchronize push<\/li>\n<li><strong>delegate_to\u00a0<\/strong>It tells ansible, where the task (or) command should actually be executed.<\/li>\n<\/ul>\n<p>Hope you might have got it by now.\u00a0 <code>delegate_to<\/code> and the <code>hosts<\/code>\u00a0 along with <code>mode<\/code> in ansible-playbook,\u00a0 work together to make the remote execution (or) copy between remote nodes possible.<\/p>\n<p>&nbsp;<\/p>\n<p id=\"Sec6\">Execution Output<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-2.01.53-PM.png\"><img class=\"alignnone size-full wp-image-1697\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-2.01.53-PM.png\" alt=\"\" width=\"1042\" height=\"789\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-2.01.53-PM.png 1042w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-2.01.53-PM-300x227.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-2.01.53-PM-768x582.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-2.01.53-PM-1024x775.png 1024w\" sizes=\"(max-width: 1042px) 100vw, 1042px\" \/><\/a><\/p>\n<p>In the preceding\u00a0screenshot, we have executed 3 commands. First one and the last one is an Ansible <strong>ad-hoc<\/strong> command to check the availability of the file under the <code>\/tmp<\/code>directory in <code>mwiapp02<\/code>server<\/p>\n<blockquote><p>we use <code>--limit<\/code>\u00a0to execute the command in only one server, though we use the hostgroup which contains two servers.<\/p><\/blockquote>\n<p>we have successfully copied a file from <strong>mwiapp01<\/strong> to <strong>mwiapp02<\/strong>\u00a0 using both <strong><span style=\"color: #c41478;\">Fetch<\/span><\/strong> and <strong><span style=\"color: #c41478;\">Synchronize<\/span><\/strong> modules.<\/p>\n<p>&nbsp;<\/p>\n<h2><span style=\"color: #003366;\">Conclusion<\/span><\/h2>\n<p>In this post, we have Successfully learnt and executed how to copy files between remote hosts using ansible copy and fetch modules. We have learnt two methods to copy the files between hosts using ansible.<\/p>\n<p>Hope you find this article helpful.<\/p>\n<p>&nbsp;<\/p>\n<h2><span style=\"color: #003366;\">References and other related articles<\/span><\/h2>\n<ol>\n<li>\u00a0Ansible <a href=\"https:\/\/docs.ansible.com\/ansible\/latest\/modules\/copy_module.html\" target=\"_blank\" rel=\"noopener noreferrer\">Copy<\/a> module reference<\/li>\n<li>Ansible <a href=\"https:\/\/docs.ansible.com\/ansible\/latest\/modules\/fetch_module.html\">Fetch<\/a> module reference<\/li>\n<li>Ansible <a href=\"https:\/\/docs.ansible.com\/ansible\/latest\/modules\/synchronize_module.html\">Synchronize<\/a> module reference<\/li>\n<li>How to <a href=\"https:\/\/www.middlewareinventory.com\/blog\/ssh-key-based-authentication-using-ansible-ad-hoc-and-playbook\/\">Copy or Exchange SSH Key between multiple hosts<\/a> &#8211; Ansible<\/li>\n<li>How to exchange the IP and <a href=\"https:\/\/www.middlewareinventory.com\/blog\/ansible-update-etc-hosts-file-across-all-hosts\/\">update \/etc\/hosts file<\/a> in multiple hosts &#8211; Ansible<\/li>\n<\/ol>\n<p>&nbsp;<\/p>\n<p>Hope this article helps. If you like this article, please share it<\/p>\n<p>&nbsp;<\/p>\n<p>Thanks,<br \/>\nRumen Lishkov<\/p>\n<div id=\"postfollow\">\r\n<a href='https:\/\/ko-fi.com\/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='https:\/\/az743702.vo.msecnd.net\/cdn\/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' \/><\/a>\r\n<p>Follow us on<a href=\"http:\/\/www.facebook.com\/middlewareinventory\">Facebook<\/a> or<a href=\"http:\/\/www.twitter.com\/mwinventory\">Twitter<\/a>\r\n<\/br>\r\nFor more practical videos and tutorials. <a href=\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw?sub_confirmation=1\">Subscribe to our channel<\/a>\r\n<\/br>\r\nFollow me on Linkedin <a href=\"https:\/\/www.linkedin.com\/comm\/mynetwork\/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=saravakmwinventory\">My Profile<\/a>\r\n<\/br>\r\n<\/i>For any Consultation or to hire us <a href=\"mailto:rumenlishkoff@gmail.com\"> rumenlishkoff@gmail.com<\/a>\r\n<\/br>\r\nIf you like this article. Show your Support! <a href=\"https:\/\/ko-fi.com\/middlewareinventory\">Buy me a Coffee.<\/a>\r\n<\/br>\r\n<\/p>\r\n<p style=\"color: palevioletred !important;\">Signup for Exclusive \"Subscriber-only\" Content<\/p>\r\n\n\t\t<div class=\"emaillist\">\n\t\t\t<form action=\"#\" method=\"post\" class=\"es_subscription_form es_shortcode_form\" id=\"es_subscription_form_1670577811\" data-source=\"ig-es\">\n\t\t\t\t\t\t\t\t<div class=\"es-field-wrap\"><label>Name*<br \/><input type=\"text\" name=\"name\" class=\"ig_es_form_field_name\" placeholder=\"\" value=\"\" required=\"required\" \/><\/label><\/div><div class=\"es-field-wrap\"><label>Email*<br \/><input class=\"es_required_field es_txt_email ig_es_form_field_email\" type=\"email\" name=\"email\" value=\"\" placeholder=\"\" required=\"required\" \/><\/label><\/div><input type=\"hidden\" name=\"lists[]\" value=\"1\" \/><input type=\"hidden\" name=\"form_id\" value=\"3\" \/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page\" value=\"1667\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page_url\" value=\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"status\" value=\"Unconfirmed\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es-subscribe\" id=\"es-subscribe\" value=\"7aebfb1a9b\"\/>\n\t\t\t\t<label style=\"position:absolute;top:-99999px;left:-99999px;z-index:-99;\"><input type=\"email\" name=\"es_hp_email\" class=\"es_required_field\" tabindex=\"-1\" autocomplete=\"-1\" value=\"\"\/><\/label>\n\t\t\t\t\t\t\t\t<input type=\"submit\" name=\"submit\" class=\"es_subscription_form_submit es_submit_button es_textbox_button\" id=\"es_subscription_form_submit_1670577811\" value=\"Subscribe\"\/>\n\n\t\t\t\t\n\t\t\t\t<span class=\"es_spinner_image\" id=\"spinner-image\"><img src=\"https:\/\/www.middlewareinventory.com\/wp-content\/plugins\/email-subscribers\/lite\/public\/images\/spinner.gif\" alt=\"Loading\"\/><\/span>\n\n\t\t\t<\/form>\n\n\t\t\t<span class=\"es_subscription_message\" id=\"es_subscription_message_1670577811\"><\/span>\n\t\t<\/div>\n\n\t\t\r\n<\/div>\r\n<hr>\n","protected":false},"excerpt":{"rendered":"<p>How to copy files between remote servers in Ansible ?. is the purpose behind this article.\u00a0 Every article I went and read was giving me suggestions but nothing practical. I simply wanted to do make ansible rsync. I wanted to execute rsync between remote hosts and copy files between remote[&#8230;]<\/p>\n","protected":false},"author":1,"featured_media":1701,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[98],"tags":[130,133,132,131],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>How to Copy files between remote hosts in ansible | Devops Junction<\/title>\n<meta name=\"description\" content=\"How to copy files between remote servers, hosts, nodes in Ansible. ansible copy files between hosts. Examples with Ansible modules like fetch and synchronize is used. Ansible synchronize pull and Ansible Synchronize push methods explained with examples. Ansible rsync how to perform Ansible Rsync. Ansible RSYNC Examples\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"How to Copy files between remote hosts in ansible | Devops Junction\" \/>\n<meta property=\"og:description\" content=\"How to copy files between remote servers, hosts, nodes in Ansible. ansible copy files between hosts. Examples with Ansible modules like fetch and synchronize is used. Ansible synchronize pull and Ansible Synchronize push methods explained with examples. Ansible rsync how to perform Ansible Rsync. Ansible RSYNC Examples\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2018-08-29T09:15:27+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-06-19T06:03:42+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-2.34.52-PM.png\" \/>\n\t<meta property=\"og:image:width\" content=\"1002\" \/>\n\t<meta property=\"og:image:height\" content=\"664\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2018\/08\/Screen-Shot-2018-08-29-at-2.34.52-PM.png\",\"width\":1002,\"height\":664},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/\",\"name\":\"How to Copy files between remote hosts in ansible | Devops Junction\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/#primaryimage\"},\"datePublished\":\"2018-08-29T09:15:27+00:00\",\"dateModified\":\"2022-06-19T06:03:42+00:00\",\"description\":\"How to copy files between remote servers, hosts, nodes in Ansible. ansible copy files between hosts. Examples with Ansible modules like fetch and synchronize is used. Ansible synchronize pull and Ansible Synchronize push methods explained with examples. Ansible rsync how to perform Ansible Rsync. Ansible RSYNC Examples\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\"},\"headline\":\"How to Copy files between remote hosts in ansible\",\"datePublished\":\"2018-08-29T09:15:27+00:00\",\"dateModified\":\"2022-06-19T06:03:42+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/#webpage\"},\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/#primaryimage\"},\"keywords\":\"Ansible copy files between remote hosts,Ansible Synchronize and its methods,Ansible Synchronize module example,Copy files between remote nodes ansible\",\"articleSection\":\"Ansible\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/how-to-copy-files-between-remote-servers-ansible-fetch-sync\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\",\"name\":\"Rumen Lishkov\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g\",\"caption\":\"Rumen Lishkov\"}}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/1667"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=1667"}],"version-history":[{"count":50,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/1667\/revisions"}],"predecessor-version":[{"id":6969,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/1667\/revisions\/6969"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media\/1701"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=1667"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=1667"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=1667"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}