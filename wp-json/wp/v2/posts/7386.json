{"id":7386,"date":"2021-10-21T01:25:53","date_gmt":"2021-10-20T19:55:53","guid":{"rendered":"https:\/\/www.middlewareinventory.com\/?p=7386"},"modified":"2022-01-12T01:49:49","modified_gmt":"2022-01-11T20:19:49","slug":"find-and-replace-default-html-in-iis-windows-ansible","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/","title":{"rendered":"Find and Replace Default HTML in IIS Windows &#8211; Ansible"},"content":{"rendered":"<p>In this post we are going to see how to handle the <code>Default webpage<\/code> vulnerability in IIS with Ansible.<\/p>\n<p>The Default WebPage Vulnerability is flagged by Security Analysts and Pen testers cause it can reveal that the server is powered by IIS and it would let the hacker to try various other attempts<\/p>\n<p><img class=\"post-img alignnone\" src=\"https:\/\/port135.com\/wp-content\/uploads\/2020\/07\/iis-default-page.jpg\" alt=\"IIS default page\" width=\"988\" height=\"664\" \/><\/p>\n<p>So it is always advised to not keep the default page in any webserver you take. Let it be Apache\/IIS\/nginx<\/p>\n<p>Having the default page in the IIS web server also mean that server may be not be in use.<\/p>\n<p>So there are few ways to handle this vulnerability.<\/p>\n<ul>\n<li><strong>Disable the Default page<\/strong>\n<ul>\n<li>Steps to disable default page:\n<ol type=\"1\">\n<li>Open IIS Manager<\/li>\n<li>Click the server name<\/li>\n<li>Double click on Default Document<\/li>\n<li>On the right side, click \u201cDisable\u201d<\/li>\n<\/ol>\n<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<ul>\n<li><strong>Stop the server<\/strong> if it is not in use.<\/li>\n<li>Update or <strong>Replace your default HTML<\/strong> file<\/li>\n<\/ul>\n<p>We are going to see the third solution here to change the default HTML file with our content.<\/p>\n<p>By doing this. you can have your IIS web server running but the default page would no longer reveal that the server is IIS.<\/p>\n<blockquote><p>\u00a0Be informed that this playbook consider only the <code>Default web site<\/code> on the IIS. not other websites hosted. but you can tweak this playbook to suit your needs<\/p><\/blockquote>\n<h2>List of tasks in this playbook<\/h2>\n<p>Here is the ansible playbook that performs the following tasks<\/p>\n<ol>\n<li>Get the physical path of the default website ( it is not always c:\/inetpub )<\/li>\n<li>Check if that directory \/ physical path is present<\/li>\n<li>Get the list of files inside the document root\/physical path<\/li>\n<li>Get the default document configuration of your IIS default site. ( index.html, index.htm etc etc)<\/li>\n<li>Find out which default document is actually present on the physical path<\/li>\n<li>Hit the URL to validate the old page content ( the default iis page)<\/li>\n<li>using win_template copy the custom HTML file from local to remote windows server and replace the default HTML<\/li>\n<li>Hit the URL to revalidate that the default document is not returned<\/li>\n<\/ol>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<h2>Ansible playbook to replace a default HTML in IIS<\/h2>\n<p>we have already listed out the list of tasks this playbook is going to be doing.<\/p>\n<p>So we are not going to go any deeper to explain it. but if you have any questions please reach us at comment section<\/p>\n<p>with no further ado, here is the playbook.<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"generic\" data-enlighter-theme=\"bootstrap4\" data-enlighter-linenumbers=\"false\">---\r\n- name: Windows Tasks\r\n  hosts: win\r\n  tasks:\r\n    - name:  Get the Default website path\r\n      win_shell: |\r\n        Import-Module WebAdministration\r\n        (Get-Item 'iis:\\sites\\Default Web Site').physicalpath \r\n      register: shellout\r\n\r\n    - set_fact: \r\n        docroot: \"{{ shellout.stdout | trim | regex_replace('%SystemDrive%', ansible_env.SystemDrive) }}\"\r\n\r\n    - name: Check if directory present\r\n      win_stat:\r\n        path: \"{{docroot}}\"\r\n      register: file\r\n      \r\n    - name: Fail if the directory is not present \r\n      fail:\r\n        msg: \"{{docroot}} directory is not present - Stopping the execution\"\r\n      when: file.stat.exists == 'false'\r\n\r\n    - name:  Get the files inside the docroot\r\n      win_shell: |\r\n        Get-ChildItem {{docroot}} -File\r\n      register: listoffiles\r\n\r\n    - set_fact: \r\n        filenames: \"{{listoffiles.stdout_lines | trim }}\"\r\n\r\n    - name: Get the list of Default Documents configured on IIS Site\r\n      win_shell: |\r\n        Get-WebConfiguration -Filter \"system.webserver\/defaultdocument\/files\/*\" -PSPath \"IIS:\\sites\\Default Web Site\"|foreach {$_.value} \r\n      register: defaultdocs\r\n\r\n    - name: Trying to find out which default document is present on the Docroot\r\n      win_stat:\r\n        path: \"{{docroot}}\/{{item}}\"\r\n      register: defdoc\r\n      with_items: \"{{defaultdocs.stdout_lines}}\"\r\n\r\n    - name: Hitting the Local URL\r\n      win_uri:\r\n        return_content: true\r\n        url: http:\/\/localhost\r\n        method: GET\r\n      register: httpoutputbefore\r\n\r\n    - name: Before removing\/renaming the file site output\r\n      vars:\r\n        msg: |\r\n          &#8211; ---------------------------------------------\r\n          AFTER: HTML Response from http:\/\/localhost \r\n          &#8211; ---------------------------------------------\r\n          {{httpoutputbefore.content}}\r\n          &#8211; ---------------------------------------------\r\n      debug:\r\n        msg: \"{{ msg.split('\\n') }}\"\r\n\r\n    - name: Copy the file from local to the remote and replace the file \r\n      vars: \r\n        - filename: \"{{ defdoc.results | selectattr('stat.exists','==','true') | map(attribute='stat.filename') | first }}\"\r\n        # In oldversions of Ansible the JINJA SelectAttr method does not work properly in such case comment the previous line and uncomment next line\r\n        #- filename: \"{{ defdoc.results | json_query('[?stat.exists==`true`]' }}\"\r\n      win_template:\r\n        src: 'test.html'\r\n        dest: '{{docroot}}\/{{filename}}'\r\n        backup: yes\r\n\r\n    - name: Hitting the Local URL\r\n      win_uri:\r\n        return_content: true\r\n        url: http:\/\/localhost\r\n        method: GET\r\n      register: httpoutputafter\r\n      ignore_errors: True\r\n    \r\n    - name: After removing\/renaming the file site output\r\n      vars:\r\n        msg: |\r\n          &#8211; ---------------------------------------------\r\n          AFTER: HTML Response from http:\/\/localhost \r\n          &#8211; ---------------------------------------------\r\n          {{httpoutputafter.content}}\r\n          &#8211; ---------------------------------------------\r\n      debug:\r\n        msg: \"{{ msg.split('\\n') }}\"\r\n      when: httpoutputafter.content is defined\r\n\r\n<\/pre>\n<p>&nbsp;<\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<p>&nbsp;<\/p>\n<h2>Conclusion.<\/h2>\n<p>Besides the primary objective of replacing the default html file of the default website on IIS with Ansible.<\/p>\n<p>we also have covered few interesting ansible sub topics in this same playbook. take a look once again if you have missed it<\/p>\n<ul>\n<li>Windows <code>Win_Shell<\/code> module example<\/li>\n<li>How to validate if directory is present or not with <code>win_stat<\/code><\/li>\n<li>How to list a directory with <code>win_shell<\/code><\/li>\n<li>Use <code>win_uri<\/code> to access the web page<\/li>\n<li>How to Customize the ansible msg with formatting<\/li>\n<\/ul>\n<p>Hope this helps.<\/p>\n<p>For any Ansible, DevSecOps, Cloud related professional support and projects reach out to us at <a href=\"https:\/\/gritfy.com\">Gritfy<\/a><\/p>\n<a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\"><img class=\"post-img\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\" alt=\"gritfy\" width=\"1047\" height=\"415\" class=\"alignnone size-full wp-image-6623\" \/><\/a>\n<p>Cheers<br \/>\nRumen Lishkov<\/p>\n<div id=\"postfollow\">\r\n<a href='https:\/\/ko-fi.com\/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='https:\/\/az743702.vo.msecnd.net\/cdn\/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' \/><\/a>\r\n<p>Follow us on<a href=\"http:\/\/www.facebook.com\/middlewareinventory\">Facebook<\/a> or<a href=\"http:\/\/www.twitter.com\/mwinventory\">Twitter<\/a>\r\n<\/br>\r\nFor more practical videos and tutorials. <a href=\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw?sub_confirmation=1\">Subscribe to our channel<\/a>\r\n<\/br>\r\nFollow me on Linkedin <a href=\"https:\/\/www.linkedin.com\/comm\/mynetwork\/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=saravakmwinventory\">My Profile<\/a>\r\n<\/br>\r\n<\/i>For any Consultation or to hire us <a href=\"mailto:rumenlishkoff@gmail.com\"> rumenlishkoff@gmail.com<\/a>\r\n<\/br>\r\nIf you like this article. Show your Support! <a href=\"https:\/\/ko-fi.com\/middlewareinventory\">Buy me a Coffee.<\/a>\r\n<\/br>\r\n<\/p>\r\n<p style=\"color: palevioletred !important;\">Signup for Exclusive \"Subscriber-only\" Content<\/p>\r\n\n\t\t<div class=\"emaillist\">\n\t\t\t<form action=\"#\" method=\"post\" class=\"es_subscription_form es_shortcode_form\" id=\"es_subscription_form_1670578263\" data-source=\"ig-es\">\n\t\t\t\t\t\t\t\t<div class=\"es-field-wrap\"><label>Name*<br \/><input type=\"text\" name=\"name\" class=\"ig_es_form_field_name\" placeholder=\"\" value=\"\" required=\"required\" \/><\/label><\/div><div class=\"es-field-wrap\"><label>Email*<br \/><input class=\"es_required_field es_txt_email ig_es_form_field_email\" type=\"email\" name=\"email\" value=\"\" placeholder=\"\" required=\"required\" \/><\/label><\/div><input type=\"hidden\" name=\"lists[]\" value=\"1\" \/><input type=\"hidden\" name=\"form_id\" value=\"3\" \/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page\" value=\"7386\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page_url\" value=\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"status\" value=\"Unconfirmed\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es-subscribe\" id=\"es-subscribe\" value=\"7aebfb1a9b\"\/>\n\t\t\t\t<label style=\"position:absolute;top:-99999px;left:-99999px;z-index:-99;\"><input type=\"email\" name=\"es_hp_email\" class=\"es_required_field\" tabindex=\"-1\" autocomplete=\"-1\" value=\"\"\/><\/label>\n\t\t\t\t\t\t\t\t<input type=\"submit\" name=\"submit\" class=\"es_subscription_form_submit es_submit_button es_textbox_button\" id=\"es_subscription_form_submit_1670578263\" value=\"Subscribe\"\/>\n\n\t\t\t\t\n\t\t\t\t<span class=\"es_spinner_image\" id=\"spinner-image\"><img src=\"https:\/\/www.middlewareinventory.com\/wp-content\/plugins\/email-subscribers\/lite\/public\/images\/spinner.gif\" alt=\"Loading\"\/><\/span>\n\n\t\t\t<\/form>\n\n\t\t\t<span class=\"es_subscription_message\" id=\"es_subscription_message_1670578263\"><\/span>\n\t\t<\/div>\n\n\t\t\r\n<\/div>\r\n<hr>\n","protected":false},"excerpt":{"rendered":"<p>In this post we are going to see how to handle the Default webpage vulnerability in IIS with Ansible. The Default WebPage Vulnerability is flagged by Security Analysts and Pen testers cause it can reveal that the server is powered by IIS and it would let the hacker to try[&#8230;]<\/p>\n","protected":false},"author":1,"featured_media":7395,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[98],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Find and Replace Default HTML in IIS Windows - Ansible<\/title>\n<meta name=\"description\" content=\"Ansible Windows IIS replace default html or default document on IIS website. Ansible win_stat, win_template, win_file module examples. How to find and replace in windows with Ansible.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Find and Replace Default HTML in IIS Windows - Ansible\" \/>\n<meta property=\"og:description\" content=\"Ansible Windows IIS replace default html or default document on IIS website. Ansible win_stat, win_template, win_file module examples. How to find and replace in windows with Ansible.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2021-10-20T19:55:53+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-01-11T20:19:49+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/iis-default-page.jpeg\" \/>\n\t<meta property=\"og:image:width\" content=\"988\" \/>\n\t<meta property=\"og:image:height\" content=\"664\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/10\/iis-default-page.jpeg\",\"width\":988,\"height\":664,\"caption\":\"Ansible windows IIS\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/\",\"name\":\"Find and Replace Default HTML in IIS Windows - Ansible\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/#primaryimage\"},\"datePublished\":\"2021-10-20T19:55:53+00:00\",\"dateModified\":\"2022-01-11T20:19:49+00:00\",\"description\":\"Ansible Windows IIS replace default html or default document on IIS website. Ansible win_stat, win_template, win_file module examples. How to find and replace in windows with Ansible.\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\"},\"headline\":\"Find and Replace Default HTML in IIS Windows &#8211; Ansible\",\"datePublished\":\"2021-10-20T19:55:53+00:00\",\"dateModified\":\"2022-01-11T20:19:49+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/#webpage\"},\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/#primaryimage\"},\"articleSection\":\"Ansible\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/find-and-replace-default-html-in-iis-windows-ansible\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/050bf13e27b309d29d1bda45c4eb3147\",\"name\":\"Rumen Lishkov\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g\",\"caption\":\"Rumen Lishkov\"}}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/7386"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=7386"}],"version-history":[{"count":5,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/7386\/revisions"}],"predecessor-version":[{"id":7428,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/7386\/revisions\/7428"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media\/7395"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=7386"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=7386"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=7386"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}