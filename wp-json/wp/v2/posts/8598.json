{"id":8598,"date":"2022-06-15T01:22:06","date_gmt":"2022-06-14T19:52:06","guid":{"rendered":"https:\/\/www.middlewareinventory.com\/?p=8598"},"modified":"2022-06-15T01:22:06","modified_gmt":"2022-06-14T19:52:06","slug":"terraform-aks-example-creating-azure-k8s-cluster-devops-junction","status":"publish","type":"post","link":"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/","title":{"rendered":"Terraform AKS Example &#8211; Creating Azure K8s Cluster | Devops Junction"},"content":{"rendered":"<p>Kubernetes is a Container Orchestration tool given to the world by Google.<\/p>\n<p>It changed the way applications are deployed managed and scaled.<\/p>\n<p>In our blog, we have written various introductory articles on how to get started with Containers and Kubernetes<\/p>\n<p>If you are new to Containers. <a href=\"https:\/\/www.middlewareinventory.com\/blog\/what-is-container-and-containerization-a-basic-notes\/\">read this article before moving on<\/a><\/p>\n<p>You might have heard this phrase, <strong>With Great power comes great responsibility.<\/strong><\/p>\n<p>In K8s case, the great power it brings, it adds great responsibility to Engineers\/Developers in designing\/managing\/administrating areas.<\/p>\n<p>But it&#8217;s worth it.!<\/p>\n<p>So it&#8217;s not really easy to have a Self Managed Kubernetes cluster due to the underlying complexity.<\/p>\n<p>Most industry experts and organizations choose Managed Kubernetes for their Production and NonProd workloads like<\/p>\n<ul>\n<li>AKS &#8211; Azure Kubernetes Service<\/li>\n<li>EKS &#8211; Elastic Kubernetes Service<\/li>\n<li>GKE &#8211; Google Kubernetes Engine<\/li>\n<\/ul>\n<p>We have written various articles on <a href=\"https:\/\/www.middlewareinventory.com\/blog\/category\/kubernetes\/\">GKE and EKS.<\/a> read them to get more understanding.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks.jpg\"><img class=\"post-img alignnone wp-image-8632 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks.jpg\" alt=\"terraform aks\" width=\"1748\" height=\"1240\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks.jpg 1748w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks-300x213.jpg 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks-1024x726.jpg 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks-768x545.jpg 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks-1536x1090.jpg 1536w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks-90x65.jpg 90w\" sizes=\"(max-width: 1748px) 100vw, 1748px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<h2>Objective<\/h2>\n<p>In this article, we are going to talk about\u00a0 AKS. &#8211; Azure Kubernetes Service. How to set up\/get started with a new Azure Kubernetes Service cluster.<\/p>\n<p>Azure Kubernetes Service (AKS) is an Azure-managed Kubernetes service that provides additional features like improved security and fast delivery.<\/p>\n<p>However, creating AKS manually would involve some additional complexities of its own.<\/p>\n<p>Let us learn how to create an AKS cluster using <a href=\"https:\/\/www.middlewareinventory.com\/blog\/category\/terraform\/\">Terraform<\/a> and then deploy a sample application into the cluster.<\/p>\n<p>Now back to the objective.<\/p>\n<p>Let us start with the necessary tools and access needed to get this going.<\/p>\n<p>&nbsp;<\/p>\n<h2><span id=\"Configure_AWS_CLI\" class=\"ez-toc-section\">Configure<\/span>\u00a0the environment<\/h2>\n<p>Let&#8217;s first set up the environment by installing <strong>Azure CLI<\/strong> and<strong> Terraform<\/strong> into our local machine. You can skip ahead to the next section if you already have it set up.<\/p>\n<p>1. Install the <strong>Azure CLI<\/strong> using the documentation <a href=\"https:\/\/docs.microsoft.com\/en-us\/cli\/azure\/install-azure-cli\" target=\"_blank\" rel=\"noopener noreferrer\">here<\/a>.<\/p>\n<p>2. Connect the Azure CLI to your Azure account by running the following code and then filling in the required details:<\/p>\n<pre>az login<\/pre>\n<p>3. Set up <strong>Terraform<\/strong> in your local machine using the documentation <a href=\"https:\/\/www.terraform.io\/downloads\" target=\"_blank\" rel=\"noopener noreferrer\">here<\/a>.<\/p>\n<p>4. Download kubectl on your local machine using the documentation <a href=\"https:\/\/kubernetes.io\/docs\/tasks\/tools\/\" target=\"_blank\" rel=\"noopener noreferrer\">here<\/a>.<\/p>\n<p>&nbsp;<\/p>\n<h2>Granting <span id=\"Configure_AWS_CLI\" class=\"ez-toc-section\">permissions<\/span><\/h2>\n<p>Set up the privileges for accessing the Azure resources required for using Terraform by creating a <strong>service principal<\/strong> in your Azure account. The<strong> service principal<\/strong> in Azure helps to give required permissions to the users.<\/p>\n<p>To set up a service principal, run the following code in your terminal after you have set up Azure CLI :<\/p>\n<pre>az ad sp create-for-rbac &#8211; name &lt;service_principal_name&gt; &#8211; role Contributor &#8211; scopes \/subscriptions\/&lt;subscription_id&gt;<\/pre>\n<blockquote><p>Replace <strong>&lt;service_principal_name&gt; <\/strong>and <strong>&lt;subscription_id&gt; <\/strong>with appropriate values.<\/p><\/blockquote>\n<p>Note down the output of the above command as these details will come in handy later when we start making the Terraform script. I would recommend copying these values into your notepad.<\/p>\n<p>1. Once you have set up the service principal, go to <strong>Azure Active Directory<\/strong> and click on <strong>App registrations.<\/strong><\/p>\n<p>2. You will be able to see the service principal you just created. Click on it and note the<strong> Object ID<\/strong> as well from the service principal page for later use.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled.png\"><img class=\"post-img aligncenter wp-image-8607 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled.png\" alt=\"\" width=\"576\" height=\"567\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled.png 576w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled-300x295.png 300w\" sizes=\"(max-width: 576px) 100vw, 576px\" \/><\/a><\/p>\n<h2><\/h2>\n<p>&nbsp;<\/p>\n<h2>Create Azure <span id=\"Configure_AWS_CLI\" class=\"ez-toc-section\">resource group<\/span><\/h2>\n<p>For creating an AKS cluster, we need to have a <strong>resource group<\/strong> in Azure into which we will provide our cluster.<\/p>\n<p>Simply search <strong>resource group<\/strong> in the Azure portal and fill in the required details as given below and click <strong>Review+ create<\/strong> to create a resource group :<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-48.png\"><img class=\"post-img aligncenter wp-image-8599\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-48-e1654526768977.png\" alt=\"\" width=\"890\" height=\"474\" \/><\/a><\/p>\n<h2><\/h2>\n<p>&nbsp;<\/p>\n<h2>Create an Azure <span id=\"Configure_AWS_CLI\" class=\"ez-toc-section\">storage account (Optional)<\/span><\/h2>\n<blockquote><p>If you are looking to just play around AKS and use it for small scale deployments, you can skip this part.<\/p><\/blockquote>\n<p>Terraform tracks the state of your Terraform code locally via the <code>terraform.tfstate<\/code> the file is usually in a development environment. But for a practical production environment, we have to configure an <strong>Azure storage account<\/strong> so that azure can store the Terraform state file.<\/p>\n<p>To create an Azure storage account, search for <strong>Storage account<\/strong> in the Azure portal.<\/p>\n<p>1. Select the <strong>Resource group<\/strong> as the one you just created in the preceding part.<\/p>\n<p>2. Enter the <strong>Storage account name<\/strong> and choose the region.<\/p>\n<p>3. Select the <strong>Performance<\/strong> and <strong>Redundancy<\/strong> as per your requirement.<\/p>\n<p>4. Click <strong>Review + create.<\/strong><\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49.png\"><img class=\"post-img aligncenter wp-image-8600 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850.png\" alt=\"\" width=\"1207\" height=\"806\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850.png 1207w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850-300x200.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850-1024x684.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850-768x513.png 768w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850-840x560.png 840w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850-120x80.png 120w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850-360x240.png 360w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850-600x400.png 600w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Screenshot-49-e1654530273850-480x320.png 480w\" sizes=\"(max-width: 1207px) 100vw, 1207px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<h3><span id=\"Configure_AWS_CLI\" class=\"ez-toc-section\">Configure <\/span>Azure storage account<\/h3>\n<p>1. From the storage accounts, click on the storage account you just created.<\/p>\n<p>2. In the left menu, go to the <strong>Security + networking<\/strong> section and select <strong>Access keys<\/strong>.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/image_2022-06-06_220425896.png\"><img class=\"post-img aligncenter wp-image-8603 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/image_2022-06-06_220425896.png\" alt=\"\" width=\"1288\" height=\"833\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/image_2022-06-06_220425896.png 1288w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/image_2022-06-06_220425896-300x194.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/image_2022-06-06_220425896-1024x662.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/image_2022-06-06_220425896-768x497.png 768w\" sizes=\"(max-width: 1288px) 100vw, 1288px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<p>3. On the <strong>Access keys<\/strong> page, click <strong>Show keys<\/strong>\u00a0to display the key values.<\/p>\n<p>4. Copy the<strong> Key<\/strong> value of <strong>key1<\/strong> from there. We will use this value in the next step.<\/p>\n<p>Now we can authenticate the storage account to store the Terraform state file in a storage container using the following command:<\/p>\n<pre>az storage container create -n tfstate &#8211; account-name &lt;storage_account_name&gt; &#8211; account-key &lt;storage_account_key&gt;<\/pre>\n<blockquote><p>Replace <strong>&lt;storage_account_name&gt;<\/strong> with the Azure storage account name and<strong>&lt;storage_account_key&gt;<\/strong> with the <strong style=\"font-size: 12pt;\">Key<\/strong> value you copied from Access keys page<\/p><\/blockquote>\n<h2>Create <span id=\"Configure_AWS_CLI\" class=\"ez-toc-section\">SSH <\/span>Keys<\/h2>\n<p>Create and store SSH keys in your Azure portal using the documentation given <a href=\"https:\/\/docs.microsoft.com\/en-us\/azure\/virtual-machines\/ssh-keys-portal#generate-new-keys\" target=\"_blank\" rel=\"noopener noreferrer\">here<\/a>. This is a public key that we will be using while creating the Terraform script so that we can have SSH access to the node machines. Save this SSH public key as well for later use.<\/p>\n<p>&nbsp;<\/p>\n<h2><span id=\"Configure_AWS_CLI\" class=\"ez-toc-section\">Terraform<\/span>\u00a0Script<\/h2>\n<p>Great! Now you have met the requisites for setting up AKS with Terraform. It&#8217;s time to get started with the Terraform script.<\/p>\n<p>Terraform scripts are written in configuration blocks with an extension of\u00a0 <code>*.tf<\/code>. We will create a few <code>.tf<\/code> files in our workspace, each of which will serve a specific purpose. We will go into each of them one by one.<\/p>\n<p>&nbsp;<\/p>\n<h3>Link to <span id=\"Configure_AWS_CLI\" class=\"ez-toc-section\">GitHub<\/span><\/h3>\n<p>Get the full Terraform code from my GitHub repository <a href=\"https:\/\/github.com\/vishnus17\/Terraform-AKS\" target=\"_blank\" rel=\"noopener noreferrer\">here<\/a>.<\/p>\n<p>&nbsp;<\/p>\n<h3>providers. tf<\/h3>\n<p>The provider block helps Terraform identify Azure as the provider.<\/p>\n<p>We specify the <strong>backend &#8220;azurerm&#8221;<\/strong> so that azure can save our Terraform state file into the azure storage account.<\/p>\n<p>You don&#8217;t need to write the <strong>backend &#8220;azurerm&#8221;<\/strong> part if you are trying to set up a small-scale deployment ( nonproduction \/ development )<\/p>\n<p>Create a file named <code>providers.tf<\/code> and add the following code :<\/p>\n<div>\n<pre>terraform {\r\n  required_version = \"&gt;=0.12\"\r\n  required_providers {\r\n  \u00a0 azurerm = {\r\n  \u00a0 \u00a0 source \u00a0= \"hashicorp\/azurerm\"\r\n  \u00a0 \u00a0 version = \"~&gt;2.0\"\r\n  \u00a0 }\r\n  }\r\n  backend \"azurerm\" {\r\n  \u00a0 resource_group_name \u00a0= \"gritfy\"\r\n  \u00a0 storage_account_name = \"gritfystorage\"\r\n  \u00a0 container_name \u00a0 \u00a0 \u00a0 = \"tfstate\"\r\n  \u00a0 key \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0= \"codelab.microsoft.tfstate\"\r\n  }\r\n}\r\n\r\nprovider \"azurerm\" {\r\n  features {}\r\n}<\/pre>\n<\/div>\n<p>&nbsp;<\/p>\n<h3>variables.tf<\/h3>\n<p>Now, we make <code>variables.tf<\/code> file to pass the required variables to Terraform.<\/p>\n<div>\n<pre>variable \"resource_group_location\" {\r\n  default \u00a0 \u00a0 \u00a0 = \"South India\"\r\n  description \u00a0 = \"Location of the resource group.\"\r\n}\r\n\r\nvariable \"agent_count\" {\r\n  \u00a0 default = 3\r\n}\r\n\r\nvariable \"ssh_public_key\" {\r\n  \u00a0 default = \"Enter_ssh_public_key\"\r\n}\r\n\r\nvariable \"dns_prefix\" {\r\n  \u00a0 default = \"gritfyk8s\"\r\n}\r\n\r\nvariable cluster_name {\r\n  \u00a0 default = \"gritfyk8s\"\r\n}\r\n\r\nvariable resource_group_name {\r\n  \u00a0 default = \"gritfy\"\r\n}\r\n\r\nvariable locationk8s {\r\n  \u00a0 default = \"East Asia\"\r\n}\r\n\r\nvariable aks_service_principal_app_id {\r\n  \u00a0 default= \"Enter_aks_service_principal_app_id\"\r\n}\r\n\r\nvariable aks_service_principal_client_secret{\r\n  \u00a0 default = \"Enter_aks_service_principal_client_secret\"\r\n}\r\n\r\nvariable aks_service_principal_object_id {\r\n  \u00a0 default= \"Enter_aks_service_principal_object_id\"\r\n}<\/pre>\n<blockquote><p>Replace the values <strong>Enter_ssh_public_key<\/strong> , <strong>Enter_aks_service_principal_app_id<\/strong> , <strong>Enter_aks_service_principal_client_secret <\/strong>and <strong>Enter_aks_service_principal_object_id<\/strong> with the appropriate values which you copied during the configuration section.<\/p><\/blockquote>\n<p>&nbsp;<\/p>\n<h3>output.tf<\/h3>\n<p>Next, we create a file named <code>output.tf<\/code> which helps store the Terraform execution&#8217;s output.<\/p>\n<div>\n<pre>output \"client_key\" {\r\n  \u00a0 value = azurerm_kubernetes_cluster.k8s.kube_config.0.client_key\r\n}\r\n\r\noutput \"client_certificate\" {\r\n  \u00a0 value = azurerm_kubernetes_cluster.k8s.kube_config.0.client_certificate\r\n}\r\n\r\noutput \"cluster_ca_certificate\" {\r\n  \u00a0 value = azurerm_kubernetes_cluster.k8s.kube_config.0.cluster_ca_certificate\r\n}\r\n\r\noutput \"cluster_username\" {\r\n  \u00a0 value = azurerm_kubernetes_cluster.k8s.kube_config.0.username\r\n}\r\n\r\noutput \"cluster_password\" {\r\n  \u00a0 value = azurerm_kubernetes_cluster.k8s.kube_config.0.password\r\n}\r\n\r\noutput \"kube_config\" {\r\n  \u00a0 value = azurerm_kubernetes_cluster.k8s.kube_config_raw\r\n  \u00a0 sensitive = true\r\n}\r\n\r\noutput \"host\" {\r\n  \u00a0 value = azurerm_kubernetes_cluster.k8s.kube_config.0.host\r\n}<\/pre>\n<p>&nbsp;<\/p>\n<h3>main.tf<\/h3>\n<\/div>\n<\/div>\n<p>Finally, we create the <code>main.tf<\/code> file.<\/p>\n<p>This is our primary file where we define our requirements and what we are going to do with Terraform.<\/p>\n<p>Here, we are using the resource <code>azurerm_kubernetes_cluster<\/code> which is an azure managed Kubernetes service to create our cluster.<\/p>\n<div>\n<pre>resource \"azurerm_kubernetes_cluster\" \"k8s\" {\r\n  \u00a0 name \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0= var.cluster_name\r\n  \u00a0 location \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0= var.locationk8s\r\n  \u00a0 resource_group_name = var.resource_group_name\r\n  \u00a0 dns_prefix \u00a0 \u00a0 \u00a0 \u00a0 \u00a0= var.dns_prefix\r\n\r\n  \u00a0 linux_profile {\r\n  \u00a0 \u00a0 \u00a0 admin_username = \"ubuntu\"\r\n\r\n  \u00a0 \u00a0 \u00a0 ssh_key {\r\n  \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 key_data = var.ssh_public_key\r\n  \u00a0 \u00a0 \u00a0 }\r\n\u00a0 \u00a0 }\r\n\r\n  \u00a0 default_node_pool {\r\n  \u00a0 \u00a0 \u00a0 name \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0= \"default\"\r\n  \u00a0 \u00a0 \u00a0 node_count \u00a0 \u00a0 \u00a0= var.agent_count\r\n  \u00a0 \u00a0 \u00a0 vm_size \u00a0 \u00a0 \u00a0 \u00a0 = \"Standard_B2s\"\r\n  \u00a0 \u00a0 \u00a0 os_disk_size_gb = 30\r\n\u00a0 \u00a0 }\r\n\r\n  \u00a0 service_principal {\r\n  \u00a0 \u00a0 \u00a0 client_id \u00a0 \u00a0 = var.aks_service_principal_app_id\r\n  \u00a0 \u00a0 \u00a0 client_secret = var.aks_service_principal_client_secret\r\n\u00a0 \u00a0 }\r\n\r\n  \u00a0 tags = {\r\n  \u00a0 \u00a0 \u00a0 Environment = \"Development\"\r\n  \u00a0 }\r\n}<\/pre>\n<\/div>\n<blockquote><p>Choose the vm_size according to the availability of the VMs using Quotas from Azure portal. You can use <a href=\"https:\/\/portal.azure.com\/#view\/Microsoft_Azure_Capacity\/QuotaMenuBlade\/~\/myQuotas\" target=\"_blank\" rel=\"noopener noreferrer\">this link<\/a> to check the Quotas. Sometimes the quota could be exhausted depending on the availability in the region.<\/p><\/blockquote>\n<h2><\/h2>\n<h2>Running the Terraform script<\/h2>\n<p>Good job! We have made the script ready. Let&#8217;s initialize the terraform script by running the following command :<\/p>\n<div>\n<pre>terraform init<\/pre>\n<p>Your Terraform would be successfully initiated now. Now, we run the following terraform command to plan it. Terraform plan is like a dry run and it shows the changes that would be made upon running the terraform script.<\/p>\n<pre>terraform plan -out tfplan.out<\/pre>\n<\/div>\n<p>Here, we are saving the plan as an output file <code>tfplan.out<\/code>. This is recommended to make sure that no unintended changes are being made to the infrastructure.<\/p>\n<p>Next, we will use the <code>tfplan.out<\/code> file to confirm and apply the changes in the plan. We can do this by running the following command :<\/p>\n<div>\n<pre>terraform apply tfplan.out<\/pre>\n<\/div>\n<p>Terraform will now start creating the resources. It will be completed after a few minutes and you will be able to see the AKS cluster you created in the Azure portal.<\/p>\n<p>&nbsp;<\/p>\n<h2>Deploying an application to AKS<\/h2>\n<p>Great! Now we have a running AKS cluster. Let&#8217;s go ahead and deploy an application to our cluster.<\/p>\n<p>I have an existing docker image which I will be using for this purpose. Refer to the article on how to create a docker image <a href=\"https:\/\/www.middlewareinventory.com\/blog\/docker-tomcat-example-dockerfile-sample\/\" target=\"_blank\" rel=\"noopener noreferrer\">here<\/a>.<\/p>\n<p>We will be using this docker image to create a deployment to AKS.<\/p>\n<p>To start using your Kubernetes service, search for Kubernetes service in the Azure portal and click on the one you just created. Then, click on <strong>Connect<\/strong>.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled-1-e1654710482624.png\"><img class=\"post-img aligncenter wp-image-8624 size-full\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled-1-e1654711860390.png\" alt=\"\" width=\"1331\" height=\"399\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled-1-e1654711860390.png 1331w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled-1-e1654711860390-300x90.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled-1-e1654711860390-1024x307.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/Untitled-1-e1654711860390-768x230.png 768w\" sizes=\"(max-width: 1331px) 100vw, 1331px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<p>Now, run the two commands you see under <strong>Connect to gritfyk8s<\/strong> in your terminal. This allows kubectl to connect to AKS so that we can access the cluster.<\/p>\n<p><a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/tempsnip.png\"><img class=\"post-img wp-image-8625 size-full alignnone\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/tempsnip.png\" alt=\"\" width=\"1450\" height=\"437\" srcset=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/tempsnip.png 1450w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/tempsnip-300x90.png 300w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/tempsnip-1024x309.png 1024w, https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/tempsnip-768x231.png 768w\" sizes=\"(max-width: 1450px) 100vw, 1450px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<p>Great! Now you have established a connection from kubectl on your local machine to AKS.<\/p>\n<p>Refer to the article below on how to deploy an application to Kubernetes.<\/p>\n<p>Though the article is created for GKE, You can follow the same <strong>Kubectl<\/strong> commands to deploy to the AKS cluster as well.<\/p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"lglGMh3ZOl\"><p><a href=\"https:\/\/www.middlewareinventory.com\/blog\/deploy-tomcat-kubernetes\/\">How to Deploy Tomcat on Kubernetes Step by Step<\/a><\/p><\/blockquote>\n<p><iframe class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" title=\"&#8220;How to Deploy Tomcat on Kubernetes Step by Step&#8221; &#8212; Middleware Inventory\" src=\"https:\/\/www.middlewareinventory.com\/blog\/deploy-tomcat-kubernetes\/embed\/#?secret=lglGMh3ZOl\" data-secret=\"lglGMh3ZOl\" width=\"600\" height=\"338\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"><\/iframe><\/p>\n<script async src=\"https:\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js\"><\/script>\r\n<ins class=\"adsbygoogle\"\r\n     style=\"display:block; text-align:center;\"\r\n     data-ad-layout=\"in-article\"\r\n     data-ad-format=\"fluid\"\r\n     data-ad-client=\"ca-pub-3398911159151128\"\r\n     data-ad-slot=\"1946393371\"><\/ins>\r\n<script>\r\n     (adsbygoogle = window.adsbygoogle || []).push({});\r\n<\/script>\n<h2>Conclusion<\/h2>\n<p>In this article, we configured the environment to make a Terraform AKS cluster, provisioned an AKS cluster using Terraform, and then deployed an application to it.<\/p>\n<p>If you have any product and Cloud \/ DevOps requirements, Please do contact us for free consulting at <a href=\"mailto:rumenlishkoff@gmail.com\">rumenlishkoff@gmail.com<\/a><\/p>\n<a href=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\"><img class=\"post-img\" src=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2021\/09\/DaaS.svg\" alt=\"gritfy\" width=\"1047\" height=\"415\" class=\"alignnone size-full wp-image-6623\" \/><\/a>\n<p>&nbsp;<\/p>\n<p>Co Authored by<br \/>\nVishnu &amp; Sarav<\/p>\n<div id=\"postfollow\">\r\n<a href='https:\/\/ko-fi.com\/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='https:\/\/az743702.vo.msecnd.net\/cdn\/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' \/><\/a>\r\n<p>Follow us on<a href=\"http:\/\/www.facebook.com\/middlewareinventory\">Facebook<\/a> or<a href=\"http:\/\/www.twitter.com\/mwinventory\">Twitter<\/a>\r\n<\/br>\r\nFor more practical videos and tutorials. <a href=\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw?sub_confirmation=1\">Subscribe to our channel<\/a>\r\n<\/br>\r\nFollow me on Linkedin <a href=\"https:\/\/www.linkedin.com\/comm\/mynetwork\/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=saravakmwinventory\">My Profile<\/a>\r\n<\/br>\r\n<\/i>For any Consultation or to hire us <a href=\"mailto:rumenlishkoff@gmail.com\"> rumenlishkoff@gmail.com<\/a>\r\n<\/br>\r\nIf you like this article. Show your Support! <a href=\"https:\/\/ko-fi.com\/middlewareinventory\">Buy me a Coffee.<\/a>\r\n<\/br>\r\n<\/p>\r\n<p style=\"color: palevioletred !important;\">Signup for Exclusive \"Subscriber-only\" Content<\/p>\r\n\n\t\t<div class=\"emaillist\">\n\t\t\t<form action=\"#\" method=\"post\" class=\"es_subscription_form es_shortcode_form\" id=\"es_subscription_form_1670577650\" data-source=\"ig-es\">\n\t\t\t\t\t\t\t\t<div class=\"es-field-wrap\"><label>Name*<br \/><input type=\"text\" name=\"name\" class=\"ig_es_form_field_name\" placeholder=\"\" value=\"\" required=\"required\" \/><\/label><\/div><div class=\"es-field-wrap\"><label>Email*<br \/><input class=\"es_required_field es_txt_email ig_es_form_field_email\" type=\"email\" name=\"email\" value=\"\" placeholder=\"\" required=\"required\" \/><\/label><\/div><input type=\"hidden\" name=\"lists[]\" value=\"1\" \/><input type=\"hidden\" name=\"form_id\" value=\"3\" \/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page\" value=\"8598\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es_email_page_url\" value=\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"status\" value=\"Unconfirmed\"\/>\n\t\t\t\t<input type=\"hidden\" name=\"es-subscribe\" id=\"es-subscribe\" value=\"7aebfb1a9b\"\/>\n\t\t\t\t<label style=\"position:absolute;top:-99999px;left:-99999px;z-index:-99;\"><input type=\"email\" name=\"es_hp_email\" class=\"es_required_field\" tabindex=\"-1\" autocomplete=\"-1\" value=\"\"\/><\/label>\n\t\t\t\t\t\t\t\t<input type=\"submit\" name=\"submit\" class=\"es_subscription_form_submit es_submit_button es_textbox_button\" id=\"es_subscription_form_submit_1670577650\" value=\"Subscribe\"\/>\n\n\t\t\t\t\n\t\t\t\t<span class=\"es_spinner_image\" id=\"spinner-image\"><img src=\"https:\/\/www.middlewareinventory.com\/wp-content\/plugins\/email-subscribers\/lite\/public\/images\/spinner.gif\" alt=\"Loading\"\/><\/span>\n\n\t\t\t<\/form>\n\n\t\t\t<span class=\"es_subscription_message\" id=\"es_subscription_message_1670577650\"><\/span>\n\t\t<\/div>\n\n\t\t\r\n<\/div>\r\n<hr>\n","protected":false},"excerpt":{"rendered":"<p>Kubernetes is a Container Orchestration tool given to the world by Google. It changed the way applications are deployed managed and scaled. In our blog, we have written various introductory articles on how to get started with Containers and Kubernetes If you are new to Containers. read this article before[&#8230;]<\/p>\n","protected":false},"author":272,"featured_media":8632,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"_et_pb_use_builder":"","_et_pb_old_content":"","_et_gb_content_width":""},"categories":[452,151],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Terraform AKS Example - Creating Azure K8s Cluster | Devops Junction<\/title>\n<meta name=\"description\" content=\"Terraform AKS example. Creating Azure Kubernetes Cluster with Terraform. Deploying Application to AKS. Terraform azurerm_kubernetes_cluster example.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Terraform AKS Example - Creating Azure K8s Cluster | Devops Junction\" \/>\n<meta property=\"og:description\" content=\"Terraform AKS example. Creating Azure Kubernetes Cluster with Terraform. Deploying Application to AKS. Terraform azurerm_kubernetes_cluster example.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/\" \/>\n<meta property=\"og:site_name\" content=\"Middleware Inventory\" \/>\n<meta property=\"article:publisher\" content=\"http:\/\/www.facebook.com\/devopsjunc\" \/>\n<meta property=\"article:published_time\" content=\"2022-06-14T19:52:06+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks.jpg\" \/>\n\t<meta property=\"og:image:width\" content=\"1748\" \/>\n\t<meta property=\"og:image:height\" content=\"1240\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@mwinventory\" \/>\n<meta name=\"twitter:site\" content=\"@mwinventory\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\",\"name\":\"Middleware Inventory\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"sameAs\":[\"http:\/\/www.facebook.com\/devopsjunc\",\"https:\/\/www.youtube.com\/channel\/UCRuqBFM6ioWwviNJkgOjeWw\",\"https:\/\/twitter.com\/mwinventory\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2020\/09\/Screenshot-2020-09-18-at-3.49.40-AM.jpg\",\"width\":300,\"height\":107,\"caption\":\"Middleware Inventory\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\",\"url\":\"https:\/\/www.middlewareinventory.com\/\",\"name\":\"Devops Junction\",\"description\":\"An inventory of [i]nformation, Middleware and much more.\",\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/www.middlewareinventory.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/www.middlewareinventory.com\/wp-content\/uploads\/2022\/06\/terraform-aks.jpg\",\"width\":1748,\"height\":1240,\"caption\":\"terraform aks\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/#webpage\",\"url\":\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/\",\"name\":\"Terraform AKS Example - Creating Azure K8s Cluster | Devops Junction\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/#primaryimage\"},\"datePublished\":\"2022-06-14T19:52:06+00:00\",\"dateModified\":\"2022-06-14T19:52:06+00:00\",\"description\":\"Terraform AKS example. Creating Azure Kubernetes Cluster with Terraform. Deploying Application to AKS. Terraform azurerm_kubernetes_cluster example.\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/\"]}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/#webpage\"},\"author\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/241b2551eabd7453b914be32744fe6b8\"},\"headline\":\"Terraform AKS Example &#8211; Creating Azure K8s Cluster | Devops Junction\",\"datePublished\":\"2022-06-14T19:52:06+00:00\",\"dateModified\":\"2022-06-14T19:52:06+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/#webpage\"},\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/#organization\"},\"image\":{\"@id\":\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/#primaryimage\"},\"articleSection\":\"Azure,Kubernetes\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/www.middlewareinventory.com\/blog\/terraform-aks-example-creating-azure-k8s-cluster-devops-junction\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#\/schema\/person\/241b2551eabd7453b914be32744fe6b8\",\"name\":\"Vishnu S\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/www.middlewareinventory.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/02fe00895d488470a7b6e38963ba8d36?s=96&d=mm&r=g\",\"caption\":\"Vishnu S\"},\"sameAs\":[\"https:\/\/www.linkedin.com\/in\/vishnu-s-763644196\/\"]}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/8598"}],"collection":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/users\/272"}],"replies":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/comments?post=8598"}],"version-history":[{"count":5,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/8598\/revisions"}],"predecessor-version":[{"id":8638,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/posts\/8598\/revisions\/8638"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media\/8632"}],"wp:attachment":[{"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/media?parent=8598"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/categories?post=8598"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.middlewareinventory.com\/wp-json\/wp\/v2\/tags?post=8598"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}