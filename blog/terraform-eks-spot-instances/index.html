<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">


<title>Creating EKS Cluster with SPOT instances - Terraform | Devops Junction</title>
<meta name="description" content="How to create EKS Cluster with SPOT instances using Terraform. Terraform EKS SPOT instances example code. How to create EKS Cluster with SPOT instances and labels." />
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<link rel="canonical" href="index.html" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Creating EKS Cluster with SPOT instances - Terraform | Devops Junction" />
<meta property="og:description" content="How to create EKS Cluster with SPOT instances using Terraform. Terraform EKS SPOT instances example code. How to create EKS Cluster with SPOT instances and labels." />
<meta property="og:url" content="https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="article:publisher" content="https://www.facebook.com/rumenlishkov" />
<meta property="article:published_time" content="2022-04-03T19:48:11+00:00" />
<meta property="article:modified_time" content="2022-04-03T19:55:14+00:00" />
<meta property="og:image" content="../../wp-content/uploads/2022/04/Terraform-eks-spot.png" />
<meta property="og:image:width" content="1748" />
<meta property="og:image:height" content="1240" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@mwinventory" />
<meta name="twitter:site" content="@mwinventory" />
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://airdata.gitlab.io/blog/#organization","name":"Middleware Inventory","url":"https://www.middlewareinventory.com/","sameAs":["https://www.facebook.com/rumenlishkov","https://www.youtube.com/channel/UCRuqBFM6ioWwviNJkgOjeWw","https://twitter.com/mwinventory"],"logo":{"@type":"ImageObject","@id":"https://airdata.gitlab.io/blog/#logo","inLanguage":"en-US","url":"https://airdata.gitlab.io/blog/wp-content/uploads/2020/09/Screenshot-2020-09-18-at-3.49.40-AM.jpg","width":300,"height":107,"caption":"Middleware Inventory"},"image":{"@id":"https://airdata.gitlab.io/blog/#logo"}},{"@type":"WebSite","@id":"https://airdata.gitlab.io/blog/#website","url":"https://www.middlewareinventory.com/","name":"Devops Junction","description":"An inventory of [i]nformation, Middleware and much more.","publisher":{"@id":"https://airdata.gitlab.io/blog/#organization"},"potentialAction":[{"@type":"SearchAction","target":"https://www.middlewareinventory.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/#primaryimage","inLanguage":"en-US","url":"../../wp-content/uploads/2022/04/Terraform-eks-spot.png","width":1748,"height":1240,"caption":"Terraform eks spot instance"},{"@type":"WebPage","@id":"https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/#webpage","url":"https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/","name":"Creating EKS Cluster with SPOT instances - Terraform | Devops Junction","isPartOf":{"@id":"https://airdata.gitlab.io/blog/#website"},"primaryImageOfPage":{"@id":"https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/#primaryimage"},"datePublished":"2022-04-03T19:48:11+00:00","dateModified":"2022-04-03T19:55:14+00:00","description":"How to create EKS Cluster with SPOT instances using Terraform. Terraform EKS SPOT instances example code. How to create EKS Cluster with SPOT instances and labels.","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/"]}]},{"@type":"Article","@id":"https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/#article","isPartOf":{"@id":"https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/#webpage"},"author":{"@id":"https://airdata.gitlab.io/blog/#/schema/person/050bf13e27b309d29d1bda45c4eb3147"},"headline":"Creating EKS Cluster with SPOT instances &#8211; Terraform | Devops Junction","datePublished":"2022-04-03T19:48:11+00:00","dateModified":"2022-04-03T19:55:14+00:00","mainEntityOfPage":{"@id":"https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/#webpage"},"commentCount":0,"publisher":{"@id":"https://airdata.gitlab.io/blog/#organization"},"image":{"@id":"https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/#primaryimage"},"articleSection":"Terraform","inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/#respond"]}]},{"@type":"Person","@id":"https://airdata.gitlab.io/blog/#/schema/person/050bf13e27b309d29d1bda45c4eb3147","name":"Rumen Lishkov","image":{"@type":"ImageObject","@id":"https://airdata.gitlab.io/blog/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g","caption":"Rumen Lishkov"}}]}</script>

<link rel='dns-prefetch' href='https://js.stripe.com' />
<link rel='dns-prefetch' href='https://fonts.googleapis.com' />
<link rel='dns-prefetch' href='https://s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Feed" href="../../feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Comments Feed" href="../../comments/feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Creating EKS Cluster with SPOT instances &#8211; Terraform | Devops Junction Comments Feed" href="feed/index.rss" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GMY2GVPFFX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GMY2GVPFFX');
</script>

<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.middlewareinventory.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.5.6"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/404f7.css" media="all" />
<style id='ez-toc-inline-css' type='text/css'>div#ez-toc-container p.ez-toc-title {font-size: 120%;}div#ez-toc-container p.ez-toc-title {font-weight: 500;}div#ez-toc-container ul li {font-size: 95%;}div#ez-toc-container {width: 100%;}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/f854f.css" media="all" />
<link rel='stylesheet' id='poseidon-default-fonts-css' href='https://fonts.googleapis.com/css?family=Ubuntu%3A400%2C400italic%2C700%2C700italic%7CRaleway%3A400%2C700&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel="stylesheet" href="../../wp-content/cache/minify/88e5e.css" media="all" />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/www.middlewareinventory.com","hash_tracking":"false"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1058f.js"></script>
<script type='text/javascript' id='cookie-notice-front-js-extra'>
/* <![CDATA[ */
var cnArgs = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","hideEffect":"fade","onScroll":"no","onScrollOffset":"100","cookieName":"cookie_notice_accepted","cookieValue":"true","cookieTime":"2592000","cookiePath":"\/","cookieDomain":"","redirection":"","cache":"1","refuse":"yes","revoke_cookies":"0","revoke_cookies_opt":"automatic","secure":"1"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/545b0.js"></script>
<script type='text/javascript' id='email-subscribers-js-extra'>
/* <![CDATA[ */
var es_data = {"messages":{"es_empty_email_notice":"Please enter email address","es_rate_limit_notice":"You need to wait for sometime before subscribing again","es_single_optin_success_message":"Successfully Subscribed.","es_email_exists_notice":"Email Address already exists!","es_unexpected_error_notice":"Oops.. Unexpected error occurred.","es_invalid_email_notice":"Invalid email address","es_try_later_notice":"Please try after some time"},"es_ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1de0a.js"></script>
<script type='text/javascript' id='ssb-front-js-js-extra'>
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"9fe2b70daf"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/268e7.js"></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://airdata.gitlab.io/blog/wp-content/themes/poseidon/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<script type='text/javascript' id='poseidon-post-slider-js-extra'>
/* <![CDATA[ */
var poseidon_slider_params = {"animation":"slide","speed":"7000"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/51af3.js"></script>
<script type='text/javascript' id='eio-lazy-load-js-extra'>
/* <![CDATA[ */
var eio_lazy_vars = {"exactdn_domain":"","skip_autoscale":"0"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/28f5b.js"></script>
<link rel="https://api.w.org/" href="../../wp-json/index.json" /><link rel="alternate" type="application/json" href="../../wp-json/wp/v2/posts/8276.json" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php-rsd.xml" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.middlewareinventory.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 5.5.6" />
<link rel='shortlink' href='index.html' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-terraform-eks-spot-instances-.json" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-terraform-eks-spot-instances-&amp;format=xml.xml" />
<link href='https://fonts.googleapis.com/css?family=Strait:100,200,300,400,500,600,700,800,900&amp;subset=arabic,vietnamese,hebrew,thai,bengali,latin,latin-ext,cyrillic,cyrillic-ext,greek' rel='stylesheet' type='text/css'><style>a.idcore-button,a.idcore-button:visited{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:hover,a.idcore-button:focus{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:active{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}</style><script>var idcore_ajax_url = "https://www.middlewareinventory.com/wp-admin/admin-ajax.php";</script> <style media="screen">/*inline margin*/
	
	
	
	
	
	
			 /*margin-digbar*/

	
	
	
	
	   div[class*="simplesocialbuttons-float"].simplesocialbuttons.simplesocial-round-icon button{
	 margin: ;
   }
	
	
	
</style>

<meta property="og:title" content="Creating EKS Cluster with SPOT instances &#8211; Terraform | Devops Junction - Middleware Inventory" />
<meta property="og:description" content="In this article, we are going to see how to create an EKS Cluster with SPOT and OnDemand instances using Terraform.

If you have prior experience with AWS, you might know what is SPOT instances and ondemand instances are.  Let us start with a quick introduction towards SPOT instances.



Quick Introduction to AWS SPOT instances
AWS Provides the unused/unoccupied EC2 instances for up" />
<meta property="og:url" content="https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="og:image" content="../../wp-content/uploads/2022/04/Terraform-eks-spot.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="In this article, we are going to see how to create an EKS Cluster with SPOT and OnDemand instances using Terraform.

If you have prior experience with AWS, you might know what is SPOT instances and ondemand instances are.  Let us start with a quick introduction towards SPOT instances.



Quick Introduction to AWS SPOT instances
AWS Provides the unused/unoccupied EC2 instances for up" />
<meta name="twitter:title" content="Creating EKS Cluster with SPOT instances &#8211; Terraform | Devops Junction - Middleware Inventory" />
<meta property="twitter:image" content="../../wp-content/uploads/2022/04/Terraform-eks-spot.png" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
<noscript><style>.lazyload[data-src]{display:none !important;}</style></noscript><style type="text/css" id="sns_global_styles">/* for mobile */
@media screen and (max-width: 480px) {
    #text-23 {
        display:none !important;
    }
	p,li
    {
      font-size: 20px !important;
      color: #333 !important;
      line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li a
    {
    	font-size: 20px !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  
  #afc_sidebar_4348 
{
  height: 8vh; 
  max-height: 8vh; 
  background-color: transparent;
}
}

/* for Desktop */
@media screen and (min-width: 500px) {
#afc_sidebar_4348 
{
  height: 10vh; 
  max-height: 10vh; 
  background-color: transparent;
}
  #text-23 {
        display:none !important;
    }
	p,li
    {
        font-size: 20px !important;
        color: #333 !important;
        line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  

}

.es_lablebox {
    padding-bottom: 3px;
    color: steelblue !important;
    font-weight: bold !important;
}
.widget-title span {
    line-height: 2.2;
    color: steelblue !important;
}
.sidey {
	padding: 0;
}
.sumome-contactform 
{
  display: none;
}
code { 
    font-family: courier;
    font-size: 18px;
    padding: 2px;
    background-color: #f1f1f1;
    /*box-shadow: 0 2px 4px 0 rgba(0,0,0,0.16),0 2px 10px 0 rgba(0,0,0,0.12)!important;*/
    
}

.syntaxhighlighter {
    font-size: 14px !important;
}

pre {
 font-family: Menlo, Monaco, Consolas, "Courier New", monospace !important;
}

.black-red-border
{
    border-left: 3px solid;
    background-color: black;
    color: ghostwhite;
    border-left-color: red;
} 
}

#wpdevar_comment_1 span
{
  font-family:  "Open Sans", Helvetica, Arial, sans-serif !important;
  font-size: 20px !important;
  color: #1495b5 !important;
}

#wpdevar_comment_1 
{
  margin-top: 50px;
  margin-bottom: 30px;
}

summary
{
 color: steelblue; 
}

blockquote
{
  border-left-color: #cc0f77 !important;
  border-left-width: 4px !important;
  border-left-style: solid !important;
  background-color: #f5f5f5 !important;
}

.rp4wp-related-post-image{ width: auto !important; }

.main-navigation-menu
{
  float: none !important;
}

.primary-navigation
{
  float: none !important
}

body,html{
  /* font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

.page-title, .entry-title, .site-title, .main-navigation-menu a, .widget-title
{
  /*font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

#postfollow {
  background: whitesmoke;
  padding-top: 5%;
  padding-bottom: 5%;
  padding-left: 2%;
}
div#ez-toc-container p.ez-toc-title {
    font-weight: bold;
    font-size: 24px !important;
}
div#ez-toc-container {
    margin-bottom: 15%;
}

</style><link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-180x180.png" />
<meta name="msapplication-TileImage" content="https://airdata.gitlab.io/blog/wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-270x270.png" />
<style type="text/css">article h3
{
    background-color: whitesmoke;
    color: black;
    padding-left: 1%;
    border-left: 10px solid black;
    font-weight: 400;
    font-size: 22px;
}
#precode
{
  background-color: transparent !important;
  color: #00193a !important;
  font-size: 16px;
}
.post-img
{
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  border: 1px solid lightgray;
}
pre
{
  display: block; 
  overflow-x: auto; 
  padding-left: 2em;
  padding-top: 3em;
  padding-bottom: 3em;
  background: #eaeef3 none repeat scroll 0% 0%; 
  color: #00193a;
}
li {
    padding: 2px;
    margin-left: 2%;
}
code
{
  color: black;
}
blockquote {
    padding: 2%;
    background-color: none !important;
}
div.enlighter{
  font-size: 1.2em;  
}
.enlighter-default {
    font-family: Menlo, Monaco, Consolas, "Courier New", monospace !important;
}
</style>
<style type="text/css" id="wp-custom-css">.site-title
{
   font-size: 24px !important;
}		</style>
</head>
<body class="post-template-default single single-post postid-8276 single-format-standard wp-custom-logo cookies-set cookies-accepted elementor-default">
<div id="page" class="hfeed site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<div id="header-top" class="header-bar-wrap"></div>
<header id="masthead" class="site-header clearfix" role="banner">
<div class="header-main container clearfix">
<div id="logo" class="site-branding clearfix">
<a href="../../index.html" class="custom-logo-link" rel="home"><img width="160" height="120" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 107'%3E%3C/svg%3E" class="custom-logo lazyload" alt="Middleware Inventory" data-src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" loading="lazy" /><noscript><img width="160" height="120" src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" class="custom-logo" alt="Middleware Inventory" data-eio="l" /></noscript></a>
<p class="site-title"></p>
</div>
<nav id="main-navigation" class="primary-navigation navigation clearfix" role="navigation">
<ul id="menu-primary-menu" class="main-navigation-menu"><li id="menu-item-172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-172"><a href="https://airdata.github.io/">About Me</a></li>
<li id="menu-item-3206" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-3206"><a href="../category/middleware/index.html">Middleware</a>
<ul class="sub-menu">
<li id="menu-item-1518" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1518"><a href="../category/weblogic/index.html">weblogic</a></li>
<li id="menu-item-3207" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3207"><a href="../category/was/index.html">WAS</a></li>
<li id="menu-item-3208" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3208"><a href="../category/websphere/index.html">Websphere</a></li>
<li id="menu-item-3209" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3209"><a href="../category/wlst/index.html">wlst</a></li>
<li id="menu-item-3210" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3210"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a></li>
<li id="menu-item-3211" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3211"><a href="../category/jms/index.html">JMS</a></li>
<li id="menu-item-3212" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3212"><a href="../category/activemq/index.html">ActiveMQ</a></li>
<li id="menu-item-3213" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3213"><a href="../category/troubleshooting/index.html">Troubleshooting</a></li>
<li id="menu-item-3214" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3214"><a href="../category/apache/index.html">Apache</a></li>
<li id="menu-item-3215" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3215"><a href="../category/best-practice/index.html">Best Practice</a></li>
<li id="menu-item-3222" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3222"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a></li>
</ul>
</li>
<li id="menu-item-3157" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3157"><a href="../../devops-junction/index.html">Devops</a>
<ul class="sub-menu">
<li id="menu-item-1513" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1513"><a href="../category/ansible/index.html">Ansible</a></li>
<li id="menu-item-3216" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3216"><a href="../category/aws/index.html">AWS</a></li>
<li id="menu-item-3217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3217"><a href="../category/docker/index.html">Docker</a></li>
<li id="menu-item-3218" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3218"><a href="../category/packer/index.html">Packer</a></li>
<li id="menu-item-3219" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3219"><a href="../category/splunk/index.html">Splunk</a></li>
<li id="menu-item-3220" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-3220"><a href="../category/terraform/index.html">Terraform</a></li>
<li id="menu-item-3221" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3221"><a href="../category/vagrant/index.html">Vagrant</a></li>
<li id="menu-item-3223" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3223"><a href="../category/kubernetes/index.html">Kubernetes</a></li>
</ul>
</li>

<li id="menu-item-8821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8821"><a href="https://rumen.free.bg/#contact">Book a Consultation</a></li>
</ul> </nav>
</div>
</header>
<div id="content" class="site-content container clearfix">
<section id="primary" class="content-area">
<main id="main" class="site-main" role="main">

<article id="post-8276" class="post-8276 post type-post status-publish format-standard has-post-thumbnail hentry category-terraform wpautop">
<header class="entry-header">
<h1 class="entry-title">Creating EKS Cluster with SPOT instances &#8211; Terraform | Devops Junction</h1>
<div class="entry-meta"><span class="meta-date"> Updated on: <a href="index.html" title="1:18 am" rel="bookmark"><time class="entry-date published updated" datetime="April 4, 2022">April 4, 2022</time></a></span><span class="meta-author"> <span class="author vcard"><a class="url fn n" href="../author/admin/index.html" title="View all posts by Rumen Lishkov" rel="author">Rumen Lishkov</a></span></span></div>
</header>
<div class="entry-content clearfix">
<div class="ss-inline-share-wrapper ss-left-inline-content ss-small-icons ss-with-spacing ss-rounded-icons">
<div class="ss-inline-share-content">
<ul class="ss-social-icons-container">
<li class="">
<a href="#" data-ss-ss-link="https://www.facebook.com/sharer.php?t=Creating%20EKS%20Cluster%20with%20SPOT%20instances%20%E2%80%93%20Terraform%20%7C%20Devops%20Junction&u=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fterraform-eks-spot-instances%2F" class="ss-facebook-color" rel="nofollow" data-ss-ss-network-id="facebook" data-ss-ss-post-id="8276" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" data-ss-ss-type="share" data-has-api="true">
<span class="ss-share-network-content">
<i class="ss ss-facebook"></i>
<span class="ss-network-count">
0
</span>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://twitter.com/intent/tweet?text=Creating+EKS+Cluster+with+SPOT+instances+%E2%80%93+Terraform+%7C+Devops+Junction&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fterraform-eks-spot-instances%2F" class="ss-twitter-color" rel="nofollow" data-ss-ss-network-id="twitter" data-ss-ss-post-id="8276" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-twitter"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://www.linkedin.com/shareArticle?title=Creating%20EKS%20Cluster%20with%20SPOT%20instances%20%E2%80%93%20Terraform%20%7C%20Devops%20Junction&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fterraform-eks-spot-instances%2F&mini=true" class="ss-linkedin-color" rel="nofollow" data-ss-ss-network-id="linkedin" data-ss-ss-post-id="8276" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-linkedin"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="mailto:?body=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fterraform-eks-spot-instances%2F&subject=Creating%20EKS%20Cluster%20with%20SPOT%20instances%20%E2%80%93%20Terraform%20%7C%20Devops%20Junction" class="ss-envelope-color" rel="nofollow" data-ss-ss-network-id="envelope" data-ss-ss-post-id="8276" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-envelope"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="#" class="ss-copy-color" rel="nofollow" data-ss-ss-network-id="copy" data-ss-ss-post-id="8276" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-copy"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<p>In this article, we are going to see how to create an EKS Cluster with SPOT and OnDemand instances using Terraform.</p>
<p>If you have prior experience with AWS, you might know what is SPOT instances and ondemand instances are.  Let us start with a quick introduction towards SPOT instances.</p>
<p><a href="../../wp-content/uploads/2022/04/Terraform-eks-spot.png"><img class="post-img alignnone wp-image-8285 size-full lazyload" src="../../wp-content/ewww/lazy/placeholder-1748x1240.png" alt="Terraform eks spot instance" width="1748" height="1240" data-src="../../wp-content/uploads/2022/04/Terraform-eks-spot.png" loading="lazy" data-srcset="../../wp-content/uploads/2022/04/Terraform-eks-spot.png 1748w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-300x213.png 300w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-1024x726.png 1024w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-768x545.png 768w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-1536x1090.png 1536w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-90x65.png 90w" data-sizes="auto" /><noscript><img class="post-img alignnone wp-image-8285 size-full" src="../../wp-content/uploads/2022/04/Terraform-eks-spot.png" alt="Terraform eks spot instance" width="1748" height="1240" srcset="../../wp-content/uploads/2022/04/Terraform-eks-spot.png 1748w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-300x213.png 300w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-1024x726.png 1024w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-768x545.png 768w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-1536x1090.png 1536w, ../../wp-content/uploads/2022/04/Terraform-eks-spot-90x65.png 90w" sizes="(max-width: 1748px) 100vw, 1748px" data-eio="l" /></noscript></a></p>
<h2></h2>
<div id="ez-toc-container" class="counter-hierarchy counter-decimal ez-toc-grey">
<div class="ez-toc-title-container">
<p class="ez-toc-title">Table of Contents</p>
<span class="ez-toc-title-toggle"><a class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle"><i class="ez-toc-glyphicon ez-toc-icon-toggle"></i></a></span></div>
<nav><ul class="ez-toc-list"><li><a href="#Quick_Introduction_to_AWS_SPOT_instances" title="Quick Introduction to AWS SPOT instances">Quick Introduction to AWS SPOT instances</a></li><li><a href="#Objective" title="Objective">Objective</a></li><li><a href="#Download_the_Terraform_Code_from_Github" title="Download the Terraform Code from Github">Download the Terraform Code from Github</a></li><li><a href="#Customize_the_Terraform_Configuration" title="Customize the Terraform Configuration">Customize the Terraform Configuration</a><ul><li><a href="#Updating_the_Provider_configuration_AWS_Profile" title="Updating the Provider configuration ( AWS Profile )">Updating the Provider configuration ( AWS Profile )</a></li><li><a href="#Updating_the_Cluster_Name" title="Updating the Cluster Name">Updating the Cluster Name</a></li><li><a href="#Updating_the_Worker_Group_configuration" title="Updating the Worker Group configuration">Updating the Worker Group configuration</a></li></ul></li><li><a href="#EKS_Worker_Group_vs_NodeGroup_The_Difference" title="EKS Worker Group vs NodeGroup ( The Difference )">EKS Worker Group vs NodeGroup ( The Difference )</a></li><li><a href="#Terraform_init_and_Apply" title="Terraform init and Apply">Terraform init and Apply</a></li><li><a href="#Validate_the_Nodes_and_the_EKS_Cluster" title="Validate the Nodes and the EKS Cluster">Validate the Nodes and the EKS Cluster</a></li><li><a href="#Conclusion" title="Conclusion">Conclusion</a></li></ul></nav></div>
<h2><span class="ez-toc-section" id="Quick_Introduction_to_AWS_SPOT_instances">Quick Introduction to <span style="color: #e81787;">AWS SPOT</span> instances</span></h2>
<p>AWS Provides the unused/unoccupied EC2 instances for up to a 90% cheap rate in the name of SPOT instances.</p>
<p>While these instances are just like the Default <code>OnDemand</code> EC2 instances, their availability is not guaranteed.  SPOT instances can be reallocated anytime to other users so your application availability would be affected.</p>
<p>This is suitable for Highly Scalable workloads primarily in DEV and QA environments. Not recommended for Production.</p>
<p>When one Spot instance gets reallocated we always get a new SPOT instance to take cover.</p>
<p>SPOT instances work perfectly with EKS and you can use SPOT instances to scale your production application when there is a demand. once the usage has come down you can shutdown those instances.</p>
<p>You can use the following methods to provision and deprovision nodes</p>
<ul>
<li>Cluster AutoScaler</li>
<li>Karpenter</li>
</ul>
<p>I have written a dedicated article on how to use Karpenter for cluster autoscaling. <a href="../creating-eks-cluster-with-karpenter-auto-scaling-terraform-kubernetes/index.html">read the article here</a></p>
<p>Now you know about the SPOT instances I hope. Let us move on to our objective</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Objective">Objective</span></h2>
<p>Our objective for this article is to create a <strong>VPC with necassary subnets</strong> and a <strong>EKS Cluster with two managed worker groups</strong>. One with OnDemand instances another with SPOT instances</p>
<p>To schedule our application workload to the right nodes. we are adding a nodeselector during the creation itself</p>
<p>For <strong>Spot</strong> instance we are adding the following Label</p>
<div>
<pre>"--node-labels=node.kubernetes.io/lifecycle=spot"</pre>
</div>
<p>For <strong>OnDemand</strong> instances, using the following label</p>
<div>
<pre>"--node-labels=node.kubernetes.io/lifecycle=ondemand"</pre>
</div>
<p>this lets us schedule the important workloads to the on-demand instances and scalable workloads and temporary pods to spot instances.</p>
<p><strong><span style="color: #ed1367;">Note*: </span></strong>EKS <strong>WorkerGroups</strong> and <strong>NodeGroups</strong> are different. we have talked about it later in this article.</p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Download_the_Terraform_Code_from_Github">Download the Terraform Code from <span style="color: #e81787;">Github</span></span></h2>
<p>All the necessary Terraform code for this article is available in my GitHub repository.</p>
<p>You can clone my repository and begin to make changes</p>
<p><a href="https://github.com/AKSarav/TerraformEKS-SPOT">https://github.com/AKSarav/TerraformEKS-SPOT</a></p>
<p><a href="../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM.png" target="_blank" rel="https://github.com/AKSarav/TerraformEKS-SPOT noopener noreferrer"><img class="post-img alignnone wp-image-8283 size-full lazyload" src="../../wp-content/ewww/lazy/placeholder-1864x704.png" alt="terraform eks spot" width="1864" height="704" data-src="../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM.png" loading="lazy" data-srcset="../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM.png 1864w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM-300x113.png 300w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM-1024x387.png 1024w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM-768x290.png 768w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM-1536x580.png 1536w" data-sizes="auto" /><noscript><img class="post-img alignnone wp-image-8283 size-full" src="../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM.png" alt="terraform eks spot" width="1864" height="704" srcset="../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM.png 1864w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM-300x113.png 300w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM-1024x387.png 1024w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM-768x290.png 768w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-04-at-12.41.01-AM-1536x580.png 1536w" sizes="(max-width: 1864px) 100vw, 1864px" data-eio="l" /></noscript></a></p>
<p>&nbsp;</p>
<p><span style="color: #003366;"><strong>Quick note: </strong></span></p>
<p>We are using the following modules in our terraform config ( why to reinvent the wheel when you can be efficient )</p>
<ul>
<li>terraform-aws-modules/vpc/aws -3.2.0</li>
<li>
<div>
<div>terraform-aws-modules/eks/aws &#8211; 18</div>
</div>
</li>
</ul>
<p>we are referring to these modules directly in our tf files using module and source. so no manual intervention required there.</p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Customize_the_Terraform_Configuration">Customize the <span style="color: #ed1367;">Terraform</span> Configuration</span></h2>
<p>Once you have downloaded the code from the Github, Now you can make further customizations</p>
<p>Here is the quick snapshot to validate the list of files once downloaded</p>
<p>The code can be modified to suit your need.  Here are few things you can consider changing</p>
<ul>
<li>Cluster name</li>
<li>Number of instances</li>
<li>Instance type and capacity ( t2.small, t3.small etc)</li>
</ul>
<p>We are using the clustername as the VPC name to keep things simple and to find out easily which VPC belongs to EKS.</p>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Updating_the_Provider_configuration_AWS_Profile"><strong><span style="color: #003366;">Updating the Provider configuration ( AWS Profile )</span></strong></span></h3>
<p>For Terraform to connect to AWS, you need to either pass the AWS Key and secret or let terraform use the AWS CLI installed locally.</p>
<p>If you are managing multiple AWS accounts using AWS CLI, you must be multiple having named profiles. In my case, I am using a profile named <code>personal</code></p>
<p>This is the content of my <code>providers.tf</code> file</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="bootstrap4" data-enlighter-linenumbers="false">provider "kubernetes" {
  host                   = data.aws_eks_cluster.cluster.endpoint
  token                  = data.aws_eks_cluster_auth.cluster.token
  cluster_ca_certificate = base64decode(data.aws_eks_cluster.cluster.certificate_authority.0.data)
}

provider "aws" {
  region = "us-east-2"
  profile = "personal"
}</pre>
<p>You can see that I am using <strong>us-east-2</strong> as my region and <strong>personal</strong> as my aws cli profile</p>
<p>Update it to suit your setup.</p>
<p>New to AWS CLI. <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html">learn what is named profile from here</a></p>
<p>If you are completely new to AWS and Terraform and trying to create your first AWS setup with Terraform. Please go through the following article to learn some basics</p>
<blockquote class="wp-embedded-content" data-secret="uY6BR2p60W"><p><a href="../terraform-aws-example-ec2/index.html">Terraform AWS Example &#8211; Create EC2 instance with Terraform</a></p></blockquote>
<p><iframe class="wp-embedded-content" sandbox="allow-scripts" security="restricted" style="position: absolute; clip: rect(1px, 1px, 1px, 1px);" title="&#8220;Terraform AWS Example &#8211; Create EC2 instance with Terraform&#8221; &#8212; Middleware Inventory" src="../terraform-aws-example-ec2/embed/index.html#?secret=uY6BR2p60W" data-secret="uY6BR2p60W" width="600" height="338" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></p>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Updating_the_Cluster_Name"><strong><span style="color: #003366;">Updating the Cluster Name</span></strong></span></h3>
<p>You need to update the <code>variables.tf</code> file with the cluster name of your choice. I have used <code>GritfyEKS</code> as the name</p>
<pre class="EnlighterJSRAW" data-enlighter-language="json" data-enlighter-theme="bootstrap4" data-enlighter-linenumbers="false">variable "clustername"{
    default = "GritfyEKS"
    description = "Gritfy  EKS Cluster"
}</pre>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Updating_the_Worker_Group_configuration"><strong><span style="color: #003366;">Updating the Worker Group configuration</span></strong></span></h3>
<p>In the same variables.tf file you can find more elements to update</p>
<ul>
<li><strong>spot_instance_types</strong> &#8211; list of instances that can be used while creating Spot instances</li>
<li><strong>ondemand_instance_type</strong> &#8211; A single instance type to use for creating ondemand workergroup</li>
<li><strong>spot_max_size</strong> &#8211; Maximum number of SPOT instances that can be created</li>
<li><strong>spot_desired_size</strong> &#8211; How many spot instances are to be created at the beginning</li>
<li><strong>ondemand_desired_size</strong> &#8211; how many on-demand instances to create at first</li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="bootstrap4" data-enlighter-linenumbers="false">variable "spot_instance_types"{
    default = ["t3.small","t2.small"]
    description = "List of instance types for SPOT instance selection"
}
variable "ondemand_instance_type"{
    default = "t3.medium"
    description = "On Demand instance type"
}
variable "spot_max_size"{
    default = 2
    description = "How many SPOT instance can be created max"
}
variable "spot_desired_size"{
    default = 2
    description = "How many SPOT instance should be running at all times"
}
variable "ondemand_desired_size"{
    default = 2
    description = "How many OnDemand instances should be running at all times"
}
</pre>
<p>&nbsp;</p>
<p>Once you are done with all these three things. we are good to go and start.</p>
<p>If you have the right privileges in AWS. you should not be having any issues along the way. In case of any support do let us know in the comments</p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="EKS_Worker_Group_vs_NodeGroup_The_Difference">EKS <span style="color: #ed1367;">Worker</span> Group vs <span style="color: #ed1367;">NodeGroup</span> ( The Difference )</span></h2>
<p>This terraform configuration is designed to worker group instead of nodegroup.</p>
<p>EKS supports two types of instance groups.</p>
<ul>
<li><strong>WorkerGroups</strong> &#8211; Self Managed Group of EC2 instances, where the patching and upgrade has to be done by the DevOps Engineer with caution</li>
<li><strong>NodeGroups</strong> &#8211; AWS Managed Group of EC2 instances, where the patching and upgrade can be done with a single click from the AWS console.</li>
</ul>
<p>If you are going for production you can choose to go with <code>NodeGroups</code> and the terraform configuration would be different for the same. This is called EKS <strong>Managed Node Group</strong></p>
<p>In this article, <strong>Our Terraform code is designed with WorkerGroup</strong> it means that the EC2 instances created and attached with EKS should be managed by us.</p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Terraform_init_and_Apply">Terraform <span style="color: #ed1367;">init</span> and <span style="color: #ed1367;">Apply</span></span></h2>
<p>Once you have made the necessary changes. Now you can go for Initializing your Terraform</p>
<p>This installs the necessary modules and the providers.</p>
<p><a href="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM.png"><img class="post-img alignnone wp-image-8277 size-full lazyload" src="../../wp-content/ewww/lazy/placeholder-1920x1544.png" alt="Terraform EKS SPOT" width="2350" height="1890" data-src="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM.png" loading="lazy" data-srcset="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM.png 2350w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-300x241.png 300w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-1024x824.png 1024w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-768x618.png 768w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-1536x1235.png 1536w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-2048x1647.png 2048w" data-sizes="auto" /><noscript><img class="post-img alignnone wp-image-8277 size-full" src="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM.png" alt="Terraform EKS SPOT" width="2350" height="1890" srcset="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM.png 2350w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-300x241.png 300w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-1024x824.png 1024w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-768x618.png 768w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-1536x1235.png 1536w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-6.28.06-PM-2048x1647.png 2048w" sizes="(max-width: 2350px) 100vw, 2350px" data-eio="l" /></noscript></a></p>
<p>Once the Initialization complete, you can go for the <code>plan</code> and <code>apply</code></p>
<pre>terraform plan -out tfplan.out
terraform apply tfplan.out</pre>
<p>Upon completion of your Terraform execution. You would have your EKS Cluster ready with 3 nodes.</p>
<div style="width: 840px;" class="wp-video"><!--[if lt IE 9]><script>document.createElement('video');</script><![endif]-->
<video class="wp-video-shortcode" id="video-8276-1" width="840" height="473" preload="metadata" controls="controls"><source type="video/mp4" src="../../wp-content/uploads/2022/04/Screen-Recording-2022-04-03-at-9.33.03-PM-_=1.mp4" /><a href="../../wp-content/uploads/2022/04/Screen-Recording-2022-04-03-at-9.33.03-PM.mp4">https://airdata.gitlab.io/blog/wp-content/uploads/2022/04/Screen-Recording-2022-04-03-at-9.33.03-PM.mp4</a></video></div>
<p>Before executing the kubectl command. you can use the KUBECONFIG file created by default during the terraform run</p>
<pre>export KUBECONFIG=${PWD}/kubeconfig_&lt;YourClusterName&gt;</pre>
<p>When you set this KUBECONFIG variable, kubectl would start referring to the local kubeconfig file created during the terraform run</p>
<p>Make sure you replace your cluster name after <code>kubeconfig_</code></p>
<p>The second thing to do is to set the default AWS region and the profile ( if you are using multiple AWS CLI profiles)</p>
<p>If you are not having any <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html">named profiles</a> in AWS CLI. you may not have to do the <code>AWS_DEFAULT_PROFILE</code>export since we have set the region as <code>us-east-2</code>in <strong>providers.tf </strong>file</p>
<p>you need to set your AWS_DEFAULT_REGION to the same. this is not needed if you have configured your default region to the same region.</p>
<pre>export AWS_DEFAULT_REGION=us-east-2
export AWS_DEFAULT_PROFILE=personal</pre>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Validate_the_Nodes_and_the_EKS_Cluster"><span style="color: #ed1367;">Validate</span> the Nodes and the EKS <span style="color: #ed1367;">Cluster</span></span></h2>
<p>If you have used the right AWS Profile and Region as same as the ones mentioned on the <code>providers.tf</code> file and have exported the <code>KUBE_CONFIG</code> right</p>
<p>you should now be able to list the nodes and connect successfully to your cluster</p>
<p>Now execute the <code>kubectl get nodes</code> command to validate if the nodes are created and you are able to see them</p>
<p>Also to make sure if the nodes having the right labels respective to their instance type. Try to use the following command</p>
<pre>kubectl get nodes -o json|jq -C '.items[] | .metadata.name,.metadata.labels'</pre>
<p>This would show the nodes and their labels and you can see the <code>instance_type</code> and the other relative labels</p>
<p><a href="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM.png"><img class="post-img alignnone wp-image-8280 size-full lazyload" src="../../wp-content/ewww/lazy/placeholder-1920x1920.png" alt="terraform eks" width="1992" height="2160" data-src="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM.png" loading="lazy" data-srcset="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM.png 1992w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-277x300.png 277w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-944x1024.png 944w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-768x833.png 768w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-1417x1536.png 1417w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-1889x2048.png 1889w" data-sizes="auto" /><noscript><img class="post-img alignnone wp-image-8280 size-full" src="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM.png" alt="terraform eks" width="1992" height="2160" srcset="../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM.png 1992w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-277x300.png 277w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-944x1024.png 944w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-768x833.png 768w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-1417x1536.png 1417w, ../../wp-content/uploads/2022/04/Screenshot-2022-04-03-at-11.56.52-PM-1889x2048.png 1889w" sizes="(max-width: 1992px) 100vw, 1992px" data-eio="l" /></noscript></a></p>
<p>You can revalidate this info by logging to aws console or using <code>aws cli</code> as well.</p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Conclusion">Conclusion</span></h2>
<p>In this article, we have learned how to create EKS Cluster with <strong>SPOT</strong> and an <strong>on-demand</strong> worker group of EC2 instances.</p>
<p>We also learn a few more other things</p>
<ul>
<li>Difference between <strong>workergroup</strong> and <strong>nodegroup</strong></li>
<li>Adding Label to the node during the EKS Cluster creation</li>
<li>Listing the nodes with labels using kubectl</li>
<li>How to use AWS DEFAULT variables to choose the AWSCLI profile and region</li>
</ul>
<p>Hope this article helps you. If you have any questions please do reach out to us on the comments section</p>
<p>For any professional support for individuals or for your organization. reach us at <a href="../../cdn-cgi/l/email-protection.html#452d2029292a0522372c31233c6b262a28"><span class="__cf_email__" data-cfemail="acc4c9c0c0c3eccbdec5d8cad582cfc3c1">[email&#160;protected]</span></a></p>
<a href="../../wp-content/uploads/2021/09/DaaS.svg"><img class="post-img lazyload" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1047 415'%3E%3C/svg%3E" alt="gritfy" width="1047" height="415" class="post-img lazyload" data-src="../../wp-content/uploads/2021/09/DaaS.svg" loading="lazy" /><noscript><img class="post-img" src="../../wp-content/uploads/2021/09/DaaS.svg" alt="gritfy" width="1047" height="415" class="alignnone size-full wp-image-6623" data-eio="l" /></noscript></a>
<p>&nbsp;</p>
<p>Cheers<br />
Rumen Lishkov</p>
<div id="postfollow">
<a href='https://ko-fi.com/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==' border='0' alt='Buy Me a Coffee at ko-fi.com' data-src="https://az743702.vo.msecnd.net/cdn/kofi3.png?v=2" loading="lazy" class="lazyload" /><noscript><img height='46' style='border:0px;height:46px;width: 186px' src='https://az743702.vo.msecnd.net/cdn/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' data-eio="l" /></noscript></a>
<p>Follow us on<a href="https://www.facebook.com/rumenlishkov">Facebook</a> or<a href="https://www.twitter.com/mwinventory">Twitter</a>
</br>
For more practical videos and tutorials. <a href="https://www.youtube.com/kiss2mark">Subscribe to our channel</a>
</br>
Find me on Linkedin <a href="https://www.linkedin.com/in/rumen-lishkov/">My Profile</a>
</br>
</i>For any Consultation or to hire us <a href="../../cdn-cgi/l/email-protection.html#c9a1aca5a5a689aebba0bdafb0e7aaa6a4"> <span class="__cf_email__" data-cfemail="d3bbb6bfbfbc93b4a1baa7b5aafdb0bcbe">[email&#160;protected]</span></a>
</br>
If you like this article. Show your Support! <a href="https://ko-fi.com/middlewareinventory">Buy me a Coffee.</a>
</br>
</p>
<p style="color: palevioletred !important;">Signup for Exclusive "Subscriber-only" Content</p>
<div class="emaillist">
<form action="#" method="post" class="es_subscription_form es_shortcode_form" id="es_subscription_form_1657195246" data-source="ig-es">
<div class="es-field-wrap"><label>Name*<br /><input type="text" name="name" class="ig_es_form_field_name" placeholder="" value="" required="required" /></label></div><div class="es-field-wrap"><label>Email*<br /><input class="es_required_field es_txt_email ig_es_form_field_email" type="email" name="email" value="" placeholder="" required="required" /></label></div><input type="hidden" name="lists[]" value="1" /><input type="hidden" name="form_id" value="3" />
<input type="hidden" name="es_email_page" value="8276" />
<input type="hidden" name="es_email_page_url" value="https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" />
<input type="hidden" name="status" value="Unconfirmed" />
<input type="hidden" name="es-subscribe" id="es-subscribe" value="4af32dc5ca" />
<label style="position:absolute;top:-99999px;left:-99999px;z-index:-99;"><input type="email" name="es_hp_email" class="es_required_field" tabindex="-1" autocomplete="-1" value="" /></label>
<input type="submit" name="submit" class="es_subscription_form_submit es_submit_button es_textbox_button" id="es_subscription_form_submit_1657195246" value="Subscribe" />
<span class="es_spinner_image" id="spinner-image"><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Loading" data-src="../../wp-content/plugins/email-subscribers/lite/public/images/spinner.gif" loading="lazy" class="lazyload" /><noscript><img src="../../wp-content/plugins/email-subscribers/lite/public/images/spinner.gif" alt="Loading" data-eio="l" /></noscript></span>
</form>
<span class="es_subscription_message" id="es_subscription_message_1657195246"></span>
</div>
</div>
<hr>
<div class='rp4wp-related-posts'>
<h3>More from Middleware Inventory</h3>
<ul>
<li><div class='rp4wp-related-post-image'>
<a href='../creating-eks-cluster-with-karpenter-auto-scaling-terraform-kubernetes/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="EKS Karpenter Example" data-src="../../wp-content/uploads/2022/02/aws-eks-karpenter-150x150.jpg" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2022/02/aws-eks-karpenter-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="EKS Karpenter Example" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../creating-eks-cluster-with-karpenter-auto-scaling-terraform-kubernetes/index.html'>Creating EKS Cluster with Karpenter Auto scaling - Terraform | Kubernetes</a><p>Kubernetes has been a disruptive change in IT Infrastructure. It had been widely adopted across the industry Managed Kubernetes are the best choice if you do not want to face the hurdles of setting up K8s from scratch Unless you want to deep learn Kubernetes. AWS a market leader in&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../store-terraform-state-terraform-cloud/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="Terraform remote state cloud" data-src="../../wp-content/uploads/2021/12/terraform-remote-state-150x150.jpg" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2021/12/terraform-remote-state-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Terraform remote state cloud" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../store-terraform-state-terraform-cloud/index.html'>Store terraform state file on Terraform cloud Remote | Devops Junction</a><p>In this article, I am going to discuss how we can keep safe our terraform state file using terraform cloud. As a pioneer/Practioner of Terraform CLI, we hold responsible for Terraform state file which is the source of truth for our infrastructure. What if we lose this state file or&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../terraform-aws-example-ec2/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" data-src="../../wp-content/uploads/2020/01/TerraformAWS-1-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2020/01/TerraformAWS-1-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../terraform-aws-example-ec2/index.html'>Terraform AWS Example - Create EC2 instance with Terraform</a><p>Terraform, An outstanding and innovative product from hashicorp and it is a leader in Infrastructure as Code tools Segment.&nbsp; Before I go any further, I think I should set the context. In this article, we are going to learn how to use Terraform to create AWS EC2 instance and create&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../terraform-import-securitygroup-aws/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="Terraform Import" data-src="../../wp-content/uploads/2020/09/Screenshot-2020-09-06-at-2.39.15-AM-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2020/09/Screenshot-2020-09-06-at-2.39.15-AM-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Terraform Import" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../terraform-import-securitygroup-aws/index.html'>Terraform import All AWS Security Groups - How to</a><p>In this post, we are going to see how to manage existing and already created AWS Security groups with Terraform. The new era of Infrastructure revolution has begun already and we already started provisioning, managing, administrating our Infra as a code with help of Configuration management tools like Ansible, Terraform,&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../terraform-aws-ec2-user_data-example/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="Terraform EC2 user_data example" data-src="../../wp-content/uploads/2021/09/user_data_tf-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2021/09/user_data_tf-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Terraform EC2 user_data example" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../terraform-aws-ec2-user_data-example/index.html'>Terraform AWS EC2 user_data example - aws_instance| Devops Junction</a><p>In this article we are going to see how to create AWS EC2 instance with user_data. While launching AWS Ec2 instances we might want to add some customizations to it like adding a key and executing few shell commands or scripts to make sure they are ready to launch your&hellip;</p></div>
</li>
</ul>
</div>
</div>
<footer class="entry-footer">
<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="../terraform-ebs_block_device-example/index.html" rel="prev"><span class="screen-reader-text">Previous Post:</span>Terraform ebs_block_device example &#8211; Multiple EBS volumes AWS EC2</a></div><div class="nav-next"><a href="../internal-external-load-balancer-aws-eks/index.html" rel="next"><span class="screen-reader-text">Next Post:</span>Creating Internal and External Load Balancers from EKS &#8211; Kubernetes</a></div></div>
</nav>
</footer>
</article>
<div id="disqus_thread"></div>
</main>
</section>
<section id="secondary" class="sidebar widget-area clearfix" role="complementary">
<aside id="custom_html-18" class="widget_text widget widget_custom_html clearfix"><div class="textwidget custom-html-widget"><script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3398911159151128" crossorigin="anonymous"></script>


<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div></aside><aside id="categories-8" class="widget widget_categories clearfix"><div class="widget-header"><h3 class="widget-title">Categories</h3></div>
<ul>
<li class="cat-item cat-item-61"><a href="../category/activemq/index.html">ActiveMQ</a> (4)
</li>
<li class="cat-item cat-item-98"><a href="../category/ansible/index.html">Ansible</a> (65)
</li>
<li class="cat-item cat-item-10"><a href="../category/apache/index.html">Apache</a> (8)
</li>
<li class="cat-item cat-item-234"><a href="../category/aws/index.html">AWS</a> (28)
</li>
<li class="cat-item cat-item-452"><a href="../category/azure/index.html">Azure</a> (1)
</li>
<li class="cat-item cat-item-8"><a href="../category/best-practice/index.html">Best Practice</a> (5)
</li>
<li class="cat-item cat-item-390"><a href="../category/bitbucket/index.html">BitBucket</a> (1)
</li>
<li class="cat-item cat-item-426"><a href="../category/boto/index.html">Boto</a> (1)
</li>
<li class="cat-item cat-item-399"><a href="../category/cloud/index.html" title="Cloud is not only a concept but also a practice of using a network of remote servers hosted on the Internet to store, manage, and process data.">Cloud</a> (1)
</li>
<li class="cat-item cat-item-397"><a href="../category/database/index.html">Database</a> (1)
</li>
<li class="cat-item cat-item-95"><a href="../category/development/index.html">Development</a> (3)
</li>
<li class="cat-item cat-item-152"><a href="../category/docker/index.html">Docker</a> (11)
</li>
<li class="cat-item cat-item-422"><a href="../category/efk/index.html">EFK</a> (1)
</li>
<li class="cat-item cat-item-423"><a href="../category/elastic-search/index.html">Elastic Search</a> (1)
</li>
<li class="cat-item cat-item-59"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a> (6)
</li>
<li class="cat-item cat-item-419"><a href="../category/fluentd/index.html">FluentD</a> (2)
</li>
<li class="cat-item cat-item-424"><a href="../category/gcp-googlecloud/index.html">GCP &#8211; GoogleCloud</a> (1)
</li>
<li class="cat-item cat-item-450"><a href="../category/github-actions/index.html">Github Actions</a> (1)
</li>
<li class="cat-item cat-item-428"><a href="../category/grafana/index.html">Grafana</a> (1)
</li>
<li class="cat-item cat-item-275"><a href="../category/graphite/index.html">Graphite</a> (1)
</li>
<li class="cat-item cat-item-441"><a href="../category/ibm-cloud/index.html">IBM Cloud</a> (1)
</li>
<li class="cat-item cat-item-401"><a href="../category/ibm-websphere/index.html" title="IBM® WebSphere® Application Server provides a range of flexible and secure runtime for Java enterprise applications, lightweight web applications and microservices. You can create new applications and enhance and optimize existing application infrastructure on premises or across any public, private or hybrid cloud. In addition, by utilizing IBM Cloud Private, you can create on-premises cloud capabilities similar to public clouds to accelerate app development. The platform is built on the open source Kubernetes-based container architecture and supports both Docker containers and Cloud Foundry.">IBM Websphere</a> (2)
</li>
<li class="cat-item cat-item-354"><a href="../category/ihs-and-apache/index.html">IHS and Apache</a> (10)
</li>
<li class="cat-item cat-item-353"><a href="../category/iis/index.html">IIS</a> (4)
</li>
<li class="cat-item cat-item-388"><a href="../category/javascript/index.html">JavaScript</a> (3)
</li>
<li class="cat-item cat-item-286"><a href="../category/jenkins/index.html">Jenkins</a> (4)
</li>
<li class="cat-item cat-item-15"><a href="../category/joomla/index.html">Joomla</a> (1)
</li>
<li class="cat-item cat-item-151"><a href="../category/kubernetes/index.html">Kubernetes</a> (16)
</li>
<li class="cat-item cat-item-191"><a href="../category/middleware/index.html">Middleware</a> (3)
</li>
<li class="cat-item cat-item-322"><a href="../category/network-troubleshooting/index.html">Network Troubleshooting</a> (1)
</li>
<li class="cat-item cat-item-413"><a href="../category/networking/index.html">Networking</a> (1)
</li>
<li class="cat-item cat-item-273"><a href="../category/nodejs/index.html">NodeJS</a> (2)
</li>
<li class="cat-item cat-item-396"><a href="../category/office365/index.html">Office365</a> (1)
</li>
<li class="cat-item cat-item-148"><a href="../category/opensource/index.html">OpenSource</a> (2)
</li>
<li class="cat-item cat-item-417"><a href="../category/oracle-db/index.html">Oracle DB</a> (3)
</li>
<li class="cat-item cat-item-404"><a href="../category/oracle-weblogic/index.html" title="WebLogic is a leading Application Server product most widely used for e-commerce online transaction processing (OLTP) platform application, developed to connect users in a distributed computing environment and to facilitate the integration of mainframe applications with distributed corporate data and applications.">Oracle Weblogic</a> (2)
</li>
<li class="cat-item cat-item-232"><a href="../category/packer/index.html">Packer</a> (2)
</li>
<li class="cat-item cat-item-146"><a href="../category/perl/index.html">Perl</a> (1)
</li>
<li class="cat-item cat-item-60"><a href="../category/php/index.html">PHP</a> (1)
</li>
<li class="cat-item cat-item-453"><a href="../category/postgresql/index.html">PostgreSQL</a> (1)
</li>
<li class="cat-item cat-item-343"><a href="../category/powershell/index.html">PowerShell</a> (1)
</li>
<li class="cat-item cat-item-31"><a href="../category/weblogic/problemsolution/index.html">problem/solution</a> (8)
</li>
<li class="cat-item cat-item-427"><a href="../category/prometheus/index.html">Prometheus</a> (1)
</li>
<li class="cat-item cat-item-445"><a href="../category/pulumi/index.html">Pulumi</a> (1)
</li>
<li class="cat-item cat-item-285"><a href="../category/python-flask/index.html">Python Flask</a> (1)
</li>
<li class="cat-item cat-item-22"><a href="../category/python_scripts/index.html">python_scripts</a> (7)
</li>
<li class="cat-item cat-item-446"><a href="../category/redis/index.html">Redis</a> (1)
</li>
<li class="cat-item cat-item-451"><a href="../category/serverless/index.html">Serverless</a> (1)
</li>
<li class="cat-item cat-item-12"><a href="../category/shell-scripting/index.html">Shell Scripting</a> (6)
</li>
<li class="cat-item cat-item-125"><a href="../category/soap-web-services/index.html">SOAP Web Services</a> (1)
</li>
<li class="cat-item cat-item-13"><a href="../category/splunk/index.html">Splunk</a> (1)
</li>
<li class="cat-item cat-item-425"><a href="../category/sre/index.html">SRE</a> (1)
</li>
<li class="cat-item cat-item-274"><a href="../category/statsd/index.html">StatsD</a> (1)
</li>
<li class="cat-item cat-item-233"><a href="../category/terraform/index.html">Terraform</a> (12)
</li>
<li class="cat-item cat-item-35"><a href="../category/tomcat/index.html">tomcat</a> (7)
</li>
<li class="cat-item cat-item-147"><a href="../category/tools/index.html">tools</a> (5)
</li>
<li class="cat-item cat-item-391"><a href="../category/traefik/index.html">Traefik</a> (1)
</li>
<li class="cat-item cat-item-124"><a href="../category/troubleshooting/index.html">Troubleshooting</a> (3)
</li>
<li class="cat-item cat-item-1"><a href="../category/uncategorized/index.html">Uncategorized</a> (5)
</li>
<li class="cat-item cat-item-7"><a href="../category/unix/index.html">Unix</a> (5)
</li>
<li class="cat-item cat-item-99"><a href="../category/vagrant/index.html">Vagrant</a> (4)
</li>
<li class="cat-item cat-item-389"><a href="../category/vuejs/index.html">VueJS</a> (2)
</li>
<li class="cat-item cat-item-356"><a href="../category/vulnerabilities-fixes/index.html">Vulnerabilities &amp; Fixes</a> (21)
</li>
<li class="cat-item cat-item-21"><a href="../category/weblogic/index.html">weblogic</a> (51)
</li>
<li class="cat-item cat-item-9"><a href="../category/webserver/index.html">Webserver</a> (1)
</li>
<li class="cat-item cat-item-92"><a href="../category/websphere/index.html">Websphere</a> (8)
</li>
<li class="cat-item cat-item-321"><a href="../category/windows-server/index.html">Windows Server</a> (5)
</li>
<li class="cat-item cat-item-55"><a href="../category/wlst/index.html">wlst</a> (7)
</li>
<li class="cat-item cat-item-36"><a href="../category/wordpress/index.html">wordpress</a> (2)
</li>
<li class="cat-item cat-item-4"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a> (1)
</li>
</ul>
</aside><aside id="media_image-5" class="widget widget_media_image clearfix"><img width="267" height="400" src="../../wp-content/ewww/lazy/placeholder-267x400.png" class="image wp-image-8825  attachment-full size-full lazyload" alt="write for devopsjunction" style="max-width: 75%; height: auto;" data-src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" loading="lazy" data-srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" data-sizes="auto" /><noscript><img width="267" height="400" src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" class="image wp-image-8825  attachment-full size-full" alt="write for devopsjunction" style="max-width: 75%; height: auto;" srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" sizes="(max-width: 267px) 100vw, 267px" data-eio="l" /></noscript></aside>
</section>
</div>
<div id="footer" class="footer-wrap">
<footer id="colophon" class="site-footer container clearfix" role="contentinfo">
<div id="footer-text" class="site-info">
<span class="credit-link">Powered by <a href="../../index.html" title="Rumen Lishkov">Rumen Lishkov</a> and <a href="https://rumen.free.bg/" title="Studio-1">Studio1 Sofia</a> </span>
</div>
</footer>
</div>
</div>
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@mwinventory" />
<meta name="twitter:creator" content="@mwinventory" />
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&amp;display=swap" rel="stylesheet"><div class="simplesocialbuttons simplesocial-round-icon simplesocialbuttons-float-left-center post-8276 post  ssb_counter-activate simplesocialbuttons-slide-bottom-in">
<button class="simplesocial-fb-share" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Facebook </span> <span class="ssb_counter ssb_fbshare_counter">0</span></button>
<button class="simplesocial-twt-share" data-href="https://twitter.com/share?text=Creating+EKS+Cluster+with+SPOT+instances+%E2%80%93+Terraform+%7C+Devops+Junction&url=https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Twitter</span> <span class="ssb_counter ssb_twitter_counter">0</span></button>
<button target="popup" class="simplesocial-linkedin-share" data-href="https://www.linkedin.com/cws/share?url=https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">LinkedIn</span></button>
<button onclick="javascript:window.location.href = this.dataset.href;return false;" class="simplesocial-email-share" data-href="mailto:?subject=Creating+EKS+Cluster+with+SPOT+instances+%E2%80%93+Terraform+%7C+Devops+Junction&body=https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/"><span class="simplesocialtxt">Email</span></button>
<button onclick="javascript:window.open(this.dataset.href, '_blank' );return false;" class="simplesocial-whatsapp-share" data-href="https://web.whatsapp.com/send?text=https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/"><span class="simplesocialtxt">WhatsApp</span></button>
</div>
<script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><link rel="stylesheet" href="../../wp-content/cache/minify/d5ca8.css" media="all" />
<script type='text/javascript' id='disqus_count-js-extra'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"mwinventory"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f8767.js"></script>
<script type='text/javascript' id='disqus_embed-js-extra'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.22"},"disqusIdentifier":"8276 https:\/\/www.middlewareinventory.com\/?p=8276","disqusShortname":"mwinventory","disqusTitle":"Creating EKS Cluster with SPOT instances \u2013 Terraform | Devops Junction","disqusUrl":"https:\/\/www.middlewareinventory.com\/blog\/terraform-eks-spot-instances\/","postId":"8276"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/bccbc.js"></script>
<script type='text/javascript' id='dae-download-js-extra'>
/* <![CDATA[ */
var objDaeDownload = {"ajaxUrl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"c3faebb42a"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/8510d.js"></script>
<script type='text/javascript' id='socialsnap-js-js-extra'>
/* <![CDATA[ */
var socialsnap_script = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","on_media_width":"250","on_media_height":"250","nonce":"ad1aa689b7","post_id":"8276"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/fef55.js"></script>
<script type='text/javascript' id='aicp-js-extra'>
/* <![CDATA[ */
var AICP = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"f0b2747bdc","ip":"2a02:8109:b640:2368:850:ac32:9e51:2599","clickLimit":"1","clickCounterCookieExp":"3","banDuration":"7","countryBlockCheck":"No","banCountryList":"RU"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/ff9fe.js"></script>
<script type='text/javascript' src='https://js.stripe.com/v3/?ver=2.03' id='stripe-js'></script>
<script type='text/javascript' id='q2w3_fixed_widget-js-extra'>
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"q2w3-default-sidebar","margin_top":10,"margin_bottom":0,"stop_id":"","screen_max_width":1026,"screen_max_height":0,"width_inherit":true,"refresh_interval":1500,"window_load_hook":false,"disable_mo_api":false,"widgets":["text-32"]}];
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f2bcf.js"></script>
<script type='text/javascript' id='enlighterjs-js-after'>
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"enlighter","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
</script>
<script src="../../wp-content/cache/minify/13d7d.js"></script>
<script type='text/javascript' id='mediaelement-core-js-before'>
var mejsL10n = {"language":"en","strings":{"mejs.download-file":"Download File","mejs.install-flash":"You are using a browser that does not have Flash player enabled or installed. Please turn on your Flash player plugin or download the latest version from https:\/\/get.adobe.com\/flashplayer\/","mejs.fullscreen":"Fullscreen","mejs.play":"Play","mejs.pause":"Pause","mejs.time-slider":"Time Slider","mejs.time-help-text":"Use Left\/Right Arrow keys to advance one second, Up\/Down arrows to advance ten seconds.","mejs.live-broadcast":"Live Broadcast","mejs.volume-help-text":"Use Up\/Down Arrow keys to increase or decrease volume.","mejs.unmute":"Unmute","mejs.mute":"Mute","mejs.volume-slider":"Volume Slider","mejs.video-player":"Video Player","mejs.audio-player":"Audio Player","mejs.captions-subtitles":"Captions\/Subtitles","mejs.captions-chapters":"Chapters","mejs.none":"None","mejs.afrikaans":"Afrikaans","mejs.albanian":"Albanian","mejs.arabic":"Arabic","mejs.belarusian":"Belarusian","mejs.bulgarian":"Bulgarian","mejs.catalan":"Catalan","mejs.chinese":"Chinese","mejs.chinese-simplified":"Chinese (Simplified)","mejs.chinese-traditional":"Chinese (Traditional)","mejs.croatian":"Croatian","mejs.czech":"Czech","mejs.danish":"Danish","mejs.dutch":"Dutch","mejs.english":"English","mejs.estonian":"Estonian","mejs.filipino":"Filipino","mejs.finnish":"Finnish","mejs.french":"French","mejs.galician":"Galician","mejs.german":"German","mejs.greek":"Greek","mejs.haitian-creole":"Haitian Creole","mejs.hebrew":"Hebrew","mejs.hindi":"Hindi","mejs.hungarian":"Hungarian","mejs.icelandic":"Icelandic","mejs.indonesian":"Indonesian","mejs.irish":"Irish","mejs.italian":"Italian","mejs.japanese":"Japanese","mejs.korean":"Korean","mejs.latvian":"Latvian","mejs.lithuanian":"Lithuanian","mejs.macedonian":"Macedonian","mejs.malay":"Malay","mejs.maltese":"Maltese","mejs.norwegian":"Norwegian","mejs.persian":"Persian","mejs.polish":"Polish","mejs.portuguese":"Portuguese","mejs.romanian":"Romanian","mejs.russian":"Russian","mejs.serbian":"Serbian","mejs.slovak":"Slovak","mejs.slovenian":"Slovenian","mejs.spanish":"Spanish","mejs.swahili":"Swahili","mejs.swedish":"Swedish","mejs.tagalog":"Tagalog","mejs.thai":"Thai","mejs.turkish":"Turkish","mejs.ukrainian":"Ukrainian","mejs.vietnamese":"Vietnamese","mejs.welsh":"Welsh","mejs.yiddish":"Yiddish"}};
</script>
<script src="../../wp-content/cache/minify/864c2.js"></script>
<script type='text/javascript' id='mediaelement-js-extra'>
/* <![CDATA[ */
var _wpmejsSettings = {"pluginPath":"\/wp-includes\/js\/mediaelement\/","classPrefix":"mejs-","stretching":"responsive"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/07aa1.js"></script>
<script type='text/javascript' id='ez-toc-js-js-extra'>
/* <![CDATA[ */
var ezTOC = {"smooth_scroll":"1","visibility_hide_by_default":"","width":"100%","scroll_offset":"30"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/0c713.js"></script>
<div id="ss-copy-popup" class="ss-popup-overlay">
<div class="ss-popup">
<div class="ss-popup-heading">
<span>Copy link</span>
<a href="#" id="ss-close-share-networks-modal" class="ss-close-modal" rel="nofollow"><i class="ss ss-close"></i></a>
</div>
<div class="ss-popup-content">
<div class="ss-copy-action">
<input type="text" readonly="readonly" value="https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/" class="ss-copy-action-field" />
<a href="#" class="ss-button" rel="nofollow">Copy<span class="ss-share-network-tooltip">Copied</span></a>
<i class="ss ss-copy"></i>
</div>
<div class="ss-powered-by">Powered by <a href="https://socialsnap.com/?utm_source=WordPress&amp;utm_medium=link&amp;utm_campaign=inthewild" target="_blank" rel="nofollow noopener"><i class="ss ss-socialsnap"></i>Social Snap</a></div>
</div>
</div>
</div>
<script type="text/javascript">
		document.addEventListener("DOMContentLoaded", function() {
			var if_ssb_exist = document.getElementsByClassName( "simplesocialbuttons" ).length > 0;
			if (if_ssb_exist) {
				var ssb_admin_ajax = 'https://www.middlewareinventory.com/wp-admin/admin-ajax.php';
				var ssb_post_id = 8276 ;
				var ssb_post_url = 'https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/';
				var ssb_alternate_post_url = 'https://airdata.gitlab.io/blog/blog/terraform-eks-spot-instances/';
				jQuery( document ).ready(function(){
				var is_ssb_used = jQuery('.simplesocialbuttons');
				if( is_ssb_used ) {

					var data = {
					'action': 'ssb_fetch_data',
					'postID': ssb_post_id
				};
					jQuery.post(ssb_admin_ajax, data, function(data, textStatus, xhr) {
						var array = JSON.parse(data);
						jQuery.each( array, function( index, value ){

							if( index == 'total' ){
								jQuery('.ssb_'+ index +'_counter').html(value + '<span>Shares</span>');
							}else{
								jQuery('.ssb_'+ index +'_counter').html(value);
							}
						});

					});
				}
				})

			//ssbPlugin.fetchFacebookShares();
			}
		});

		</script><script type='text/javascript'>function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script> 
<script type="text/javascript">

			var SocialSnapURL 				= window.location.href;
			var SocialSnapShareCacheExpired = 1;
				
			if ( -1 !== SocialSnapURL.indexOf('?ss_cache_refresh') ) {

				SocialSnapShareCacheExpired = true;

			} else {

				var SocialSnapServerTimestamp 	= 1657195246;
				var SocialSnapBrowserTimestamp 	= Date.now();

				if ( ! SocialSnapBrowserTimestamp ) {
					SocialSnapBrowserTimestamp = new Date().getTime();
				}

				SocialSnapBrowserTimestamp = Math.floor( SocialSnapBrowserTimestamp / 1000 );

				SocialSnapShareCacheExpired = SocialSnapShareCacheExpired && ( SocialSnapBrowserTimestamp - SocialSnapServerTimestamp < 60 );
			}

		</script>

<div id="cookie-notice" role="banner" class="cn-bottom bootstrap" style="color: #fff; background-color: #000;"><div class="cookie-notice-container"><span id="cn-notice-text">We use cookies to ensure that we give you the best experience on our website. The Cookies collected are used only to Show customized Ads. We Hope you are fine with it.</span><a href="#" id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button bootstrap button">Ok</a><a href="#" id="cn-refuse-cookie" data-cookie-set="refuse" class="cn-set-cookie cn-button bootstrap button">No</a><a href="../../cookie-policy/index.html" target="_blank" id="cn-more-info" class="cn-more-info cn-button bootstrap button">Privacy policy</a>
</div>
<div class="cookie-notice-revoke-container"><a href="#" class="cn-revoke-cookie cn-button bootstrap button">Revoke cookies</a></div>
</div>
</body>
</html>
