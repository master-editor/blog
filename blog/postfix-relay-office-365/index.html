<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">


<title>Postfix SMTP relay to Office 365 - Single and Multiple SMTP Servers</title>
<meta name="description" content="Postfix relay Office365 setup for Single and Multiple domains, Connecting to Office365 SMTP servers with Postfix. Postfix SMTP relay to Office365 and Send emails from Linux Centos or Ubuntu. Sender based relay with multiple domains in Postfix Office365 Postfix Office365 SMTP connector how to setup. SMTP relay Postfix" />
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<link rel="canonical" href="index.html" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Postfix SMTP relay to Office 365 - Single and Multiple SMTP Servers" />
<meta property="og:description" content="Postfix relay Office365 setup for Single and Multiple domains, Connecting to Office365 SMTP servers with Postfix. Postfix SMTP relay to Office365 and Send emails from Linux Centos or Ubuntu. Sender based relay with multiple domains in Postfix Office365 Postfix Office365 SMTP connector how to setup. SMTP relay Postfix" />
<meta property="og:url" content="https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="article:publisher" content="https://www.facebook.com/rumenlishkov" />
<meta property="article:published_time" content="2020-07-31T07:17:13+00:00" />
<meta property="article:modified_time" content="2022-06-16T10:07:37+00:00" />
<meta property="og:image" content="https://airdata.gitlab.io/blog/wp-content/uploads/2020/07/SMTP-Relay-0365.png" />
<meta property="og:image:width" content="612" />
<meta property="og:image:height" content="431" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@mwinventory" />
<meta name="twitter:site" content="@mwinventory" />
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://airdata.gitlab.io/blog/#organization","name":"Middleware Inventory","url":"https://www.middlewareinventory.com/","sameAs":["https://www.facebook.com/rumenlishkov","https://www.youtube.com/channel/UCRuqBFM6ioWwviNJkgOjeWw","https://twitter.com/mwinventory"],"logo":{"@type":"ImageObject","@id":"https://airdata.gitlab.io/blog/#logo","inLanguage":"en-US","url":"https://airdata.gitlab.io/blog/wp-content/uploads/2020/09/Screenshot-2020-09-18-at-3.49.40-AM.jpg","width":300,"height":107,"caption":"Middleware Inventory"},"image":{"@id":"https://airdata.gitlab.io/blog/#logo"}},{"@type":"WebSite","@id":"https://airdata.gitlab.io/blog/#website","url":"https://www.middlewareinventory.com/","name":"Devops Junction","description":"An inventory of [i]nformation, Middleware and much more.","publisher":{"@id":"https://airdata.gitlab.io/blog/#organization"},"potentialAction":[{"@type":"SearchAction","target":"https://www.middlewareinventory.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/#primaryimage","inLanguage":"en-US","url":"https://airdata.gitlab.io/blog/wp-content/uploads/2020/07/SMTP-Relay-0365.png","width":612,"height":431},{"@type":"WebPage","@id":"https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/#webpage","url":"https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/","name":"Postfix SMTP relay to Office 365 - Single and Multiple SMTP Servers","isPartOf":{"@id":"https://airdata.gitlab.io/blog/#website"},"primaryImageOfPage":{"@id":"https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/#primaryimage"},"datePublished":"2020-07-31T07:17:13+00:00","dateModified":"2022-06-16T10:07:37+00:00","description":"Postfix relay Office365 setup for Single and Multiple domains, Connecting to Office365 SMTP servers with Postfix. Postfix SMTP relay to Office365 and Send emails from Linux Centos or Ubuntu. Sender based relay with multiple domains in Postfix Office365 Postfix Office365 SMTP connector how to setup. SMTP relay Postfix","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/"]}]},{"@type":"Article","@id":"https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/#article","isPartOf":{"@id":"https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/#webpage"},"author":{"@id":"https://airdata.gitlab.io/blog/#/schema/person/050bf13e27b309d29d1bda45c4eb3147"},"headline":"Postfix SMTP relay to Office 365 &#8211; Single and Multiple SMTP Servers","datePublished":"2020-07-31T07:17:13+00:00","dateModified":"2022-06-16T10:07:37+00:00","mainEntityOfPage":{"@id":"https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/#webpage"},"commentCount":0,"publisher":{"@id":"https://airdata.gitlab.io/blog/#organization"},"image":{"@id":"https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/#primaryimage"},"articleSection":"Office365,Unix","inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/#respond"]}]},{"@type":"Person","@id":"https://airdata.gitlab.io/blog/#/schema/person/050bf13e27b309d29d1bda45c4eb3147","name":"Rumen Lishkov","image":{"@type":"ImageObject","@id":"https://airdata.gitlab.io/blog/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g","caption":"Rumen Lishkov"}}]}</script>

<link rel='dns-prefetch' href='https://js.stripe.com' />
<link rel='dns-prefetch' href='https://fonts.googleapis.com' />
<link rel='dns-prefetch' href='https://s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Feed" href="../../feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Comments Feed" href="../../comments/feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Postfix SMTP relay to Office 365 &#8211; Single and Multiple SMTP Servers Comments Feed" href="feed/index.rss" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GMY2GVPFFX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GMY2GVPFFX');
</script>

<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.middlewareinventory.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.5.6"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/404f7.css" media="all" />
<style id='ez-toc-inline-css' type='text/css'>div#ez-toc-container p.ez-toc-title {font-size: 120%;}div#ez-toc-container p.ez-toc-title {font-weight: 500;}div#ez-toc-container ul li {font-size: 95%;}div#ez-toc-container {width: 100%;}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/f854f.css" media="all" />
<link rel='stylesheet' id='poseidon-default-fonts-css' href='https://fonts.googleapis.com/css?family=Ubuntu%3A400%2C400italic%2C700%2C700italic%7CRaleway%3A400%2C700&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel="stylesheet" href="../../wp-content/cache/minify/88e5e.css" media="all" />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/www.middlewareinventory.com","hash_tracking":"false"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1058f.js"></script>
<script type='text/javascript' id='cookie-notice-front-js-extra'>
/* <![CDATA[ */
var cnArgs = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","hideEffect":"fade","onScroll":"no","onScrollOffset":"100","cookieName":"cookie_notice_accepted","cookieValue":"true","cookieTime":"2592000","cookiePath":"\/","cookieDomain":"","redirection":"","cache":"1","refuse":"yes","revoke_cookies":"0","revoke_cookies_opt":"automatic","secure":"1"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/545b0.js"></script>
<script type='text/javascript' id='email-subscribers-js-extra'>
/* <![CDATA[ */
var es_data = {"messages":{"es_empty_email_notice":"Please enter email address","es_rate_limit_notice":"You need to wait for sometime before subscribing again","es_single_optin_success_message":"Successfully Subscribed.","es_email_exists_notice":"Email Address already exists!","es_unexpected_error_notice":"Oops.. Unexpected error occurred.","es_invalid_email_notice":"Invalid email address","es_try_later_notice":"Please try after some time"},"es_ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1de0a.js"></script>
<script type='text/javascript' id='ssb-front-js-js-extra'>
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"3d8661396b"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/268e7.js"></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://airdata.gitlab.io/blog/wp-content/themes/poseidon/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<script type='text/javascript' id='poseidon-post-slider-js-extra'>
/* <![CDATA[ */
var poseidon_slider_params = {"animation":"slide","speed":"7000"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/51af3.js"></script>
<script type='text/javascript' id='eio-lazy-load-js-extra'>
/* <![CDATA[ */
var eio_lazy_vars = {"exactdn_domain":"","skip_autoscale":"0"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/28f5b.js"></script>
<link rel="https://api.w.org/" href="../../wp-json/index.json" /><link rel="alternate" type="application/json" href="../../wp-json/wp/v2/posts/5589.json" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php-rsd.xml" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.middlewareinventory.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 5.5.6" />
<link rel='shortlink' href='index.html' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-postfix-relay-office-365-.json" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-postfix-relay-office-365-&amp;format=xml.xml" />
<link href='https://fonts.googleapis.com/css?family=Strait:100,200,300,400,500,600,700,800,900&amp;subset=arabic,vietnamese,hebrew,thai,bengali,latin,latin-ext,cyrillic,cyrillic-ext,greek' rel='stylesheet' type='text/css'><style>a.idcore-button,a.idcore-button:visited{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:hover,a.idcore-button:focus{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:active{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}</style><script>var idcore_ajax_url = "https://www.middlewareinventory.com/wp-admin/admin-ajax.php";</script> <style media="screen">/*inline margin*/
	
	
	
	
	
	
			 /*margin-digbar*/

	
	
	
	
	   div[class*="simplesocialbuttons-float"].simplesocialbuttons.simplesocial-round-icon button{
	 margin: ;
   }
	
	
	
</style>

<meta property="og:title" content="Postfix SMTP relay to Office 365 &#8211; Single and Multiple SMTP Servers - Middleware Inventory" />
<meta property="og:description" content="Postfix is a powerful opensource mail server with a lot of customization options available built-in. I recently had a requirement to set up an Organization-wide mail server to perform SMTP relay to Office365 and allow our Java, JS, Python applications to send emails from different office365 email ids based on the Subject (or) the sender details.

Before we think about the" />
<meta property="og:url" content="https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="og:image" content="https://airdata.gitlab.io/blog/wp-content/uploads/2020/07/SMTP-Relay-0365.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Postfix is a powerful opensource mail server with a lot of customization options available built-in. I recently had a requirement to set up an Organization-wide mail server to perform SMTP relay to Office365 and allow our Java, JS, Python applications to send emails from different office365 email ids based on the Subject (or) the sender details.

Before we think about the" />
<meta name="twitter:title" content="Postfix SMTP relay to Office 365 &#8211; Single and Multiple SMTP Servers - Middleware Inventory" />
<meta property="twitter:image" content="https://airdata.gitlab.io/blog/wp-content/uploads/2020/07/SMTP-Relay-0365.png" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
<noscript><style>.lazyload[data-src]{display:none !important;}</style></noscript><style type="text/css" id="sns_global_styles">/* for mobile */
@media screen and (max-width: 480px) {
    #text-23 {
        display:none !important;
    }
	p,li
    {
      font-size: 20px !important;
      color: #333 !important;
      line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li a
    {
    	font-size: 20px !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  
  #afc_sidebar_4348 
{
  height: 8vh; 
  max-height: 8vh; 
  background-color: transparent;
}
}

/* for Desktop */
@media screen and (min-width: 500px) {
#afc_sidebar_4348 
{
  height: 10vh; 
  max-height: 10vh; 
  background-color: transparent;
}
  #text-23 {
        display:none !important;
    }
	p,li
    {
        font-size: 20px !important;
        color: #333 !important;
        line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  

}

.es_lablebox {
    padding-bottom: 3px;
    color: steelblue !important;
    font-weight: bold !important;
}
.widget-title span {
    line-height: 2.2;
    color: steelblue !important;
}
.sidey {
	padding: 0;
}
.sumome-contactform 
{
  display: none;
}
code { 
    font-family: courier;
    font-size: 18px;
    padding: 2px;
    background-color: #f1f1f1;
    /*box-shadow: 0 2px 4px 0 rgba(0,0,0,0.16),0 2px 10px 0 rgba(0,0,0,0.12)!important;*/
    
}

.syntaxhighlighter {
    font-size: 14px !important;
}

pre {
 font-family: Menlo, Monaco, Consolas, "Courier New", monospace !important;
}

.black-red-border
{
    border-left: 3px solid;
    background-color: black;
    color: ghostwhite;
    border-left-color: red;
} 
}

#wpdevar_comment_1 span
{
  font-family:  "Open Sans", Helvetica, Arial, sans-serif !important;
  font-size: 20px !important;
  color: #1495b5 !important;
}

#wpdevar_comment_1 
{
  margin-top: 50px;
  margin-bottom: 30px;
}

summary
{
 color: steelblue; 
}

blockquote
{
  border-left-color: #cc0f77 !important;
  border-left-width: 4px !important;
  border-left-style: solid !important;
  background-color: #f5f5f5 !important;
}

.rp4wp-related-post-image{ width: auto !important; }

.main-navigation-menu
{
  float: none !important;
}

.primary-navigation
{
  float: none !important
}

body,html{
  /* font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

.page-title, .entry-title, .site-title, .main-navigation-menu a, .widget-title
{
  /*font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

#postfollow {
  background: whitesmoke;
  padding-top: 5%;
  padding-bottom: 5%;
  padding-left: 2%;
}
div#ez-toc-container p.ez-toc-title {
    font-weight: bold;
    font-size: 24px !important;
}
div#ez-toc-container {
    margin-bottom: 15%;
}

</style><link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-180x180.png" />
<meta name="msapplication-TileImage" content="https://airdata.gitlab.io/blog/wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-270x270.png" />
<style type="text/css">article h3
{
    background-color: whitesmoke;
    color: black;
    padding-left: 1%;
    border-left: 10px solid black;
    font-weight: 400;
    font-size: 23px;
}
pre
{
  display: block; 
  overflow-x: auto; 
  padding-left: 2em;
  padding-top: 3em;
  padding-bottom: 3em;
  background: #eaeef3 none repeat scroll 0% 0%; 
  color: #00193a;
}
article h4
{
    font-weight: 400;
    font-size: 21px;
    color: #075888;
}
li {
    padding: 2px;
    margin-left: 2%;
}
</style>
<style type="text/css" id="wp-custom-css">.site-title
{
   font-size: 24px !important;
}		</style>
</head>
<body class="post-template-default single single-post postid-5589 single-format-standard wp-custom-logo cookies-not-set elementor-default">
<div id="page" class="hfeed site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<div id="header-top" class="header-bar-wrap"></div>
<header id="masthead" class="site-header clearfix" role="banner">
<div class="header-main container clearfix">
<div id="logo" class="site-branding clearfix">
<a href="../../index.html" class="custom-logo-link" rel="home"><img width="160" height="120" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 107'%3E%3C/svg%3E" class="custom-logo lazyload" alt="Middleware Inventory" data-src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" loading="lazy" /><noscript><img width="160" height="120" src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" class="custom-logo" alt="Middleware Inventory" data-eio="l" /></noscript></a>
<p class="site-title"></p>
</div>
<nav id="main-navigation" class="primary-navigation navigation clearfix" role="navigation">
<ul id="menu-primary-menu" class="main-navigation-menu"><li id="menu-item-172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-172"><a href="https://airdata.github.io/">About Me</a></li>
<li id="menu-item-3206" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-3206"><a href="../category/middleware/index.html">Middleware</a>
<ul class="sub-menu">
<li id="menu-item-1518" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1518"><a href="../category/weblogic/index.html">weblogic</a></li>
<li id="menu-item-3207" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3207"><a href="../category/was/index.html">WAS</a></li>
<li id="menu-item-3208" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3208"><a href="../category/websphere/index.html">Websphere</a></li>
<li id="menu-item-3209" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3209"><a href="../category/wlst/index.html">wlst</a></li>
<li id="menu-item-3210" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3210"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a></li>
<li id="menu-item-3211" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3211"><a href="../category/jms/index.html">JMS</a></li>
<li id="menu-item-3212" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3212"><a href="../category/activemq/index.html">ActiveMQ</a></li>
<li id="menu-item-3213" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3213"><a href="../category/troubleshooting/index.html">Troubleshooting</a></li>
<li id="menu-item-3214" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3214"><a href="../category/apache/index.html">Apache</a></li>
<li id="menu-item-3215" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3215"><a href="../category/best-practice/index.html">Best Practice</a></li>
<li id="menu-item-3222" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3222"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a></li>
</ul>
</li>
<li id="menu-item-3157" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3157"><a href="../../devops-junction/index.html">Devops</a>
<ul class="sub-menu">
<li id="menu-item-1513" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1513"><a href="../category/ansible/index.html">Ansible</a></li>
<li id="menu-item-3216" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3216"><a href="../category/aws/index.html">AWS</a></li>
<li id="menu-item-3217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3217"><a href="../category/docker/index.html">Docker</a></li>
<li id="menu-item-3218" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3218"><a href="../category/packer/index.html">Packer</a></li>
<li id="menu-item-3219" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3219"><a href="../category/splunk/index.html">Splunk</a></li>
<li id="menu-item-3220" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3220"><a href="../category/terraform/index.html">Terraform</a></li>
<li id="menu-item-3221" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3221"><a href="../category/vagrant/index.html">Vagrant</a></li>
<li id="menu-item-3223" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3223"><a href="../category/kubernetes/index.html">Kubernetes</a></li>
</ul>
</li>

<li id="menu-item-8821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8821"><a href="https://rumen.free.bg/#contact">Book a Consultation</a></li>
</ul> </nav>
</div>
</header>
<div id="content" class="site-content container clearfix">
<section id="primary" class="content-area">
<main id="main" class="site-main" role="main">

<article id="post-5589" class="post-5589 post type-post status-publish format-standard has-post-thumbnail hentry category-office365 category-unix wpautop">
<header class="entry-header">
<h1 class="entry-title">Postfix SMTP relay to Office 365 &#8211; Single and Multiple SMTP Servers</h1>
<div class="entry-meta"><span class="meta-date"> Updated on: <a href="index.html" title="12:47 pm" rel="bookmark"><time class="entry-date published updated" datetime="June 16, 2022">June 16, 2022</time></a></span><span class="meta-author"> <span class="author vcard"><a class="url fn n" href="../author/admin/index.html" title="View all posts by Rumen Lishkov" rel="author">Rumen Lishkov</a></span></span></div>
</header>
<div class="entry-content clearfix">
<div class="ss-inline-share-wrapper ss-left-inline-content ss-small-icons ss-with-spacing ss-rounded-icons">
<div class="ss-inline-share-content">
<ul class="ss-social-icons-container">
<li class="">
<a href="#" data-ss-ss-link="https://www.facebook.com/sharer.php?t=Postfix%20SMTP%20relay%20to%20Office%20365%20%E2%80%93%20Single%20and%20Multiple%20SMTP%20Servers&u=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fpostfix-relay-office-365%2F" class="ss-facebook-color" rel="nofollow" data-ss-ss-network-id="facebook" data-ss-ss-post-id="5589" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" data-ss-ss-type="share" data-has-api="true">
<span class="ss-share-network-content">
<i class="ss ss-facebook"></i>
<span class="ss-network-count">
0
</span>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://twitter.com/intent/tweet?text=Postfix+SMTP+relay+to+Office+365+%E2%80%93+Single+and+Multiple+SMTP+Servers&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fpostfix-relay-office-365%2F" class="ss-twitter-color" rel="nofollow" data-ss-ss-network-id="twitter" data-ss-ss-post-id="5589" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-twitter"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://www.linkedin.com/shareArticle?title=Postfix%20SMTP%20relay%20to%20Office%20365%20%E2%80%93%20Single%20and%20Multiple%20SMTP%20Servers&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fpostfix-relay-office-365%2F&mini=true" class="ss-linkedin-color" rel="nofollow" data-ss-ss-network-id="linkedin" data-ss-ss-post-id="5589" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-linkedin"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="mailto:?body=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fpostfix-relay-office-365%2F&subject=Postfix%20SMTP%20relay%20to%20Office%20365%20%E2%80%93%20Single%20and%20Multiple%20SMTP%20Servers" class="ss-envelope-color" rel="nofollow" data-ss-ss-network-id="envelope" data-ss-ss-post-id="5589" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-envelope"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="#" class="ss-copy-color" rel="nofollow" data-ss-ss-network-id="copy" data-ss-ss-post-id="5589" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-copy"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<p>Postfix is a powerful opensource mail server with a lot of customization options available built-in. I recently had a requirement to set up an Organization-wide mail server to perform SMTP relay to Office365 and allow our Java, JS, Python applications to send emails from different office365 email ids based on the Subject (or) the sender details.</p>
<p>Before we think about the multiple email IDs and sender-based relay in postfix. Let us cover the basic setup and send our test emails.</p>
<p>I am going to split this article into four parts or subtopics</p>
<ol>
<li>Configuring Postfix SMTP relay to Office 365 and testing it with Single email ID/Domain</li>
<li>Configuration Postfix SMTP relay for multiple domains and sender-based relay</li>
<li>Troubleshooting SMTP relay and Fixing Email Delivery Problems</li>
<li>Check your email Score (or) Spam test result</li>
</ol>
<p>Before we proceed with these three steps I would like to take you on a quick tour around the three different connection methodologies you can have with Office365. Knowing which one you are using would help you to fix the problems faster when you run into one.</p>
<p>&nbsp;</p>
<div id="ez-toc-container" class="counter-hierarchy counter-decimal ez-toc-grey">
<div class="ez-toc-title-container">
<p class="ez-toc-title">Table of Contents</p>
<span class="ez-toc-title-toggle"><a class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle"><i class="ez-toc-glyphicon ez-toc-icon-toggle"></i></a></span></div>
<nav><ul class="ez-toc-list"><li><a href="#Three_types_of_Integration_supported_by_Office365" title="Three types of Integration supported by Office365.">Three types of Integration supported by Office365.</a><ul><li><a href="#1_SMTP_client_submission" title="1. SMTP client submission
">1. SMTP client submission
</a></li><li><a href="#2_Direct_send" title="2. Direct send">2. Direct send</a></li><li><a href="#3_Office_365_SMTP_relay_Discussed_in_this_Post" title="3. Office 365 SMTP relay ( Discussed in this Post )
">3. Office 365 SMTP relay ( Discussed in this Post )
</a></li></ul></li><li><a href="#Simple_SMTP_relay_with_Postfix_Office365" title="Simple SMTP relay with Postfix Office365">Simple SMTP relay with Postfix Office365</a><ul><li><a href="#Installing_postfix_mail_server" title="Installing postfix mail server">Installing postfix mail server</a></li><li><a href="#Update_the_Postfix_configuration" title="Update the Postfix configuration">Update the Postfix configuration</a></li><li><a href="#Creating_Connector_in_Office365" title="Creating  Connector in Office365">Creating  Connector in Office365</a></li><li><a href="#Updating_SPF_record_with_your_public_IP_to_avoid_your_email_ending_as_SPAM" title="Updating SPF record with your public IP ( to avoid your email ending as SPAM )">Updating SPF record with your public IP ( to avoid your email ending as SPAM )</a></li><li><a href="#Whitelist_your_Server_URL_in_the_office365" title="Whitelist your Server URL in the office365">Whitelist your Server URL in the office365</a></li><li><a href="#Restart_Postfix_and_Send_some_email_to_test_it" title="Restart Postfix and Send some email to test it">Restart Postfix and Send some email to test it</a></li></ul></li><li><a href="#Multiple_Domains_and_Sender_Based_Relay_PostFIX_Office365" title="Multiple Domains and Sender Based Relay PostFIX  Office365">Multiple Domains and Sender Based Relay PostFIX  Office365</a><ul><li><a href="#Update_the_maincf_configuration_of_Postfix_to_Support_Sender_based_relay" title="Update the main.cf configuration of Postfix to Support Sender based relay">Update the main.cf configuration of Postfix to Support Sender based relay</a></li><li><a href="#Create_a_relay_by_sender_file_for_Postfix_and_Keep_the_Mail_Server_MX_details" title="Create a relay_by_sender file for Postfix and Keep the Mail Server (MX) details">Create a relay_by_sender file for Postfix and Keep the Mail Server (MX) details</a></li><li><a href="#Create_the_Sasl_Passwd_maps_file_with_relays_and_credentials" title="Create the Sasl_Passwd_maps file with relays and credentials">Create the Sasl_Passwd_maps file with relays and credentials</a></li><li><a href="#Reload_or_the_Restart_the_Postfix_server_and_test_the_relays" title="Reload or the Restart the Postfix server and test the relays">Reload or the Restart the Postfix server and test the relays</a></li></ul></li><li><a href="#Troubleshooting_SMTP_relay_issues" title="Troubleshooting SMTP relay issues">Troubleshooting SMTP relay issues</a></li><li><a href="#Testing_the_Score_of_your_SMTP_setup_or_Spam_Test_Result" title="Testing the Score of your SMTP setup or Spam Test Result">Testing the Score of your SMTP setup or Spam Test Result</a></li></ul></nav></div>
<h2><span class="ez-toc-section" id="Three_types_of_Integration_supported_by_Office365"><span style="color: #003366;">Three types of Integration supported by <span style="color: #e31974;">Office365</span>.</span></span></h2>
<p>If you browse through the internet you would find numerous articles with different methods to set up SMTP relay from POSTFIX or to connect your application or device and relay your mails. So I am listing out the three different types of integrations we can do with Office365 to send emails.</p>
<h3><span class="ez-toc-section" id="1_SMTP_client_submission"><strong>1. SMTP client submission<br />
</strong></span></h3>
<p>The client should be connected to the Server &#8220;smtp.office365.com&#8221; on port 587 and in this approach, we can send emails to internal and external recipients</p>
<figure style="width: 611px" class="wp-caption alignnone"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 611 420'%3E%3C/svg%3E" alt="Shows how a multifunction printer connects to Microsoft 365 or Office 365 using SMTP client submission." width="611" height="420" data-linktype="relative-path" data-src="https://docs.microsoft.com/en-us/exchange/exchangeonline/media/d5c5a7fa-aba4-4bf4-976f-4c7128fcab2d.png" loading="lazy" class="lazyload" /><noscript><img src="https://docs.microsoft.com/en-us/exchange/exchangeonline/media/d5c5a7fa-aba4-4bf4-976f-4c7128fcab2d.png" alt="Shows how a multifunction printer connects to Microsoft 365 or Office 365 using SMTP client submission." width="611" height="420" data-linktype="relative-path" data-eio="l" /></noscript><figcaption class="wp-caption-text">Image Credits to Microsoft</figcaption></figure>
<h3><span class="ez-toc-section" id="2_Direct_send"><strong>2. Direct send</strong></span></h3>
<p>In this method, we are connected to our Organization Mail Server hostname (MX) whose name ends with &#8220;mail.protection.outlook.com&#8221;</p>
<p>In my case, <span id="lblResult"><a href="https://mxtoolbox.com/SuperTool.aspx?action=mx:gritfy.com#">gritfy-com.mail.protection.outlook.com</a></span> is my mail server. to find out your organization&#8217;s mail server MX record use <a href="https://mxtoolbox.com/">https://mxtoolbox.com/</a></p>
<p>With this method, email cannot be sent to recipients outside your organization</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Shows how a multifunction printer uses your Microsoft 365 or Office 365 MX endpoint to send email directly to recipients in your organization only." data-linktype="relative-path" data-src="https://docs.microsoft.com/en-us/exchange/exchangeonline/media/cb07aae7-ca31-43a7-a468-74c293b37a66.png" loading="lazy" class="lazyload" /><noscript><img src="https://docs.microsoft.com/en-us/exchange/exchangeonline/media/cb07aae7-ca31-43a7-a468-74c293b37a66.png" alt="Shows how a multifunction printer uses your Microsoft 365 or Office 365 MX endpoint to send email directly to recipients in your organization only." data-linktype="relative-path" data-eio="l" /></noscript></p>
<h3><span class="ez-toc-section" id="3_Office_365_SMTP_relay_Discussed_in_this_Post"><strong>3. Office 365 SMTP relay ( Discussed in this Post )<br />
</strong></span></h3>
<p>In this method, we are connected to our Organization Mail Server hostname (MX) whose name ends with &#8220;mail.protection.outlook.com&#8221;</p>
<p>There is a connector set up in Office 365 for emails sent from your organization&#8217;s mail server. In our case it is postfix.</p>
<p>In this method, we can send mail to external recipients as well as internal organization.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Shows how a multifunction printer connects to Microsoft 365 or Office 365 using SMTP relay." data-linktype="relative-path" data-src="https://docs.microsoft.com/en-us/exchange/exchangeonline/media/258cb8b1-752d-47b8-91e9-a0176dfcfad4.png" loading="lazy" class="lazyload" /><noscript><img src="https://docs.microsoft.com/en-us/exchange/exchangeonline/media/258cb8b1-752d-47b8-91e9-a0176dfcfad4.png" alt="Shows how a multifunction printer connects to Microsoft 365 or Office 365 using SMTP relay." data-linktype="relative-path" data-eio="l" /></noscript></p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2><span class="ez-toc-section" id="Simple_SMTP_relay_with_Postfix_Office365"><span style="color: #003366;">Simple <span style="color: #e31974;">SMTP relay</span> with Postfix Office365</span></span></h2>
<p>As shown in the preceding method 3, we are going to set up an SMTP relay with Connectors in Office365 and Postfix to send emails to internal and external recipients.</p>
<p>Let us start from installing the postfix mail server in your Linux host.  you have to choose your appropriate package manager like <code>yum</code> or <code>apt-get</code></p>
<h3><span class="ez-toc-section" id="Installing_postfix_mail_server">Installing postfix mail server</span></h3>
<p>In my case, it is CentOS so I am going with yum</p>
<pre>yum install postfix</pre>
<h3></h3>
<h3><span class="ez-toc-section" id="Update_the_Postfix_configuration">Update the Postfix configuration</span></h3>
<p>If you goto the <code>/etc/postfix</code> directory and list the files, you would find a set of configuration files already present and we are going to update some of the configurations to make the SMTP relay work through the office365</p>
<h4><strong>Updating Relay Host in postfix configuration</strong></h4>
<p>the first file we are going to make changes is <code>main.cf</code> file and you have to find and update the parameter named <code>relay_host=</code> if it is commented, Uncomment it</p>
<p>You are going to use your Organization MX Server endpoint in there with the port number 25, In my case it is</p>
<pre>relayhost = [gritfy-com.mail.protection.outlook.com]:25</pre>
<h4></h4>
<h4><strong>Updating SMTP Outbound Relay configuration</strong></h4>
<p>In the same <code>main.cf</code> file add the following lines at the end of the file, The configuration is to enable a Security using sasl_passwd file where we would be defining our email and password. We can also configure the outbound mail to be encrypted with TLS using <code>smtp_tls_security_level</code> option but in this post, we are going without TLS</p>
<pre>smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd
smtp_sasl_security_options = noanonymous	 	 
smtp_tls_security_level = may	 	 
header_size_limit = 409600</pre>
<p>So we have defined the <code>password_maps</code> file within the main.cf file but have not created it yet. so our next step is to create one and it should be on the <code>/etc/postfix</code> directory with the name <code>sasl_passwd</code></p>
<p>&nbsp;</p>
<h4><strong>Creating sasl_passwd file with Authentication info</strong></h4>
<p>Create a new file named sasl_passwd under /etc/postfix and enter your Office365 account details.</p>
<p>It is recommended that this account does not have admin privileges as the <code>sasl_passwd</code> file would contain this password as cleartext.</p>
<p>Here is the content of my sasl_passwd file for your reference.</p>
<pre>[gritfy-com.mail.protection.outlook.com]:25 <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="7a0f091f08141b171f3a1d08130e1c0354191517">[email&#160;protected]</a>:SecurePassword</pre>
<p>Postfix reads the login info from the Database file so it is necessary that we should convert this file to a *.db format. In order to do that</p>
<p>you can use the command</p>
<pre>postmap /etc/postfix/sasl_passwd</pre>
<p>upon the successful execution of this command, you can see a new file would be created in the same name with <code>.db</code> extension</p>
<p>By default, these files would have the global read permissions which let all logged-in user to the server read the files. to prevent it, you can consider setting up some file permissions like shown below. this would enable only owners to read and write the file and restrict all others</p>
<pre>sudo chmod 0600 /etc/postfix/sasl_passwd /etc/postfix/sasl_passwd.db</pre>
<p>Now we have configured the postfix mail server but since we are using the SMTP relay method of Office365 integration, we need to create our Office365 connector which requires Office365 Admin privileges.</p>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h3><span class="ez-toc-section" id="Creating_Connector_in_Office365">Creating  Connector in Office365</span></h3>
<p>To create a connector in Office365 you need to have Global Admin or Exchange Admin role.</p>
<p>Login to Office365 Exchange Admin page and under <code>mail flow</code> option you would find an option named <code>connectors</code> click on it to create a new connector</p>
<p><a href="../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM.png"><img class="alignnone size-full wp-image-5595 lazyload" src="../../wp-content/ewww/lazy/placeholder-1920x1263.png" alt="" width="2494" height="1640" data-src="../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM.png" loading="lazy" data-srcset="../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM.png 2494w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM-300x197.png 300w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM-768x505.png 768w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM-1024x673.png 1024w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM-120x80.png 120w" data-sizes="auto" /><noscript><img class="alignnone size-full wp-image-5595" src="../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM.png" alt="" width="2494" height="1640" srcset="../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM.png 2494w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM-300x197.png 300w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM-768x505.png 768w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM-1024x673.png 1024w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-27-at-3.59.53-AM-120x80.png 120w" sizes="(max-width: 2494px) 100vw, 2494px" data-eio="l" /></noscript></a></p>
<p>Once you have clicked on the Connectors, you would be prompted few details where you need to either choose the Connector to allow the clients based on the Certificate or by the IP.</p>
<p>In this post, we are going with the IP method where Office365 Connector would allow the client applications like Postfix to send emails when they are from a specific public IP address.</p>
<p>So if you are implementing this in your Organization it is advised that you have a static public IP enabled for your Linux server. for AWS users it is even simple, as you can allocate an Elastic IP for your instance where you are setting this up.</p>
<p>Take a look at this Screen record of me doing the same setup.</p>
<p><a href="../../wp-content/uploads/2020/07/ezgif.com-optimize.gif"><img class="alignnone size-full wp-image-5596 lazyload" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1396 710'%3E%3C/svg%3E" alt="Office 365 Relay Postfix" width="1396" height="710" data-src="../../wp-content/uploads/2020/07/ezgif.com-optimize.gif" loading="lazy" /><noscript><img class="alignnone size-full wp-image-5596" src="../../wp-content/uploads/2020/07/ezgif.com-optimize.gif" alt="Office 365 Relay Postfix" width="1396" height="710" data-eio="l" /></noscript></a></p>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Updating_SPF_record_with_your_public_IP_to_avoid_your_email_ending_as_SPAM">Updating SPF record with your public IP ( to avoid your email ending as SPAM )</span></h3>
<p>All the steps we have done till now is enough to get your email going out from Postfix relay.</p>
<p>We should do one more thing to save our emails getting ended up into the SPAM folder.</p>
<p>If you are in the AWS world, you can do it easily in Route53. if you are in public providers like GoDaddy and Bluehost you need to find their own technical documentation on how to add this new SPF record.</p>
<p>Basically our objective here is to add our public ipv4 IP to the SPF record. It would look something like this, you can keep adding many ipv4 records as you add more</p>
<pre class="alert alert-success">v=spf1 ip4:49.205.79.85 include:spf.protection.outlook.com -all</pre>
<p>To create SPF records in the right syntax you can use <a href="https://mxtoolbox.com/SPFRecordGenerator.aspx">SPF record generator</a></p>
<p>To validate your SPF record you can use this <a href="https://mxtoolbox.com/SuperTool.aspx">mxtoolbox supertool</a></p>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Whitelist_your_Server_URL_in_the_office365">Whitelist your Server URL in the office365</span></h3>
<p>Also, you need to whitelist your Server IP for the Office365 to accept your connection request on port 25 and to honour your mail submission</p>
<p>Exchange Admin Center -&gt; Connection Filter -&gt; Add Allowed IP Address</p>
<p><a href="../../wp-content/uploads/2020/07/Office365-ip-1.gif"><img class="alignnone size-full wp-image-5603 lazyload" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1610 816'%3E%3C/svg%3E" alt="" width="1610" height="816" data-src="../../wp-content/uploads/2020/07/Office365-ip-1.gif" loading="lazy" /><noscript><img class="alignnone size-full wp-image-5603" src="../../wp-content/uploads/2020/07/Office365-ip-1.gif" alt="" width="1610" height="816" data-eio="l" /></noscript></a></p>
<p>If your IP is not whitelisted, You might see some errors like given below.</p>
<pre>Jul 30 22:35:57 mwiapp01 postfix/smtp[18821]: AC8A74078131: 
to=&lt;<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="295a46444c4c44484045694e44484045074a4644">[email&#160;protected]</a>&gt;, 
relay=gritfy-com.mail.protection.outlook.com[104.47.100.36]:25, 
delay=5.9, delays=0.09/0.05/4.1/1.6, dsn=5.7.750, 
status=bounced (host gritfy-com.mail.protection.outlook.com[104.47.100.36] 
said: 550 5.7.750 Service unavailable. 
Client blocked from sending from unregistered domains. 
For more information please go to http://go.microsoft.com/fwlink/?LinkId=526653. AS(800051) 
[MA1IND01FT006.eop-IND01.prod.protection.outlook.com] (in reply to end of DATA command))</pre>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Restart_Postfix_and_Send_some_email_to_test_it">Restart Postfix and Send some email to test it</span></h3>
<p>Now go back to the server and restart your postfix using your <code>systemctl</code> or <code>service</code> command and after validating the services are started. you can send yourself a test email to validate your setup</p>
<pre>echo "Some Email to Test"|mailx -s "Test Email" -r <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="b8cdcbddcad6d9d5ddf8dfcad1ccdec196dbd7d5">[email&#160;protected]</a> <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="0e7d61636b6b636f67624e69636f6762206d6163">[email&#160;protected]</a></pre>
<p>If everything went well you should see your mail <code>status=sent</code> in your maillog usually located in <code>/var/log/maillog</code></p>
<pre>Jul 30 22:44:32 mwiapp01 postfix/smtp[19253]: 60DAF4078131: 
to=&lt;<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="0b7864666e6e666a62674b6c666a626725686466">[email&#160;protected]</a>&gt;, 
relay=gritfy-com.mail.protection.outlook.com[104.47.100.36]:25, 
delay=7.2, delays=0.05/0.03/4/3.1, dsn=2.6.0, 
status=sent (250 2.6.0 &lt;5f234d49.DY75T7s4TYaD7ECn%<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="51242234233f303c34113623382537287f323e3c">[email&#160;protected]</a>&gt; 
[InternalId=23136988825661, Hostname=MA1PR01MB3468.INDPRD01.PROD.OUTLOOK.COM] 8682 bytes in 0.311, 27.186 KB/sec Queued mail for delivery)
Jul 30 22:44:32 mwiapp01 postfix/qmgr[3774]: 60DAF4078131: removed</pre>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Multiple_Domains_and_Sender_Based_Relay_PostFIX_Office365"><span style="color: #003366;">Multiple Domains and <span style="color: #e31974;">Sender Based Relay</span> PostFIX  Office365</span></span></h2>
<p>You can have more than one relays in Postfix and configure postfix to choose the relay configuration and credentials based on the sender email ID</p>
<p>For example, If you want to send emails from two different users on the same domain you can do that</p>
<pre><a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="8ffafceafde1eee2eabecfe8fde6fbe9f6a1ece0e2">[email&#160;protected]</a>
<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="f98c8a9c8b9798949ccbb99e8b908d9f80d79a9694">[email&#160;protected]</a></pre>
<p>or if you want to send emails from two different domains and email IDs you can do that too with postfix</p>
<pre><a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="196c6a7c6b7778747c597e6b706d7f60377a7674">[email&#160;protected]</a>
<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="196c6a7c6b7778747c5974707d7d756e786b7c70776f7c776d766b60377a7674">[email&#160;protected]</a></pre>
<p>&nbsp;</p>
<p>So How to achieve sender based SMTP relay in postfix</p>
<p>If you are trying to use two different Office365 accounts you need to do all the same steps we did earlier, Since this post is about Office365 and postfix let me presume that the other account hosted by Office365 too.</p>
<p>So you need to redo these steps on the other Email Domain as well. in my case it is <code>middlewareinventory.com</code> as I have already done these steps for <code>grify.com</code></p>
<ol>
<li>Create a Connector in Corresponding Office365 and allow the IP of your Server</li>
<li>Whitelist your IP in Exchange Connection Filter</li>
<li>Update your SPF record and add your Server IP where your Postfix is running</li>
</ol>
<p>I presume that you have done these steps flawlessly Let us skip to the postfix configuration section</p>
<h3><span class="ez-toc-section" id="Update_the_maincf_configuration_of_Postfix_to_Support_Sender_based_relay">Update the main.cf configuration of Postfix to Support Sender based relay</span></h3>
<p>If you are following along from the Single SMTP relay and to this multiple smtp relay you need to update few values, If you are directly setting up sender based relay you can just copy and paste these values in your <code>/etc/postfix/main.cf</code> file at the bottom</p>
<pre>smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd_maps
smtp_sasl_security_options = noanonymous
smtp_tls_security_level = may
header_size_limit = 4096000
inet_protocols = all
smtp_sender_dependent_authentication = yes
sender_dependent_relayhost_maps = hash:/etc/postfix/relay_by_sender</pre>
<p>If you look at the configuration there are two files (maps) we need to create and place it on the server. First, let us create the <code>/etc/postfix/relay_by_sender</code> file which is needed for the sender dependent relay in Postfix</p>
<h3><span class="ez-toc-section" id="Create_a_relay_by_sender_file_for_Postfix_and_Keep_the_Mail_Server_MX_details">Create a relay_by_sender file for Postfix and Keep the Mail Server (MX) details</span></h3>
<p>Within the <code>relay_by_sender</code> file we need to paste the following content. Make sure you update these values with your mail server smart host (mail server) details.</p>
<pre><a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="364345534458575b537651445f42504f1855595b">[email&#160;protected]</a> [gritfy-com.mail.protection.outlook.com]:25
<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="b8cdcbddcad6d9d5ddf8dcddced7c8cbd2cdd6dbccd1d7d696dbd7d5">[email&#160;protected]</a> [devopsjunction.mail.protection.outlook.com]:25</pre>
<p>Once you have saved the file in <code>/etc/postfix/relay_by_sender</code> now you need to create a DB file for postfix to use it. using the postmap command</p>
<pre>postmap /etc/postfix/relay_by_sender</pre>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h3><span class="ez-toc-section" id="Create_the_Sasl_Passwd_maps_file_with_relays_and_credentials">Create the Sasl_Passwd_maps file with relays and credentials</span></h3>
<p>Now we need to provide credentials for both of these relays we have created. so create a file under <code>/etc/postfix</code> with the name <code>sasl_passwd_maps</code></p>
<pre>[gritfy-com.mail.protection.outlook.com]:25 <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="0a7f796f78646b676f4a6d78637e6c7324696567">[email&#160;protected]</a>:MysecretPassword
[devopsjunction.mail.protection.outlook.com]:25 <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="72070117001c131f17321617041d020118071c11061b1d1c5c111d1f">[email&#160;protected]</a>:Password</pre>
<p>and just like you did earlier you have to create the db file using postmap</p>
<pre>postmap /etc/postfix/sasl_passwd_maps</pre>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Reload_or_the_Restart_the_Postfix_server_and_test_the_relays">Reload or the Restart the Postfix server and test the relays</span></h3>
<p>Now you have made necessary changes for your sender based relays to work. So go ahead and restart/reload your postfix server</p>
<pre>service postfix reload(or)
service postfix restart</pre>
<p>Send some test emails to validate if the mails are passing through the right relays</p>
<p>To test the first sender with gritfy.com. Mention the sender address with <code>-r</code> while sending your email.</p>
<pre>echo "Some Email to Test"|mailx -s "Test Email" -r <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="c6b3b5a3b4a8a7aba386a1b4afb2a0bfe8a5a9ab">[email&#160;protected]</a> <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="86f5e9ebe3e9e8e3c6f5e9ebe3e5e9ebf6e7e8ffa8e5e9eb">[email&#160;protected]</a></pre>
<p>To test the second sender with devopsjunction.com, update the sender address after <code>-r</code> and hit it</p>
<pre>echo "Some Email to Test"|mailx -s "Test Email" -r <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="760305130418171b13361213001906051c031815021f19185815191b">[email&#160;protected]</a> <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="1e6d71737b71707b5e6d71737b7d71736e7f7067307d7173">[email&#160;protected]</a></pre>
<p>to know which relay the email is going through and to see if it has been sent to the recipient or not. use the maillog usually located at <code>/var/log/maillog</code></p>
<pre>Jul 31 00:58:35 mwiapp01 postfix/smtp[26151]: 28D5A4078131: 
to=&lt;<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="a3d0cccec6cccdc6e3d0cccec6c0ccced3c2cdda8dc0ccce">[email&#160;protected]</a>&gt;, 
<span style="color: #993300;">relay=gritfy-com.mail.protection.outlook.com[104.47.100.36]:25</span>, 
delay=7.8, delays=0.06/0.05/4.2/3.5, dsn=2.6.0, 
<span style="color: #993300;">status=sent</span> (250 2.6.0 &lt;5f236cb4.kaTYiINfdbNN2Gyr%<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="176264726579767a725770657e63716e3974787a">[email&#160;protected]</a>&gt; [InternalId=22905060593379, Hostname=MAXPR01MB4031.INDPRD01.PROD.OUTLOOK.COM] 8684 bytes in 0.610, 13.883 KB/sec Queued mail for delivery)
Jul 31 00:58:35 mwiapp01 postfix/qmgr[25474]: 28D5A4078131: removed</pre>
<p>So we have successfully testing Single and Multiple Sender Relay with Office365 and Postfix</p>
<p>Now I want to give a few links for you to help you with your SMTP relay troubleshooting and to fix your setup issues.</p>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2><span class="ez-toc-section" id="Troubleshooting_SMTP_relay_issues"><span style="color: #003366;"><span style="color: #e31974;">Troubleshooting</span> SMTP relay issues</span></span></h2>
<p>There are few errors I have faced during the implementation of this setup and I found some articles on the internet to help me. I am listing them here for your reference.</p>
<p>This type of SMTP relay is little complex but highly customizable and programmable and since you are connecting directly to MX server or Smart Host of Office365. There are lot of restrictions to identify and to ensure that you are not a Spammer.</p>
<p>Like IP restrictions and blocks etc and the other issue could be SPF and IP whitelisting. So make sure you do everything discussed in this post without missing still if you are having issues, here are few links I can refer to you</p>
<ol>
<li> <a href="https://docs.microsoft.com/en-us/exchange/mail-flow-best-practices/fix-issues-with-printers-scanners-and-lob-applications-that-send-email-using-off">Microsoft article on Troubleshooting the SMTP relay</a></li>
<li> <a href="https://bobcares.com/blog/office-365-relay-access-denied-error/">Five possible root causes for Relay access denied and how to fix it</a></li>
<li> <a href="https://mxtoolbox.com/blacklists.aspx">IP blacklist checker and Email Delivery Problem finder</a></li>
</ol>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Testing_the_Score_of_your_SMTP_setup_or_Spam_Test_Result">Testing the Score of your SMTP setup or Spam Test Result</span></h2>
<p>I highly recommend testing your SMTP setup by sending email to the dynamic email ID generated by <a href="https://www.mail-tester.com/">https://www.mail-tester.com/</a></p>
<p>Visit the web page and copy the dynamic email ID shown on the screen and once the email is sent. Check your score. It would list out your configuration issues and Spammyness of your email with possible fixes</p>
<p><a href="../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM.png"><img class="alignnone size-full wp-image-5606 lazyload" src="../../wp-content/ewww/lazy/placeholder-1920x1621.png" alt="Postfix Office365 relay" width="2322" height="1960" data-src="../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM.png" loading="lazy" data-srcset="../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM.png 2322w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM-300x253.png 300w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM-768x648.png 768w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM-1024x864.png 1024w" data-sizes="auto" /><noscript><img class="alignnone size-full wp-image-5606" src="../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM.png" alt="Postfix Office365 relay" width="2322" height="1960" srcset="../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM.png 2322w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM-300x253.png 300w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM-768x648.png 768w, ../../wp-content/uploads/2020/07/Screenshot-2020-07-31-at-10.44.03-AM-1024x864.png 1024w" sizes="(max-width: 2322px) 100vw, 2322px" data-eio="l" /></noscript></a></p>
<p>&nbsp;</p>
<p>I have prepared this article in a hope that it serves as a Single page of reference when you want to set up Postfix Office365 SMTP relay and troubleshoot it.  Hope it helps.</p>
<p>Ask me questions using comments</p>
<p>Cheers<br />
Rumen Lishkov (சரவணன் அ க)</p>
<div id="postfollow">
<a href='https://ko-fi.com/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==' border='0' alt='Buy Me a Coffee at ko-fi.com' data-src="https://az743702.vo.msecnd.net/cdn/kofi3.png?v=2" loading="lazy" class="lazyload" /><noscript><img height='46' style='border:0px;height:46px;width: 186px' src='https://az743702.vo.msecnd.net/cdn/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' data-eio="l" /></noscript></a>
<p>Follow us on<a href="https://www.facebook.com/rumenlishkov">Facebook</a> or<a href="https://www.twitter.com/mwinventory">Twitter</a>
</br>
For more practical videos and tutorials. <a href="https://www.youtube.com/kiss2mark">Subscribe to our channel</a>
</br>
Find me on Linkedin <a href="https://www.linkedin.com/in/rumen-lishkov/">My Profile</a>
</br>
</i>For any Consultation or to hire us <a href="../../cdn-cgi/l/email-protection.html#c5ada0a9a9aa85a2b7acb1a3bceba6aaa8"> <span class="__cf_email__" data-cfemail="b0d8d5dcdcdff0d7c2d9c4d6c99ed3dfdd">[email&#160;protected]</span></a>
</br>
If you like this article. Show your Support! <a href="https://ko-fi.com/middlewareinventory">Buy me a Coffee.</a>
</br>
</p>
<p style="color: palevioletred !important;">Signup for Exclusive "Subscriber-only" Content</p>
<div class="emaillist">
<form action="#" method="post" class="es_subscription_form es_shortcode_form" id="es_subscription_form_1657191149" data-source="ig-es">
<div class="es-field-wrap"><label>Name*<br /><input type="text" name="name" class="ig_es_form_field_name" placeholder="" value="" required="required" /></label></div><div class="es-field-wrap"><label>Email*<br /><input class="es_required_field es_txt_email ig_es_form_field_email" type="email" name="email" value="" placeholder="" required="required" /></label></div><input type="hidden" name="lists[]" value="1" /><input type="hidden" name="form_id" value="3" />
<input type="hidden" name="es_email_page" value="5589" />
<input type="hidden" name="es_email_page_url" value="https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" />
<input type="hidden" name="status" value="Unconfirmed" />
<input type="hidden" name="es-subscribe" id="es-subscribe" value="915ddf1a10" />
<label style="position:absolute;top:-99999px;left:-99999px;z-index:-99;"><input type="email" name="es_hp_email" class="es_required_field" tabindex="-1" autocomplete="-1" value="" /></label>
<input type="submit" name="submit" class="es_subscription_form_submit es_submit_button es_textbox_button" id="es_subscription_form_submit_1657191149" value="Subscribe" />
<span class="es_spinner_image" id="spinner-image"><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Loading" data-src="../../wp-content/plugins/email-subscribers/lite/public/images/spinner.gif" loading="lazy" class="lazyload" /><noscript><img src="../../wp-content/plugins/email-subscribers/lite/public/images/spinner.gif" alt="Loading" data-eio="l" /></noscript></span>
</form>
<span class="es_subscription_message" id="es_subscription_message_1657191149"></span>
</div>
</div>
<hr>
<div class='rp4wp-related-posts'>
<h3>More from Middleware Inventory</h3>
<ul>
<li><div class='rp4wp-related-post-image'>
<a href='../ansible-lineinfile-multiple-lines-replace-multiple-lines/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="ansible lineinfile multiple lines" data-src="../../wp-content/uploads/2019/03/Screen-Shot-2019-03-24-at-2.27.35-PM-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/03/Screen-Shot-2019-03-24-at-2.27.35-PM-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="ansible lineinfile multiple lines" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../ansible-lineinfile-multiple-lines-replace-multiple-lines/index.html'>Ansible lineinfile multiple lines - Replace multiple Lines | Devops Junction</a><p>In this post, we are going to see how to use Ansible lineinfile module to replace multiple Lines at the same time. How to use Multiple Regular Expressions or Regex at the same time. How to Match Multiple lines. For this example, we are going to take apache httpd.conf file&hellip;</p></div>
</li>
</ul>
</div>
</div>
<footer class="entry-footer">
<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="../traefik-docker/index.html" rel="prev"><span class="screen-reader-text">Previous Post:</span>Traefik Docker Example and Introduction</a></div><div class="nav-next"><a href="../aws-route53-ansible/index.html" rel="next"><span class="screen-reader-text">Next Post:</span>Ansible Route53 Examples &#8211; read add remove update DNS records</a></div></div>
</nav>
</footer>
</article>
<div id="disqus_thread"></div>
</main>
</section>
<section id="secondary" class="sidebar widget-area clearfix" role="complementary">
<aside id="custom_html-18" class="widget_text widget widget_custom_html clearfix"><div class="textwidget custom-html-widget"><script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3398911159151128" crossorigin="anonymous"></script>


<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div></aside><aside id="categories-8" class="widget widget_categories clearfix"><div class="widget-header"><h3 class="widget-title">Categories</h3></div>
<ul>
<li class="cat-item cat-item-61"><a href="../category/activemq/index.html">ActiveMQ</a> (4)
</li>
<li class="cat-item cat-item-98"><a href="../category/ansible/index.html">Ansible</a> (65)
</li>
<li class="cat-item cat-item-10"><a href="../category/apache/index.html">Apache</a> (8)
</li>
<li class="cat-item cat-item-234"><a href="../category/aws/index.html">AWS</a> (28)
</li>
<li class="cat-item cat-item-452"><a href="../category/azure/index.html">Azure</a> (1)
</li>
<li class="cat-item cat-item-8"><a href="../category/best-practice/index.html">Best Practice</a> (5)
</li>
<li class="cat-item cat-item-390"><a href="../category/bitbucket/index.html">BitBucket</a> (1)
</li>
<li class="cat-item cat-item-426"><a href="../category/boto/index.html">Boto</a> (1)
</li>
<li class="cat-item cat-item-399"><a href="../category/cloud/index.html" title="Cloud is not only a concept but also a practice of using a network of remote servers hosted on the Internet to store, manage, and process data.">Cloud</a> (1)
</li>
<li class="cat-item cat-item-397"><a href="../category/database/index.html">Database</a> (1)
</li>
<li class="cat-item cat-item-95"><a href="../category/development/index.html">Development</a> (3)
</li>
<li class="cat-item cat-item-152"><a href="../category/docker/index.html">Docker</a> (11)
</li>
<li class="cat-item cat-item-422"><a href="../category/efk/index.html">EFK</a> (1)
</li>
<li class="cat-item cat-item-423"><a href="../category/elastic-search/index.html">Elastic Search</a> (1)
</li>
<li class="cat-item cat-item-59"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a> (6)
</li>
<li class="cat-item cat-item-419"><a href="../category/fluentd/index.html">FluentD</a> (2)
</li>
<li class="cat-item cat-item-424"><a href="../category/gcp-googlecloud/index.html">GCP &#8211; GoogleCloud</a> (1)
</li>
<li class="cat-item cat-item-450"><a href="../category/github-actions/index.html">Github Actions</a> (1)
</li>
<li class="cat-item cat-item-428"><a href="../category/grafana/index.html">Grafana</a> (1)
</li>
<li class="cat-item cat-item-275"><a href="../category/graphite/index.html">Graphite</a> (1)
</li>
<li class="cat-item cat-item-441"><a href="../category/ibm-cloud/index.html">IBM Cloud</a> (1)
</li>
<li class="cat-item cat-item-401"><a href="../category/ibm-websphere/index.html" title="IBM® WebSphere® Application Server provides a range of flexible and secure runtime for Java enterprise applications, lightweight web applications and microservices. You can create new applications and enhance and optimize existing application infrastructure on premises or across any public, private or hybrid cloud. In addition, by utilizing IBM Cloud Private, you can create on-premises cloud capabilities similar to public clouds to accelerate app development. The platform is built on the open source Kubernetes-based container architecture and supports both Docker containers and Cloud Foundry.">IBM Websphere</a> (2)
</li>
<li class="cat-item cat-item-354"><a href="../category/ihs-and-apache/index.html">IHS and Apache</a> (10)
</li>
<li class="cat-item cat-item-353"><a href="../category/iis/index.html">IIS</a> (4)
</li>
<li class="cat-item cat-item-388"><a href="../category/javascript/index.html">JavaScript</a> (3)
</li>
<li class="cat-item cat-item-286"><a href="../category/jenkins/index.html">Jenkins</a> (4)
</li>
<li class="cat-item cat-item-15"><a href="../category/joomla/index.html">Joomla</a> (1)
</li>
<li class="cat-item cat-item-151"><a href="../category/kubernetes/index.html">Kubernetes</a> (16)
</li>
<li class="cat-item cat-item-191"><a href="../category/middleware/index.html">Middleware</a> (3)
</li>
<li class="cat-item cat-item-322"><a href="../category/network-troubleshooting/index.html">Network Troubleshooting</a> (1)
</li>
<li class="cat-item cat-item-413"><a href="../category/networking/index.html">Networking</a> (1)
</li>
<li class="cat-item cat-item-273"><a href="../category/nodejs/index.html">NodeJS</a> (2)
</li>
<li class="cat-item cat-item-396"><a href="../category/office365/index.html">Office365</a> (1)
</li>
<li class="cat-item cat-item-148"><a href="../category/opensource/index.html">OpenSource</a> (2)
</li>
<li class="cat-item cat-item-417"><a href="../category/oracle-db/index.html">Oracle DB</a> (3)
</li>
<li class="cat-item cat-item-404"><a href="../category/oracle-weblogic/index.html" title="WebLogic is a leading Application Server product most widely used for e-commerce online transaction processing (OLTP) platform application, developed to connect users in a distributed computing environment and to facilitate the integration of mainframe applications with distributed corporate data and applications.">Oracle Weblogic</a> (2)
</li>
<li class="cat-item cat-item-232"><a href="../category/packer/index.html">Packer</a> (2)
</li>
<li class="cat-item cat-item-146"><a href="../category/perl/index.html">Perl</a> (1)
</li>
<li class="cat-item cat-item-60"><a href="../category/php/index.html">PHP</a> (1)
</li>
<li class="cat-item cat-item-453"><a href="../category/postgresql/index.html">PostgreSQL</a> (1)
</li>
<li class="cat-item cat-item-343"><a href="../category/powershell/index.html">PowerShell</a> (1)
</li>
<li class="cat-item cat-item-31"><a href="../category/weblogic/problemsolution/index.html">problem/solution</a> (8)
</li>
<li class="cat-item cat-item-427"><a href="../category/prometheus/index.html">Prometheus</a> (1)
</li>
<li class="cat-item cat-item-445"><a href="../category/pulumi/index.html">Pulumi</a> (1)
</li>
<li class="cat-item cat-item-285"><a href="../category/python-flask/index.html">Python Flask</a> (1)
</li>
<li class="cat-item cat-item-22"><a href="../category/python_scripts/index.html">python_scripts</a> (7)
</li>
<li class="cat-item cat-item-446"><a href="../category/redis/index.html">Redis</a> (1)
</li>
<li class="cat-item cat-item-451"><a href="../category/serverless/index.html">Serverless</a> (1)
</li>
<li class="cat-item cat-item-12"><a href="../category/shell-scripting/index.html">Shell Scripting</a> (6)
</li>
<li class="cat-item cat-item-125"><a href="../category/soap-web-services/index.html">SOAP Web Services</a> (1)
</li>
<li class="cat-item cat-item-13"><a href="../category/splunk/index.html">Splunk</a> (1)
</li>
<li class="cat-item cat-item-425"><a href="../category/sre/index.html">SRE</a> (1)
</li>
<li class="cat-item cat-item-274"><a href="../category/statsd/index.html">StatsD</a> (1)
</li>
<li class="cat-item cat-item-233"><a href="../category/terraform/index.html">Terraform</a> (12)
</li>
<li class="cat-item cat-item-35"><a href="../category/tomcat/index.html">tomcat</a> (7)
</li>
<li class="cat-item cat-item-147"><a href="../category/tools/index.html">tools</a> (5)
</li>
<li class="cat-item cat-item-391"><a href="../category/traefik/index.html">Traefik</a> (1)
</li>
<li class="cat-item cat-item-124"><a href="../category/troubleshooting/index.html">Troubleshooting</a> (3)
</li>
<li class="cat-item cat-item-1"><a href="../category/uncategorized/index.html">Uncategorized</a> (5)
</li>
<li class="cat-item cat-item-7"><a href="../category/unix/index.html">Unix</a> (5)
</li>
<li class="cat-item cat-item-99"><a href="../category/vagrant/index.html">Vagrant</a> (4)
</li>
<li class="cat-item cat-item-389"><a href="../category/vuejs/index.html">VueJS</a> (2)
</li>
<li class="cat-item cat-item-356"><a href="../category/vulnerabilities-fixes/index.html">Vulnerabilities &amp; Fixes</a> (21)
</li>
<li class="cat-item cat-item-21"><a href="../category/weblogic/index.html">weblogic</a> (51)
</li>
<li class="cat-item cat-item-9"><a href="../category/webserver/index.html">Webserver</a> (1)
</li>
<li class="cat-item cat-item-92"><a href="../category/websphere/index.html">Websphere</a> (8)
</li>
<li class="cat-item cat-item-321"><a href="../category/windows-server/index.html">Windows Server</a> (5)
</li>
<li class="cat-item cat-item-55"><a href="../category/wlst/index.html">wlst</a> (7)
</li>
<li class="cat-item cat-item-36"><a href="../category/wordpress/index.html">wordpress</a> (2)
</li>
<li class="cat-item cat-item-4"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a> (1)
</li>
</ul>
</aside><aside id="media_image-5" class="widget widget_media_image clearfix"><img width="267" height="400" src="../../wp-content/ewww/lazy/placeholder-267x400.png" class="image wp-image-8825  attachment-full size-full lazyload" alt="write for devopsjunction" style="max-width: 75%; height: auto;" data-src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" loading="lazy" data-srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" data-sizes="auto" /><noscript><img width="267" height="400" src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" class="image wp-image-8825  attachment-full size-full" alt="write for devopsjunction" style="max-width: 75%; height: auto;" srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" sizes="(max-width: 267px) 100vw, 267px" data-eio="l" /></noscript></aside>
</section>
</div>
<div id="footer" class="footer-wrap">
<footer id="colophon" class="site-footer container clearfix" role="contentinfo">
<div id="footer-text" class="site-info">
<span class="credit-link">Powered by <a href="../../index.html" title="Rumen Lishkov">Rumen Lishkov</a> and <a href="https://rumen.free.bg/" title="Studio-1">Studio1 Sofia</a> </span>
</div>
</footer>
</div>
</div>
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@mwinventory" />
<meta name="twitter:creator" content="@mwinventory" />
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&amp;display=swap" rel="stylesheet"><div class="simplesocialbuttons simplesocial-round-icon simplesocialbuttons-float-left-center post-5589 post  ssb_counter-activate simplesocialbuttons-slide-bottom-in">
<button class="simplesocial-fb-share" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Facebook </span> <span class="ssb_counter ssb_fbshare_counter">0</span></button>
<button class="simplesocial-twt-share" data-href="https://twitter.com/share?text=Postfix+SMTP+relay+to+Office+365+%E2%80%93+Single+and+Multiple+SMTP+Servers&url=https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Twitter</span> <span class="ssb_counter ssb_twitter_counter">0</span></button>
<button target="popup" class="simplesocial-linkedin-share" data-href="https://www.linkedin.com/cws/share?url=https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">LinkedIn</span></button>
<button onclick="javascript:window.location.href = this.dataset.href;return false;" class="simplesocial-email-share" data-href="mailto:?subject=Postfix+SMTP+relay+to+Office+365+%E2%80%93+Single+and+Multiple+SMTP+Servers&body=https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/"><span class="simplesocialtxt">Email</span></button>
<button onclick="javascript:window.open(this.dataset.href, '_blank' );return false;" class="simplesocial-whatsapp-share" data-href="https://web.whatsapp.com/send?text=https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/"><span class="simplesocialtxt">WhatsApp</span></button>
</div>
<script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' id='disqus_count-js-extra'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"mwinventory"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f8767.js"></script>
<script type='text/javascript' id='disqus_embed-js-extra'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.22"},"disqusIdentifier":"5589 https:\/\/www.middlewareinventory.com\/?p=5589","disqusShortname":"mwinventory","disqusTitle":"Postfix SMTP relay to Office 365 \u2013 Single and Multiple SMTP Servers","disqusUrl":"https:\/\/www.middlewareinventory.com\/blog\/postfix-relay-office-365\/","postId":"5589"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/bccbc.js"></script>
<script type='text/javascript' id='dae-download-js-extra'>
/* <![CDATA[ */
var objDaeDownload = {"ajaxUrl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"2019084a26"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/8510d.js"></script>
<script type='text/javascript' id='socialsnap-js-js-extra'>
/* <![CDATA[ */
var socialsnap_script = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","on_media_width":"250","on_media_height":"250","nonce":"b4d440853b","post_id":"5589"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/fef55.js"></script>
<script type='text/javascript' id='aicp-js-extra'>
/* <![CDATA[ */
var AICP = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"0b980bed5f","ip":"217.110.71.177","clickLimit":"1","clickCounterCookieExp":"3","banDuration":"7","countryBlockCheck":"No","banCountryList":"RU"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/ff9fe.js"></script>
<script type='text/javascript' src='https://js.stripe.com/v3/?ver=2.03' id='stripe-js'></script>
<script type='text/javascript' id='q2w3_fixed_widget-js-extra'>
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"q2w3-default-sidebar","margin_top":10,"margin_bottom":0,"stop_id":"","screen_max_width":1026,"screen_max_height":0,"width_inherit":true,"refresh_interval":1500,"window_load_hook":false,"disable_mo_api":false,"widgets":["text-32"]}];
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f2bcf.js"></script>
<script type='text/javascript' id='enlighterjs-js-after'>
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"enlighter","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
</script>
<script src="../../wp-content/cache/minify/129c2.js"></script>
<script type='text/javascript' id='ez-toc-js-js-extra'>
/* <![CDATA[ */
var ezTOC = {"smooth_scroll":"1","visibility_hide_by_default":"","width":"100%","scroll_offset":"30"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/0c713.js"></script>
<div id="ss-copy-popup" class="ss-popup-overlay">
<div class="ss-popup">
<div class="ss-popup-heading">
<span>Copy link</span>
<a href="#" id="ss-close-share-networks-modal" class="ss-close-modal" rel="nofollow"><i class="ss ss-close"></i></a>
</div>
<div class="ss-popup-content">
<div class="ss-copy-action">
<input type="text" readonly="readonly" value="https://airdata.gitlab.io/blog/blog/postfix-relay-office-365/" class="ss-copy-action-field" />
<a href="#" class="ss-button" rel="nofollow">Copy<span class="ss-share-network-tooltip">Copied</span></a>
<i class="ss ss-copy"></i>
</div>
<div class="ss-powered-by">Powered by <a href="https://socialsnap.com/?utm_source=WordPress&amp;utm_medium=link&amp;utm_campaign=inthewild" target="_blank" rel="nofollow noopener"><i class="ss ss-socialsnap"></i>Social Snap</a></div>
</div>
</div>
</div>
<script type='text/javascript'>function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script> 
<script type="text/javascript">

			var SocialSnapURL 				= window.location.href;
			var SocialSnapShareCacheExpired = 0;
				
			if ( -1 !== SocialSnapURL.indexOf('?ss_cache_refresh') ) {

				SocialSnapShareCacheExpired = true;

			} else {

				var SocialSnapServerTimestamp 	= 1657191149;
				var SocialSnapBrowserTimestamp 	= Date.now();

				if ( ! SocialSnapBrowserTimestamp ) {
					SocialSnapBrowserTimestamp = new Date().getTime();
				}

				SocialSnapBrowserTimestamp = Math.floor( SocialSnapBrowserTimestamp / 1000 );

				SocialSnapShareCacheExpired = SocialSnapShareCacheExpired && ( SocialSnapBrowserTimestamp - SocialSnapServerTimestamp < 60 );
			}

		</script>

<div id="cookie-notice" role="banner" class="cn-bottom bootstrap" style="color: #fff; background-color: #000;"><div class="cookie-notice-container"><span id="cn-notice-text">We use cookies to ensure that we give you the best experience on our website. The Cookies collected are used only to Show customized Ads. We Hope you are fine with it.</span><a href="#" id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button bootstrap button">Ok</a><a href="#" id="cn-refuse-cookie" data-cookie-set="refuse" class="cn-set-cookie cn-button bootstrap button">No</a><a href="../../cookie-policy/index.html" target="_blank" id="cn-more-info" class="cn-more-info cn-button bootstrap button">Privacy policy</a>
</div>
<div class="cookie-notice-revoke-container"><a href="#" class="cn-revoke-cookie cn-button bootstrap button">Revoke cookies</a></div>
</div>
</body>
</html>
