<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">
<link rel="pingback" href="https://www.middlewareinventory.com/xmlrpc.php">

<title>Kubernetes Sidecar - Logging with FluentD to EFK | Devops Junction</title>
<meta name="description" content="Kubernetes FluentD setup as a Sidecar container. Ship App logs to Elastic Search with FluentD. Tomcat and FluentD as a Side car container in Kubernetes POD" />
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<link rel="canonical" href="index.html" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Kubernetes Sidecar - Logging with FluentD to EFK | Devops Junction" />
<meta property="og:description" content="Kubernetes FluentD setup as a Sidecar container. Ship App logs to Elastic Search with FluentD. Tomcat and FluentD as a Side car container in Kubernetes POD" />
<meta property="og:url" content="https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="article:publisher" content="https://www.facebook.com/rumenlishkov" />
<meta property="article:published_time" content="2020-11-29T22:25:08+00:00" />
<meta property="article:modified_time" content="2022-07-02T06:33:04+00:00" />
<meta property="og:image" content="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM.png" />
<meta property="og:image:width" content="979" />
<meta property="og:image:height" content="585" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@mwinventory" />
<meta name="twitter:site" content="@mwinventory" />
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://www.middlewareinventory.com/#organization","name":"Middleware Inventory","url":"https://www.middlewareinventory.com/","sameAs":["https://www.facebook.com/rumenlishkov","https://www.youtube.com/channel/UCRuqBFM6ioWwviNJkgOjeWw","https://twitter.com/mwinventory"],"logo":{"@type":"ImageObject","@id":"https://www.middlewareinventory.com/#logo","inLanguage":"en-US","url":"https://airdata.gitlab.io/blog/wp-content/uploads/2020/09/Screenshot-2020-09-18-at-3.49.40-AM.jpg","width":300,"height":107,"caption":"Middleware Inventory"},"image":{"@id":"https://www.middlewareinventory.com/#logo"}},{"@type":"WebSite","@id":"https://www.middlewareinventory.com/#website","url":"https://www.middlewareinventory.com/","name":"Devops Junction","description":"An inventory of [i]nformation, Middleware and much more.","publisher":{"@id":"https://www.middlewareinventory.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":"https://www.middlewareinventory.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/#primaryimage","inLanguage":"en-US","url":"../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM.png","width":979,"height":585},{"@type":"WebPage","@id":"https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/#webpage","url":"https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/","name":"Kubernetes Sidecar - Logging with FluentD to EFK | Devops Junction","isPartOf":{"@id":"https://www.middlewareinventory.com/#website"},"primaryImageOfPage":{"@id":"https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/#primaryimage"},"datePublished":"2020-11-29T22:25:08+00:00","dateModified":"2022-07-02T06:33:04+00:00","description":"Kubernetes FluentD setup as a Sidecar container. Ship App logs to Elastic Search with FluentD. Tomcat and FluentD as a Side car container in Kubernetes POD","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/"]}]},{"@type":"Article","@id":"https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/#article","isPartOf":{"@id":"https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/#webpage"},"author":{"@id":"https://www.middlewareinventory.com/#/schema/person/050bf13e27b309d29d1bda45c4eb3147"},"headline":"Kubernetes Sidecar &#8211; Logging with FluentD to EFK","datePublished":"2020-11-29T22:25:08+00:00","dateModified":"2022-07-02T06:33:04+00:00","mainEntityOfPage":{"@id":"https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/#webpage"},"commentCount":0,"publisher":{"@id":"https://www.middlewareinventory.com/#organization"},"image":{"@id":"https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/#primaryimage"},"keywords":"fluent bit kubernetes example,kubernetes fluentd","articleSection":"FluentD,Kubernetes","inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/#respond"]}]},{"@type":"Person","@id":"https://www.middlewareinventory.com/#/schema/person/050bf13e27b309d29d1bda45c4eb3147","name":"Rumen Lishkov","image":{"@type":"ImageObject","@id":"https://www.middlewareinventory.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g","caption":"Rumen Lishkov"}}]}</script>

<link rel='dns-prefetch' href='https://js.stripe.com' />
<link rel='dns-prefetch' href='https://fonts.googleapis.com' />
<link rel='dns-prefetch' href='https://s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Feed" href="../../feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Comments Feed" href="../../comments/feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Kubernetes Sidecar &#8211; Logging with FluentD to EFK Comments Feed" href="feed/index.rss" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-6674956-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-6674956-8');
</script>

<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.middlewareinventory.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.5.6"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/404f7.css" media="all" />
<style id='ez-toc-inline-css' type='text/css'>div#ez-toc-container p.ez-toc-title {font-size: 120%;}div#ez-toc-container p.ez-toc-title {font-weight: 500;}div#ez-toc-container ul li {font-size: 95%;}div#ez-toc-container {width: 100%;}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/f854f.css" media="all" />
<link rel='stylesheet' id='poseidon-default-fonts-css' href='https://fonts.googleapis.com/css?family=Ubuntu%3A400%2C400italic%2C700%2C700italic%7CRaleway%3A400%2C700&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel="stylesheet" href="../../wp-content/cache/minify/88e5e.css" media="all" />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/www.middlewareinventory.com","hash_tracking":"false"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1058f.js"></script>
<script type='text/javascript' id='cookie-notice-front-js-extra'>
/* <![CDATA[ */
var cnArgs = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","hideEffect":"fade","onScroll":"no","onScrollOffset":"100","cookieName":"cookie_notice_accepted","cookieValue":"true","cookieTime":"2592000","cookiePath":"\/","cookieDomain":"","redirection":"","cache":"1","refuse":"yes","revoke_cookies":"0","revoke_cookies_opt":"automatic","secure":"1"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/545b0.js"></script>
<script type='text/javascript' id='email-subscribers-js-extra'>
/* <![CDATA[ */
var es_data = {"messages":{"es_empty_email_notice":"Please enter email address","es_rate_limit_notice":"You need to wait for sometime before subscribing again","es_single_optin_success_message":"Successfully Subscribed.","es_email_exists_notice":"Email Address already exists!","es_unexpected_error_notice":"Oops.. Unexpected error occurred.","es_invalid_email_notice":"Invalid email address","es_try_later_notice":"Please try after some time"},"es_ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1de0a.js"></script>
<script type='text/javascript' id='ssb-front-js-js-extra'>
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"3d8661396b"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/268e7.js"></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://airdata.gitlab.io/blog/wp-content/themes/poseidon/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<script type='text/javascript' id='poseidon-post-slider-js-extra'>
/* <![CDATA[ */
var poseidon_slider_params = {"animation":"slide","speed":"7000"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/51af3.js"></script>
<script type='text/javascript' id='eio-lazy-load-js-extra'>
/* <![CDATA[ */
var eio_lazy_vars = {"exactdn_domain":"","skip_autoscale":"0"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/28f5b.js"></script>
<link rel="https://api.w.org/" href="../../wp-json/index.json" /><link rel="alternate" type="application/json" href="../../wp-json/wp/v2/posts/5805.json" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php-rsd.xml" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.middlewareinventory.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 5.5.6" />
<link rel='shortlink' href='index.html' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-kubernetes-sidecar-logging-with-fluentd-to-efk-.json" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-kubernetes-sidecar-logging-with-fluentd-to-efk-&amp;format=xml.xml" />
<link href='https://fonts.googleapis.com/css?family=Strait:100,200,300,400,500,600,700,800,900&amp;subset=arabic,vietnamese,hebrew,thai,bengali,latin,latin-ext,cyrillic,cyrillic-ext,greek' rel='stylesheet' type='text/css'><style>a.idcore-button,a.idcore-button:visited{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:hover,a.idcore-button:focus{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:active{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}</style><script>var idcore_ajax_url = "https://www.middlewareinventory.com/wp-admin/admin-ajax.php";</script> <style media="screen">/*inline margin*/
	
	
	
	
	
	
			 /*margin-digbar*/

	
	
	
	
	   div[class*="simplesocialbuttons-float"].simplesocialbuttons.simplesocial-round-icon button{
	 margin: ;
   }
	
	
	
</style>

<meta property="og:title" content="Kubernetes Sidecar &#8211; Logging with FluentD to EFK - Middleware Inventory" />
<meta property="og:description" content="Introduction
Log management in Infrastructure has changed tremendously in recent few years and we are a having wonderful products in the market to manage, parse, analyze log files

These tools are being used extensively for incident management, alerting, security analysis and application performance monitoring etc.

In the Opensource market, Elastic Search or ELK Stack is leading and makes it possible for small to" />
<meta property="og:url" content="https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="og:image" content="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Introduction
Log management in Infrastructure has changed tremendously in recent few years and we are a having wonderful products in the market to manage, parse, analyze log files

These tools are being used extensively for incident management, alerting, security analysis and application performance monitoring etc.

In the Opensource market, Elastic Search or ELK Stack is leading and makes it possible for small to" />
<meta name="twitter:title" content="Kubernetes Sidecar &#8211; Logging with FluentD to EFK - Middleware Inventory" />
<meta property="twitter:image" content="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM.png" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
<noscript><style>.lazyload[data-src]{display:none !important;}</style></noscript><style type="text/css" id="sns_global_styles">/* for mobile */
@media screen and (max-width: 480px) {
    #text-23 {
        display:none !important;
    }
	p,li
    {
      font-size: 20px !important;
      color: #333 !important;
      line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li a
    {
    	font-size: 20px !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  
  #afc_sidebar_4348 
{
  height: 8vh; 
  max-height: 8vh; 
  background-color: transparent;
}
}

/* for Desktop */
@media screen and (min-width: 500px) {
#afc_sidebar_4348 
{
  height: 10vh; 
  max-height: 10vh; 
  background-color: transparent;
}
  #text-23 {
        display:none !important;
    }
	p,li
    {
        font-size: 20px !important;
        color: #333 !important;
        line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  

}

.es_lablebox {
    padding-bottom: 3px;
    color: steelblue !important;
    font-weight: bold !important;
}
.widget-title span {
    line-height: 2.2;
    color: steelblue !important;
}
.sidey {
	padding: 0;
}
.sumome-contactform 
{
  display: none;
}
code { 
    font-family: courier;
    font-size: 18px;
    padding: 2px;
    background-color: #f1f1f1;
    /*box-shadow: 0 2px 4px 0 rgba(0,0,0,0.16),0 2px 10px 0 rgba(0,0,0,0.12)!important;*/
    
}

.syntaxhighlighter {
    font-size: 14px !important;
}

pre {
 font-family: Menlo, Monaco, Consolas, "Courier New", monospace !important;
}

.black-red-border
{
    border-left: 3px solid;
    background-color: black;
    color: ghostwhite;
    border-left-color: red;
} 
}

#wpdevar_comment_1 span
{
  font-family:  "Open Sans", Helvetica, Arial, sans-serif !important;
  font-size: 20px !important;
  color: #1495b5 !important;
}

#wpdevar_comment_1 
{
  margin-top: 50px;
  margin-bottom: 30px;
}

summary
{
 color: steelblue; 
}

blockquote
{
  border-left-color: #cc0f77 !important;
  border-left-width: 4px !important;
  border-left-style: solid !important;
  background-color: #f5f5f5 !important;
}

.rp4wp-related-post-image{ width: auto !important; }

.main-navigation-menu
{
  float: none !important;
}

.primary-navigation
{
  float: none !important
}

body,html{
  /* font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

.page-title, .entry-title, .site-title, .main-navigation-menu a, .widget-title
{
  /*font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

#postfollow {
  background: whitesmoke;
  padding-top: 5%;
  padding-bottom: 5%;
  padding-left: 2%;
}
div#ez-toc-container p.ez-toc-title {
    font-weight: bold;
    font-size: 24px !important;
}
div#ez-toc-container {
    margin-bottom: 15%;
}

</style><link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-180x180.png" />
<meta name="msapplication-TileImage" content="https://airdata.gitlab.io/blog/wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-270x270.png" />
<style type="text/css">article h3
{
    background-color: whitesmoke;
    color: black;
    padding-left: 1%;
    border-left: 10px solid black;
    font-weight: 400;
    font-size: 22px;
}
#precode
{
  background-color: transparent !important;
  color: #00193a !important;
  font-size: 16px;
}
.post-img
{
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  border: 1px solid lightgray;
}
article h2
{
    background-color: #29558c;
    color: white;
    padding-left: 1%;
    border-left: 15px solid crimson;
    font-weight: 400;
    font-size: 22px;
}
pre
{
  display: block; 
  overflow-x: auto; 
  padding-left: 2em;
  padding-top: 3em;
  padding-bottom: 3em;
  background: #eaeef3 none repeat scroll 0% 0%; 
  color: #00193a;
}
li {
    padding: 2px;
    margin-left: 2%;
}
code
{
  color: black;
}
blockquote {
    padding: 2%;
    background-color: none !important;
}
div.enlighter{
  font-size: 1.2em;  
}
.enlighter-default {
    font-family: Menlo, Monaco, Consolas, "Courier New", monospace !important;
}
</style>
<style type="text/css" id="wp-custom-css">.site-title
{
   font-size: 24px !important;
}		</style>
</head>
<body class="post-template-default single single-post postid-5805 single-format-standard wp-custom-logo cookies-set cookies-accepted elementor-default">
<div id="page" class="hfeed site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<div id="header-top" class="header-bar-wrap"></div>
<header id="masthead" class="site-header clearfix" role="banner">
<div class="header-main container clearfix">
<div id="logo" class="site-branding clearfix">
<a href="../../index.html" class="custom-logo-link" rel="home"><img width="160" height="120" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 107'%3E%3C/svg%3E" class="custom-logo lazyload" alt="Middleware Inventory" data-src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" loading="lazy" /><noscript><img width="160" height="120" src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" class="custom-logo" alt="Middleware Inventory" data-eio="l" /></noscript></a>
<p class="site-title"></p>
</div>
<nav id="main-navigation" class="primary-navigation navigation clearfix" role="navigation">
<ul id="menu-primary-menu" class="main-navigation-menu"><li id="menu-item-172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-172"><a href="https://airdata.github.io/">About Me</a></li>
<li id="menu-item-3206" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-3206"><a href="../category/middleware/index.html">Middleware</a>
<ul class="sub-menu">
<li id="menu-item-1518" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1518"><a href="../category/weblogic/index.html">weblogic</a></li>
<li id="menu-item-3207" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3207"><a href="../category/was/index.html">WAS</a></li>
<li id="menu-item-3208" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3208"><a href="../category/websphere/index.html">Websphere</a></li>
<li id="menu-item-3209" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3209"><a href="../category/wlst/index.html">wlst</a></li>
<li id="menu-item-3210" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3210"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a></li>
<li id="menu-item-3211" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3211"><a href="../category/jms/index.html">JMS</a></li>
<li id="menu-item-3212" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3212"><a href="../category/activemq/index.html">ActiveMQ</a></li>
<li id="menu-item-3213" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3213"><a href="../category/troubleshooting/index.html">Troubleshooting</a></li>
<li id="menu-item-3214" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3214"><a href="../category/apache/index.html">Apache</a></li>
<li id="menu-item-3215" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3215"><a href="../category/best-practice/index.html">Best Practice</a></li>
<li id="menu-item-3222" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3222"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a></li>
</ul>
</li>
<li id="menu-item-3157" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3157"><a href="../../devops-junction/index.html">Devops</a>
<ul class="sub-menu">
<li id="menu-item-1513" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1513"><a href="../category/ansible/index.html">Ansible</a></li>
<li id="menu-item-3216" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3216"><a href="../category/aws/index.html">AWS</a></li>
<li id="menu-item-3217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3217"><a href="../category/docker/index.html">Docker</a></li>
<li id="menu-item-3218" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3218"><a href="../category/packer/index.html">Packer</a></li>
<li id="menu-item-3219" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3219"><a href="../category/splunk/index.html">Splunk</a></li>
<li id="menu-item-3220" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3220"><a href="../category/terraform/index.html">Terraform</a></li>
<li id="menu-item-3221" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3221"><a href="../category/vagrant/index.html">Vagrant</a></li>
<li id="menu-item-3223" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-3223"><a href="../category/kubernetes/index.html">Kubernetes</a></li>
</ul>
</li>

<li id="menu-item-8821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8821"><a href="https://rumen.free.bg/#contact">Book a Consultation</a></li>
</ul> </nav>
</div>
</header>
<div id="content" class="site-content container clearfix">
<section id="primary" class="content-area">
<main id="main" class="site-main" role="main">

<article id="post-5805" class="post-5805 post type-post status-publish format-standard has-post-thumbnail hentry category-fluentd category-kubernetes tag-fluent-bit-kubernetes-example tag-kubernetes-fluentd wpautop">
<header class="entry-header">
<h1 class="entry-title">Kubernetes Sidecar &#8211; Logging with FluentD to EFK</h1>
<div class="entry-meta"><span class="meta-date"> Updated on: <a href="index.html" title="3:55 am" rel="bookmark"><time class="entry-date published updated" datetime="July 2, 2022">July 2, 2022</time></a></span><span class="meta-author"> <span class="author vcard"><a class="url fn n" href="../author/admin/index.html" title="View all posts by Rumen Lishkov" rel="author">Rumen Lishkov</a></span></span></div>
</header>
<div class="entry-content clearfix">
<div class="ss-inline-share-wrapper ss-left-inline-content ss-small-icons ss-with-spacing ss-rounded-icons">
<div class="ss-inline-share-content">
<ul class="ss-social-icons-container">
<li class="">
<a href="#" data-ss-ss-link="https://www.facebook.com/sharer.php?t=Kubernetes%20Sidecar%20%E2%80%93%20Logging%20with%20FluentD%20to%20EFK&u=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fkubernetes-sidecar-logging-with-fluentd-to-efk%2F" class="ss-facebook-color" rel="nofollow" data-ss-ss-network-id="facebook" data-ss-ss-post-id="5805" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" data-ss-ss-type="share" data-has-api="true">
<span class="ss-share-network-content">
<i class="ss ss-facebook"></i>
<span class="ss-network-count">
0
</span>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://twitter.com/intent/tweet?text=Kubernetes+Sidecar+%E2%80%93+Logging+with+FluentD+to+EFK&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fkubernetes-sidecar-logging-with-fluentd-to-efk%2F" class="ss-twitter-color" rel="nofollow" data-ss-ss-network-id="twitter" data-ss-ss-post-id="5805" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-twitter"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://www.linkedin.com/shareArticle?title=Kubernetes%20Sidecar%20%E2%80%93%20Logging%20with%20FluentD%20to%20EFK&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fkubernetes-sidecar-logging-with-fluentd-to-efk%2F&mini=true" class="ss-linkedin-color" rel="nofollow" data-ss-ss-network-id="linkedin" data-ss-ss-post-id="5805" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-linkedin"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="mailto:?body=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fkubernetes-sidecar-logging-with-fluentd-to-efk%2F&subject=Kubernetes%20Sidecar%20%E2%80%93%20Logging%20with%20FluentD%20to%20EFK" class="ss-envelope-color" rel="nofollow" data-ss-ss-network-id="envelope" data-ss-ss-post-id="5805" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-envelope"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="#" class="ss-copy-color" rel="nofollow" data-ss-ss-network-id="copy" data-ss-ss-post-id="5805" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-copy"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<div id="ez-toc-container" class="counter-hierarchy counter-decimal ez-toc-grey">
<div class="ez-toc-title-container">
<p class="ez-toc-title">Table of Contents</p>
<span class="ez-toc-title-toggle"><a class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle"><i class="ez-toc-glyphicon ez-toc-icon-toggle"></i></a></span></div>
<nav><ul class="ez-toc-list"><li><a href="#Introduction" title="Introduction">Introduction</a></li><li><a href="#ELK_vs_EFK" title="ELK vs EFK">ELK vs EFK</a></li><li><a href="#Our_Objective" title="Our Objective">Our Objective</a></li><li><a href="#Steps_to_deploy_fluentD_as_a_Sidecar_Container" title="Steps to deploy fluentD as a Sidecar Container">Steps to deploy fluentD as a Sidecar Container</a><ul><li><a href="#ConfigMap_to_store_fluentd_config_file" title="ConfigMap &#8211; to store fluentd config file">ConfigMap &#8211; to store fluentd config file</a></li><li><a href="#Creating_our_Docker_Container_Images" title="Creating our Docker Container Images">Creating our Docker Container Images</a></li><li><a href="#Creating_a_Kubernetes_Deployment_Manifest_Yaml_file" title="Creating a Kubernetes Deployment Manifest Yaml file">Creating a Kubernetes Deployment Manifest Yaml file</a></li><li><a href="#Volumes_and_Volume_Mounts" title="Volumes and Volume Mounts">Volumes and Volume Mounts</a></li><li><a href="#Deploying_our_YAML_for_Kubernetes_FluentD_Sidecar_setup" title="Deploying our YAML for Kubernetes FluentD Sidecar setup">Deploying our YAML for Kubernetes FluentD Sidecar setup</a></li><li><a href="#Validating_Kubernetes_FluentD_and_Tomcat_Containers_in_POD" title="Validating Kubernetes FluentD and Tomcat Containers in POD">Validating Kubernetes FluentD and Tomcat Containers in POD</a></li><li><a href="#Validating_the_arrival_of_the_logs_at_Elastic" title="Validating the arrival of the logs at Elastic">Validating the arrival of the logs at Elastic</a></li></ul></li><li><a href="#Conclusion" title="Conclusion">Conclusion</a></li></ul></nav></div>
<h2><span class="ez-toc-section" id="Introduction">Introduction</span></h2>
<p>Log management in Infrastructure has changed tremendously in recent few years and we are a having wonderful products in the market to manage, parse, analyze log files</p>
<p>These tools are being used extensively for incident management, alerting, security analysis and application performance monitoring etc.</p>
<p>In the Opensource market, Elastic Search or <a href="https://www.elastic.co/what-is/elk-stack">ELK Stack </a>is leading and makes it possible for small to medium companies to afford this wonderful log management solutions. while Splunk leads the enterprise market.</p>
<p>If you are not already aware, ELK stack is a combination of three open source projects, Elastic Search, Log Stash and Kibana and they come together to give you a combined log management experience and each one of them has a job to do.</p>
<ul>
<li><strong>Elastic Search</strong> &#8211; Search and Data analytics Engine just like <a href="https://lucene.apache.org/solr/">Apache Solr</a>, <a href="https://lucene.apache.org/">Lucene</a></li>
<li><strong>Log Stash</strong> &#8211; Data processing and ingesting tool sends/stash to Elastic search</li>
<li><strong>Kibana</strong> &#8211; A Visualizing tool for the data stored in Elastic create graphs, alerts etc.</li>
</ul>
<p>Hope this gives you a quick intro to ELK. but we are going to use <strong>EFK</strong>. what is EFK?</p>
<h2><span class="ez-toc-section" id="ELK_vs_EFK">ELK vs EFK</span></h2>
<p>You know what is ELK already and what is this EFK. It is an acronym of<strong> Elastic FluentD Kibana</strong></p>
<p><img class="n3VNCb alignnone lazyload" title="post-img" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 784 176'%3E%3C/svg%3E" alt="Logging in Kubernetes: EFK" width="784" height="176" data-noaft="1" data-src="https://www.cncf.io/wp-content/uploads/2020/07/image3.png" loading="lazy" /><noscript><img class="n3VNCb alignnone" title="post-img" src="https://www.cncf.io/wp-content/uploads/2020/07/image3.png" alt="Logging in Kubernetes: EFK" width="784" height="176" data-noaft="1" data-eio="l" /></noscript></p>
<p>If you have not heard/read about <a href="https://www.fluentd.org/">fluentD</a> yet. This is your lucky day.</p>
<p>FluentD is a wonderful Log Collector tool just like Log Stash ( far better than) and it serves as unified logging platform yet Simple</p>
<p>Based on my personal experience. I found Log stash really hard to implement with <strong>GROK</strong> patterns and FluentD saved me. ( I mean it )</p>
<p>There is a lightweight log shipping product from Elastic named <a href="https://www.elastic.co/beats/">Beats</a> as an alternate for LogStash. but it does not meet the efficiency and simplicity of <code>fluentd</code></p>
<p>With no further ado, let us talk about our objective of implementing the Kubernetes FluentD Sidecar container.</p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Our_Objective">Our Objective</span></h2>
<p><a href="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM.png"><img class="post-img alignnone wp-image-6518 size-full lazyload" src="../../wp-content/ewww/lazy/placeholder-979x585.png" alt="Elastic Search Kubernetes FluentD Tomcat" width="979" height="585" data-src="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM.png" loading="lazy" data-srcset="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM.png 979w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM-300x179.png 300w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM-768x459.png 768w" data-sizes="auto" /><noscript><img class="post-img alignnone wp-image-6518 size-full" src="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM.png" alt="Elastic Search Kubernetes FluentD Tomcat" width="979" height="585" srcset="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM.png 979w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM-300x179.png 300w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-10.38.49-PM-768x459.png 768w" sizes="(max-width: 979px) 100vw, 979px" data-eio="l" /></noscript></a></p>
<p>We have a tomcat based web application container to be deployed into Kubernetes.</p>
<p>I would like to collect and ship my tomcat logs and application logs from kubernetes to a remote elastic search server.</p>
<p>we are going to use the <strong>Elastic FluentD Kibana (EFK)</strong> stack using Kubernetes sidecar container strategy.</p>
<blockquote><p><strong>Why Sidecar logging and not K8s Cluster level logging</strong></p>
<p>Not all the containers we deploy to K8s is writing logs to stdout, though it is recommended, It does not suit all requirements</p>
<p>Let&#8217;s say I containerize my Java web app deployed on tomcat writes its own log files like Audit log, Application log etc.</p>
<p>I cannot obviously redirect all of them to the same stream.</p>
<p>Additionally, what if I want these log files to go to different Indexes in my Elastic Search for Monitoring and auditing.</p>
<p>Well, that&#8217;s where Sidecar comes to help.</p></blockquote>
<p>FluentD should have access to the log files written by tomcat and it is being achieved through Kubernetes <strong>Volume</strong> and <strong>volume mounts</strong></p>
<p>FluentD would ship the logs to the remote Elastic search server using the IP and port along with credentials.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2><span class="ez-toc-section" id="Steps_to_deploy_fluentD_as_a_Sidecar_Container">Steps to deploy fluentD as a Sidecar Container</span></h2>
<p>To deploy fluentD as a sidecar container on Kubernetes POD. we need to create a few configuration elements like ConfigMap, Volumes, Deployment etc.</p>
<p>We will see all of them in detail one by one.</p>
<h3></h3>
<h3><span class="ez-toc-section" id="ConfigMap_to_store_fluentd_config_file">ConfigMap &#8211; to store fluentd config file</span></h3>
<p>Our first task is to create a Kubernetes <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a> object to store the fluentd configuration file. You can store any non-confidential key-value data in ConfigMap object including files.</p>
<p>Here we are creating a ConfigMap named <code>fluentdconf</code> with the key name equivalent to the  resulting filename <code>fluent.conf</code></p>
<p>This ConfigMap with <code>key:value</code> data set would later be mounted into the POD. where the key would be the file name and the value would be stored into the file.</p>
<p>We have defined three major tags (or) root elements in the fluent.conf file</p>
<ul>
<li>Source &#8211; to define the file details to monitor/lookup and to set format to look out for</li>
<li>filter &#8211;  customizing the event collected and overwriting fields (or) adding fields</li>
<li>Match &#8211; to define what to do with the matching data/log events and where to stash.</li>
</ul>
<p>you can write your own format using RUBY Regular Expression (or) use built-in formats like <code>apache2</code> to event filtering.</p>
<p>Under the <code>match</code> root element, we have to define our Elastic Search server details and credentials along with the index name to which we are sending the logs.</p>
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: #eaeef3 none repeat scroll 0% 0%; color: #000000;"><span class="hljs-attr" style="color: #5c2699;">apiVersion:</span> v1
<span class="hljs-attr" style="color: #5c2699;">kind:</span> ConfigMap
<span class="hljs-attr" style="color: #5c2699;">metadata:</span>
<span class="hljs-attr" style="color: #5c2699;">  name:</span> fluentdconf
<span class="hljs-attr" style="color: #5c2699;">  namespace:</span> development
<span class="hljs-attr" style="color: #5c2699;">data:</span>
  fluent.conf: <span class="hljs-string" style="color: #c41a16;">|
      &lt;source&gt;
        @type tail
        time_key time
        format multiline
        format_firstline /^\[[[A-Z]|\s]+\]/
        format1 /^\[(?&lt;LogLevel&gt;[[A-Z]|\s]+)\]\[(?&lt;time&gt;[0-9]{4}-[0-9]{2}-[0-9]{2}\s[0-9]{2}\:[0-9]{2}\:[0-9]{2}\,[0-9]{3})\]\s-\s(?&lt;message&gt;.*+)$/
        path /opt/tomcat/webapps/ROOT/WEB-INF/log/myapp.log
        pos_file /tmp/myapp.log.pos
        tag dev.myapp.applogs
      &lt;/source&gt;

      &lt;filter dev.myapp.applogs&gt;
        @type record_transformer
        &lt;record&gt;
        hostname ${hostname}
        &lt;/record&gt;
      &lt;/filter&gt;

      &lt;match dev.myapp.applogs&gt;
        @type elasticsearch
        host 172.99.1.218
        port 59200
        user elasticusr
        password Pa$$w0rd
        index_name fluentd.${tag}
        logstash_format true
        logstash_prefix dev.myapp.applogs
        flush_interval 1s
      &lt;/match&gt;

      &lt;source&gt;
        @type tail
        path /opt/tomcat/logs/localhost_access_log.%Y-%m-%d.txt
        pos_file /tmp/tomcataccesslog.pos
        tag dev.myapp.tomcatlogs
        format apache2
      &lt;/source&gt;

      &lt;filter dev.myapp.tomcatlogs&gt;
        @type record_transformer
        &lt;record&gt;
        hostname ${hostname}
        &lt;/record&gt;
      &lt;/filter&gt;

      &lt;match dev.myapp.tomcatlogs&gt;
        @type elasticsearch
        host 172.99.1.218
        port 59200
        user elasticusr
        password Pa$$w0rd
        logstash_format true
        logstash_prefix dev.myapp.tomcatlogs
      &lt;/match&gt;
</span></pre>
<p>&nbsp;</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Creating_our_Docker_Container_Images">Creating our Docker Container Images</span></h3>
<p>As discussed earlier, we are going to have two containers in our POD. <code>Tomcat</code> as a primary container with our application pre-deployed and a sidecar container <code>fluentd</code></p>
<h4><strong>Tomcat Docker file</strong></h4>
<p>this is the Dockerfile content for our tomcat image and it has been discussed in detail in <a href="../docker-tomcat-example-dockerfile-sample.html">our previous article here</a></p>
<pre class="EnlighterJSRAW" data-enlighter-language="dockerfile" data-enlighter-theme="bootstrap4" data-enlighter-linenumbers="false">FROM centos

RUN mkdir /opt/tomcat/

WORKDIR /opt/tomcat
RUN curl -O https://downloads.apache.org/tomcat/tomcat-8/v8.5.76/bin/apache-tomcat-8.5.76.tar.gz
RUN tar xvfz apache*.tar.gz
RUN mv apache-tomcat-8.5.76/* /opt/tomcat/.
RUN sed -i -e "s|mirrorlist=|#mirrorlist=|g" /etc/yum.repos.d/CentOS-*; sed -i -e "s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g" /etc/yum.repos.d/CentOS-*
RUN yum -y install java
RUN java -version

WORKDIR /opt/tomcat/webapps
RUN curl -O -L https://github.com/AKSarav/SampleWebApp/raw/master/dist/SampleWebApp.war

EXPOSE 8080

CMD ["/opt/tomcat/bin/catalina.sh", "run"]</pre>
<p>&nbsp;</p>
<p>You can make changes to the image and build it with your desired name like this</p>
<pre>docker build -t tomcat8 .</pre>
<p>If you do not want to make customizations you can pull it locally (or) just use my image name globally <a href="https://hub.docker.com/u/saravak">available from docker hub</a></p>
<pre>docker pull saravak/tomcat8</pre>
<p>&nbsp;</p>
<blockquote><p> <strong>Note*:</strong>  The URL we have used in the Dockerfile to download tomcat often be updated by tomcat or there could be different download url available for different regions across the world.</p>
<p>If you are getting any issues with the link.</p>
<p>Please visit <a href="https://tomcat.apache.org/download-80.cgi">https://tomcat.apache.org/download-80.cgi</a> to get the latest download URL and update it, in your dockerfile.</p></blockquote>
<p>&nbsp;</p>
<h4><strong>FluentD Docker file</strong></h4>
<p>Content for fluentD container&#8217;s Dockerfile is given below.</p>
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: #eaeef3 none repeat scroll 0% 0%; color: #000000;"><span class="hljs-keyword" style="color: #aa0d91;">FROM</span> ubuntu:<span class="hljs-number" style="color: #1c00cf;">16.04</span> 
<span class="hljs-keyword" style="color: #aa0d91;">RUN</span> <span class="bash">apt-get update 
</span><span class="hljs-keyword" style="color: #aa0d91;">RUN</span> <span class="bash"><span class="hljs-built_in" style="color: #5c2699;">ulimit</span> -n 65536 
</span><span class="hljs-keyword" style="color: #aa0d91;">RUN</span> <span class="bash">apt-get install -y curl 
</span><span class="hljs-keyword" style="color: #aa0d91;">RUN</span> <span class="bash">curl https://packages.treasuredata.com/GPG-KEY-td-agent | apt-key add -
</span><span class="hljs-keyword" style="color: #aa0d91;">RUN</span> <span class="bash"><span class="hljs-built_in" style="color: #5c2699;">echo</span> <span class="hljs-string" style="color: #c41a16;">"deb http://packages.treasuredata.com/3/ubuntu/xenial/ xenial contrib"</span> &gt; /etc/apt/sources.list.d/treasure-data. list
</span>
<span class="hljs-keyword" style="color: #aa0d91;">RUN</span> <span class="bash">apt-get update &amp;&amp; apt-get install -y -q curl make g++ &amp;&amp; apt-get clean &amp;&amp; apt-get install -y td-agent &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* 
</span>
<span class="hljs-keyword" style="color: #aa0d91;">RUN</span> <span class="bash">sed -i <span class="hljs-_">-e</span> <span class="hljs-string" style="color: #c41a16;">"s/USER=td-agent/USER=root/"</span> <span class="hljs-_">-e</span> <span class="hljs-string" style="color: #c41a16;">"s/GROUP=td-agent/GROUP=root/"</span> /etc/init.d/td-agent 
</span>
<span class="hljs-keyword" style="color: #aa0d91;">RUN</span> <span class="bash">/usr/sbin/td-agent-gem install fluent-plugin-aws-elasticsearch-service -v 1.0.0 CMD /usr/sbin/td-agent <span class="hljs-variable" style="color: #666600;">$FLUENTD_ARGS</span></span></pre>
<p>&nbsp;</p>
<p>As said earlier you can build your own docker image out of this file (or) simply use my globally available image <code>saravak/fluentd</code></p>
<p>So before proceeding further, you need to have the docker images ready.</p>
<p>Either your custom-built docker image available in your local (or) you can choose to use my globally available docker images from docker hub</p>
<p>I am going with the global image for this article.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h3><span class="ez-toc-section" id="Creating_a_Kubernetes_Deployment_Manifest_Yaml_file">Creating a Kubernetes Deployment Manifest Yaml file</span></h3>
<p>Our Container images are ready and we can use the images in our Kubernetes Deployment manifest.</p>
<p>Rather than using the POD manifest, Deployment kind has various advantages including the creation of replication controller,  application roll-out, pod replacement etc</p>
<p><code>Deployment</code> is the ideal way to deploy Microservices to Production Kubernetes</p>
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: #eaeef3 none repeat scroll 0% 0%; color: #000000;"><span class="hljs-attr" style="color: #5c2699;">apiVersion:</span> apps/v1
<span class="hljs-attr" style="color: #5c2699;">kind:</span> Deployment
<span class="hljs-attr" style="color: #5c2699;">metadata:</span>
<span class="hljs-attr" style="color: #5c2699;">  name:</span> myapp-dpl
<span class="hljs-attr" style="color: #5c2699;">  namespace:</span> development
<span class="hljs-attr" style="color: #5c2699;">  labels:</span>
<span class="hljs-attr" style="color: #5c2699;">    app:</span> myapp
<span class="hljs-attr" style="color: #5c2699;">spec:</span>
<span class="hljs-attr" style="color: #5c2699;">  replicas:</span> <span class="hljs-number" style="color: #1c00cf;">1</span>
<span class="hljs-attr" style="color: #5c2699;">  selector:</span>
<span class="hljs-attr" style="color: #5c2699;">    matchLabels:</span>
<span class="hljs-attr" style="color: #5c2699;">      app:</span> myapp
<span class="hljs-attr" style="color: #5c2699;">  template:</span>
<span class="hljs-attr" style="color: #5c2699;">    metadata:</span>
<span class="hljs-attr" style="color: #5c2699;">      labels:</span>
<span class="hljs-attr" style="color: #5c2699;">        environment:</span> DEV
<span class="hljs-attr" style="color: #5c2699;">        managedby:</span> K8s
<span class="hljs-attr" style="color: #5c2699;">        app:</span> myapp
<span class="hljs-attr" style="color: #5c2699;">    spec:</span>
<span class="hljs-attr" style="color: #5c2699;">      containers:</span>

      <span class="hljs-comment" style="color: #006a00;"># Primary Container</span>
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> tomcat
<span class="hljs-attr" style="color: #5c2699;">        image:</span>  saravak/tomcat8
<span class="hljs-attr" style="color: #5c2699;">        volumeMounts:</span>
<span class="hljs-attr" style="color: #5c2699;">          - name:</span> applog
<span class="hljs-attr" style="color: #5c2699;">            mountPath:</span> /opt/tomcat/webapps/ROOT/WEB-INF/log/
<span class="hljs-attr" style="color: #5c2699;">          - name:</span> tomcatlog
<span class="hljs-attr" style="color: #5c2699;">            mountPath:</span> /opt/tomcat/logs
<span class="hljs-attr" style="color: #5c2699;">        ports:</span>
<span class="hljs-attr" style="color: #5c2699;">        - containerPort:</span> <span class="hljs-number" style="color: #1c00cf;">8080</span>
<span class="hljs-attr" style="color: #5c2699;">        resources:</span>
<span class="hljs-attr" style="color: #5c2699;">          limits:</span>
<span class="hljs-attr" style="color: #5c2699;">            memory:</span> <span class="hljs-number" style="color: #1c00cf;">1028</span>Mi

      <span class="hljs-comment" style="color: #006a00;"># This is for FluentD Logging Container</span>
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> fluentd
<span class="hljs-attr" style="color: #5c2699;">        env:</span>
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> FLUENT_UID
<span class="hljs-attr" style="color: #5c2699;">          value:</span> root
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> FLUENT_CONF
<span class="hljs-attr" style="color: #5c2699;">          value:</span> fluent.conf
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> FLUENTD_ARGS
<span class="hljs-attr" style="color: #5c2699;">          value:</span> -c /fluentd/etc/fluent.conf
<span class="hljs-attr" style="color: #5c2699;">        image:</span> saravak/fluentd:elastic
<span class="hljs-attr" style="color: #5c2699;">        volumeMounts:</span>
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> applog
<span class="hljs-attr" style="color: #5c2699;">          mountPath:</span> /opt/tomcat/webapps/ROOT/WEB-INF/log/
<span class="hljs-attr" style="color: #5c2699;">        - name:</span>  fdconf
<span class="hljs-attr" style="color: #5c2699;">          mountPath:</span>  /fluentd/etc/

<span class="hljs-attr" style="color: #5c2699;">      volumes:</span>
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> applog
<span class="hljs-attr" style="color: #5c2699;">        emptyDir:</span> {}
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> tomcatlog
<span class="hljs-attr" style="color: #5c2699;">        emptyDir:</span> {}
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> fdconf
<span class="hljs-attr" style="color: #5c2699;">        configMap:</span>
<span class="hljs-attr" style="color: #5c2699;">          name:</span> fluentdconf</pre>
<p>&nbsp;</p>
<p>In the preceding manifest file, we are creating an application named <code>myapp</code> with two containers under the <code>development</code> namespace</p>
<p>The container names are <code>tomcat</code> and <code>fluentd</code> and the latter one is our primary objective here</p>
<p>For fluentd to function properly we need to pass a few values during the container startup such as</p>
<ul>
<li><code>FLUENT_UID</code> &#8211; to define what user the fluent should start</li>
<li><code>FLUENT_CONF</code> &#8211; represents the configuration file name</li>
<li><code>FLUENTD_ARGS</code> &#8211; to define the fully qualified path of the <code>fluent.conf</code> file while starting the fluent with <code>-c</code> flag</li>
</ul>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h3><span class="ez-toc-section" id="Volumes_and_Volume_Mounts">Volumes and Volume Mounts</span></h3>
<p><a href="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM.png"><img class="post-img alignnone wp-image-6517 size-full lazyload" src="../../wp-content/ewww/lazy/placeholder-640x427.png" alt="Kubernetes FluentD Tomcat" width="640" height="427" data-src="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM.png" loading="lazy" data-srcset="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM.png 640w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-300x200.png 300w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-120x80.png 120w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-360x240.png 360w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-600x400.png 600w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-480x320.png 480w" data-sizes="auto" /><noscript><img class="post-img alignnone wp-image-6517 size-full" src="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM.png" alt="Kubernetes FluentD Tomcat" width="640" height="427" srcset="../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM.png 640w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-300x200.png 300w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-120x80.png 120w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-360x240.png 360w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-600x400.png 600w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-29-at-9.58.46-PM-480x320.png 480w" sizes="(max-width: 640px) 100vw, 640px" data-eio="l" /></noscript></a></p>
<p>Another important item in our deployment manifest YAML file is <code>volumes</code>  and<code>Volume_mounts</code></p>
<p>you can notice that we are creating three volumes named <code>applog</code>, <code>tomcatlog</code> and <code>fdconf</code></p>
<ul>
<li><code>applog</code> &#8211; an empty Directory volume to share the application logs directory between Tomcat and FluentD</li>
<li><code>tomcatlog</code> &#8211; an empty Directory volume to share the tomcat logs directory between Tomcat and fluentD</li>
<li><code>configMap</code> &#8211; ConfigMap type of volume to inject config data into the POD. in our case it is a file content stored in configMap</li>
</ul>
<p>These volumes would be mounted with the help of <code>volumeMounts</code> within the containers Tomcat and FluentD.</p>
<p>When the volume is being mounted. It can be mounted to any physical location/path. This is similar to the Unix mounts.</p>
<p>Just to keep things clean I am using the same path on both containers. but it is not necessary.</p>
<p>the <code>applog</code> and <code>tomcatlogs</code> volumes should be mounted to the location specified in the <code>fluent.conf</code> file and it should match.</p>
<h3></h3>
<h3><span class="ez-toc-section" id="Deploying_our_YAML_for_Kubernetes_FluentD_Sidecar_setup">Deploying our YAML for Kubernetes FluentD Sidecar setup</span></h3>
<p>So far we have seen how Kubernetes FluentD sidecar container is setup and the necessary elements like ConfigMap, Volume etc</p>
<p>Here I have collected all these codes and compiled as a single file with one addition.</p>
<p>Just to make my application available externally and to expose it, I have added a <code>service</code> to my final YAML file and I can deploy it right now to Kubernetes cluster</p>
<p>This is the complete file with <strong>ConfigMap + Service + Deployment</strong></p>
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: #eaeef3 none repeat scroll 0% 0%; color: #000000;"><span class="hljs-attr" style="color: #5c2699;">---
apiVersion:</span> v1
<span class="hljs-attr" style="color: #5c2699;">kind:</span> ConfigMap
<span class="hljs-attr" style="color: #5c2699;">metadata:</span>
<span class="hljs-attr" style="color: #5c2699;">  name:</span> fluentdconf
<span class="hljs-attr" style="color: #5c2699;">  namespace:</span> development
<span class="hljs-attr" style="color: #5c2699;">data:</span>
  fluent.conf: <span class="hljs-string" style="color: #c41a16;">|
      &lt;source&gt;
        @type tail
        time_key time
        format multiline
        format_firstline /^\[[[A-Z]|\s]+\]/
        format1 /^\[(?&lt;LogLevel&gt;[[A-Z]|\s]+)\]\[(?&lt;time&gt;[0-9]{4}-[0-9]{2}-[0-9]{2}\s[0-9]{2}\:[0-9]{2}\:[0-9]{2}\,[0-9]{3})\]\s-\s(?&lt;message&gt;.*+)$/
        path /opt/tomcat/webapps/ROOT/WEB-INF/log/myapp.log
        pos_file /tmp/myapp.log.pos
        tag dev.myapp.applogs
      &lt;/source&gt;

      &lt;filter dev.myapp.applogs&gt;
        @type record_transformer
        &lt;record&gt;
        hostname ${hostname}
        &lt;/record&gt;
      &lt;/filter&gt;

      &lt;match dev.myapp.applogs&gt;
        @type elasticsearch
        host 172.99.1.218
        port 59200
        user elasticusr
        password Pa$$w0rd
        index_name fluentd.${tag}
        logstash_format true
        logstash_prefix dev.myapp.applogs
        flush_interval 1s
      &lt;/match&gt;

      &lt;source&gt;
        @type tail
        path /opt/tomcat/logs/localhost_access_log.%Y-%m-%d.txt
        pos_file /tmp/tomcataccesslog.pos
        tag dev.myapp.tomcatlogs
        format apache2
      &lt;/source&gt;

      &lt;filter dev.myapp.tomcatlogs&gt;
        @type record_transformer
        &lt;record&gt;
        hostname ${hostname}
        &lt;/record&gt;
      &lt;/filter&gt;

      &lt;match dev.myapp.tomcatlogs&gt;
        @type elasticsearch
        host 172.99.1.218
        port 59200
        user elasticusr
        password Pa$$w0rd
        logstash_format true
        logstash_prefix dev.myapp.tomcatlogs
      &lt;/match&gt;

---
</span><span class="hljs-attr" style="color: #5c2699;">kind:</span> Service
<span class="hljs-attr" style="color: #5c2699;">apiVersion:</span> v1
<span class="hljs-attr" style="color: #5c2699;">metadata:</span>
<span class="hljs-attr" style="color: #5c2699;">  name:</span>  myapp-svc
<span class="hljs-attr" style="color: #5c2699;">  namespace:</span> development
<span class="hljs-attr" style="color: #5c2699;">  labels:</span>
<span class="hljs-attr" style="color: #5c2699;">    app:</span> myapp
<span class="hljs-attr" style="color: #5c2699;">spec:</span>
<span class="hljs-attr" style="color: #5c2699;">  selector:</span>
<span class="hljs-attr" style="color: #5c2699;">    app:</span>  myapp
<span class="hljs-attr" style="color: #5c2699;">  type:</span> NodePort
<span class="hljs-attr" style="color: #5c2699;">  ports:</span>
<span class="hljs-attr" style="color: #5c2699;">  - port:</span>  <span class="hljs-number" style="color: #1c00cf;">80</span>
<span class="hljs-attr" style="color: #5c2699;">    targetPort:</span>  <span class="hljs-number" style="color: #1c00cf;">8080</span>
<span class="hljs-meta" style="color: #1c00cf;">
---</span>
<span class="hljs-attr" style="color: #5c2699;">apiVersion:</span> apps/v1
<span class="hljs-attr" style="color: #5c2699;">kind:</span> Deployment
<span class="hljs-attr" style="color: #5c2699;">metadata:</span>
<span class="hljs-attr" style="color: #5c2699;">  name:</span> myapp-dpl
<span class="hljs-attr" style="color: #5c2699;">  namespace:</span> development
<span class="hljs-attr" style="color: #5c2699;">  labels:</span>
<span class="hljs-attr" style="color: #5c2699;">    app:</span> myapp
<span class="hljs-attr" style="color: #5c2699;">spec:</span>
<span class="hljs-attr" style="color: #5c2699;">  replicas:</span> <span class="hljs-number" style="color: #1c00cf;">1</span>
<span class="hljs-attr" style="color: #5c2699;">  selector:</span>
<span class="hljs-attr" style="color: #5c2699;">    matchLabels:</span>
<span class="hljs-attr" style="color: #5c2699;">      app:</span> myapp
<span class="hljs-attr" style="color: #5c2699;">  template:</span>
<span class="hljs-attr" style="color: #5c2699;">    metadata:</span>
<span class="hljs-attr" style="color: #5c2699;">      labels:</span>
<span class="hljs-attr" style="color: #5c2699;">        environment:</span> DEV
<span class="hljs-attr" style="color: #5c2699;">        managedby:</span> K8s
<span class="hljs-attr" style="color: #5c2699;">        app:</span> myapp
<span class="hljs-attr" style="color: #5c2699;">    spec:</span>
<span class="hljs-attr" style="color: #5c2699;">      containers:</span>

      <span class="hljs-comment" style="color: #006a00;"># Primary Container</span>
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> tomcat
<span class="hljs-attr" style="color: #5c2699;">        image:</span>  saravak/tomcat8
<span class="hljs-attr" style="color: #5c2699;">        volumeMounts:</span>
<span class="hljs-attr" style="color: #5c2699;">          - name:</span> applog
<span class="hljs-attr" style="color: #5c2699;">            mountPath:</span> /opt/tomcat/webapps/ROOT/WEB-INF/log/
<span class="hljs-attr" style="color: #5c2699;">          - name:</span> tomcatlog
<span class="hljs-attr" style="color: #5c2699;">            mountPath:</span> /opt/tomcat/logs
<span class="hljs-attr" style="color: #5c2699;">        ports:</span>
<span class="hljs-attr" style="color: #5c2699;">        - containerPort:</span> <span class="hljs-number" style="color: #1c00cf;">8080</span>
<span class="hljs-attr" style="color: #5c2699;">        resources:</span>
<span class="hljs-attr" style="color: #5c2699;">          limits:</span>
<span class="hljs-attr" style="color: #5c2699;">            memory:</span> <span class="hljs-number" style="color: #1c00cf;">1028</span>Mi

      <span class="hljs-comment" style="color: #006a00;"># This is for FluentD Logging Container</span>
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> fluentd
<span class="hljs-attr" style="color: #5c2699;">        env:</span>
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> FLUENT_UID
<span class="hljs-attr" style="color: #5c2699;">          value:</span> root
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> FLUENT_CONF
<span class="hljs-attr" style="color: #5c2699;">          value:</span> fluent.conf
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> FLUENTD_ARGS
<span class="hljs-attr" style="color: #5c2699;">          value:</span> -c /fluentd/etc/fluent.conf
<span class="hljs-attr" style="color: #5c2699;">        image:</span> saravak/fluentd:elastic
<span class="hljs-attr" style="color: #5c2699;">        volumeMounts:</span>
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> applog
<span class="hljs-attr" style="color: #5c2699;">          mountPath:</span> /opt/tomcat/webapps/ROOT/WEB-INF/log/
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> tomcatlog
<span class="hljs-attr" style="color: #5c2699;">          mountPath:</span> /opt/tomcat/logs
<span class="hljs-attr" style="color: #5c2699;">        - name:</span>  fdconf
<span class="hljs-attr" style="color: #5c2699;">          mountPath:</span>  /fluentd/etc/

      <span class="hljs-comment" style="color: #006a00;"># Logrotating containers:</span>
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> LogRotate
<span class="hljs-attr" style="color: #5c2699;">        image:</span> saravak/logrotatek8s
<span class="hljs-attr" style="color: #5c2699;">        volumeMounts:</span>
<span class="hljs-attr" style="color: #5c2699;">        - name:</span> tomcatlog
<span class="hljs-attr" style="color: #5c2699;">          mountPath:</span> /logs/

<span class="hljs-attr" style="color: #5c2699;">      volumes:</span>
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> applog
<span class="hljs-attr" style="color: #5c2699;">        emptyDir:</span> {}
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> tomcatlog
<span class="hljs-attr" style="color: #5c2699;">        emptyDir:</span> {}
<span class="hljs-attr" style="color: #5c2699;">      - name:</span> fdconf
<span class="hljs-attr" style="color: #5c2699;">        configMap:</span>
<span class="hljs-attr" style="color: #5c2699;">          name:</span> fluentdconf</pre>
<p>I save this entire configuration file as <code>myapp-deployment.yml</code> and creating a deployment using kubectl</p>
<pre>kubectl create -f myapp-deployment.yml</pre>
<p>You can also use</p>
<pre>kubectl apply -f myapp-deployment.yml</pre>
<p>&nbsp;</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h3><span class="ez-toc-section" id="Validating_Kubernetes_FluentD_and_Tomcat_Containers_in_POD">Validating Kubernetes FluentD and Tomcat Containers in POD</span></h3>
<p>After creating the deployment. Once you get the message &#8220;deployment created&#8221; in your terminal.</p>
<p>You can give it a few seconds for the POD to get created and check if the pod is ready</p>
<p><span style="color: #000080;"><strong>Check if the pod is created and running with 2 containers</strong></span></p>
<pre># kubectl get podsNAME                       READY STATUS  RESTARTS AGE
myapp-dpl-5f5bf998c7-m4p79 2/2   Running 0        128d</pre>
<p>you can see the status is <code>Running</code> and both fluentd and tomcat containers are ready</p>
<p>If you see anything other than <code>2/2</code> it means an issue with container startup. One of the containers might have failed.</p>
<p>&nbsp;</p>
<p><span style="color: #000080;"><strong>Container wise status<br />
</strong></span></p>
<p>If you have <code>jq</code> installed in your terminal. you can parse the kubectl output and display a container-wise status like this along with their name.</p>
<pre><code id="&quot;precode">✗ kubectl get pods myapp-dpl-5f5bf998c7-m4p79 -o json|jq '.status.containerStatuses[] |{Name: .name, Status: .state} '
{
  "Name": "fluentd",
  "Status": {
    "running": {
      "startedAt": "2020-11-16T18:44:40Z"
    }
  }
}
{
  "Name": "tomcat",
  "Status": {
    "running": {
      "startedAt": "2020-11-16T18:44:40Z"
    }
  }
}</code></pre>
<p>&nbsp;</p>
<p><span style="color: #003366;"><strong>Describe pod to know more information</strong></span></p>
<p>If you need to more information about your POD like the volume names and the volume mount names etc</p>
<p>you can use the following command</p>
<pre><code>kubectl describe <code id="&quot;precode">myapp-dpl-5f5bf998c7-m4p79</code></code></pre>
<p>&nbsp;</p>
<p><strong><span style="color: #003366;">Check the logs of Kubernetes fluentD container for any Error</span><br />
</strong></p>
<p>Just to make sure there are no connectivity issues and FluentD is able to connect to the Elastic Search server at the remote.</p>
<p>We need to check the logs of fluentd container running inside the pod</p>
<pre><code>kubectl logs <code id="&quot;precode">myapp-dpl-5f5bf998c7-m4p79 fluentd</code></code></pre>
<p>Since there are two containers in the POD, you have to explicitely mention the pod name after the POD name.</p>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Validating_the_arrival_of_the_logs_at_Elastic">Validating the arrival of the logs at Elastic</span></h3>
<p>Now you can log in to Kibana dashboard and validate if you are able to see the logs coming in</p>
<p>The hostname on each event would match your POD name</p>
<p><a href="../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM.png"><img class="post-img alignnone wp-image-6521 size-full lazyload" src="../../wp-content/ewww/lazy/placeholder-1920x659.png" alt="Kubernetes FluentD Sidecar" width="1920" height="659" data-src="../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM.png" loading="lazy" data-srcset="../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM.png 1920w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM-300x103.png 300w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM-1024x351.png 1024w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM-768x264.png 768w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM-1536x527.png 1536w" data-sizes="auto" /><noscript><img class="post-img alignnone wp-image-6521 size-full" src="../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM.png" alt="Kubernetes FluentD Sidecar" width="1920" height="659" srcset="../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM.png 1920w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM-300x103.png 300w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM-1024x351.png 1024w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM-768x264.png 768w, ../../wp-content/uploads/2020/11/Screenshot-2020-11-30-at-2.11.09-AM-1536x527.png 1536w" sizes="(max-width: 1920px) 100vw, 1920px" data-eio="l" /></noscript></a></p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Conclusion">Conclusion</span></h2>
<p>Hope this article helps you to understand a few concepts like Sidecar container and our primary objective of collecting and shipping the logs to Elastic Search has also been achieved.</p>
<p>Kubernetes FluentD &#8211; EFK logging is really efficient and microservices ready and this would be helpful in various other microservice setups as well.</p>
<p>If you have any questions or tips to make this article better. Please feel free to let me know in comments</p>
<a href="../../wp-content/uploads/2021/09/DaaS.svg"><img class="post-img lazyload" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1047 415'%3E%3C/svg%3E" alt="gritfy" width="1047" height="415" class="post-img lazyload" data-src="../../wp-content/uploads/2021/09/DaaS.svg" loading="lazy" /><noscript><img class="post-img" src="../../wp-content/uploads/2021/09/DaaS.svg" alt="gritfy" width="1047" height="415" class="alignnone size-full wp-image-6623" data-eio="l" /></noscript></a>
<p>&nbsp;</p>
<p>Cheers<br />
Rumen Lishkov</p>
<div id="postfollow">
<a href='https://ko-fi.com/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==' border='0' alt='Buy Me a Coffee at ko-fi.com' data-src="https://az743702.vo.msecnd.net/cdn/kofi3.png?v=2" loading="lazy" class="lazyload" /><noscript><img height='46' style='border:0px;height:46px;width: 186px' src='https://az743702.vo.msecnd.net/cdn/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' data-eio="l" /></noscript></a>
<p>Follow us on<a href="https://www.facebook.com/rumenlishkov">Facebook</a> or<a href="https://www.twitter.com/mwinventory">Twitter</a>
</br>
For more practical videos and tutorials. <a href="https://www.youtube.com/kiss2mark">Subscribe to our channel</a>
</br>
Find me on Linkedin <a href="https://www.linkedin.com/in/rumen-lishkov/">My Profile</a>
</br>
</i>For any Consultation or to hire us <a href="../../cdn-cgi/l/email-protection.html#99f1fcf5f5f6d9feebf0edffe0b7faf6f4"> <span class="__cf_email__" data-cfemail="0e666b6262614e697c677a6877206d6163">[email&#160;protected]</span></a>
</br>
If you like this article. Show your Support! <a href="https://ko-fi.com/middlewareinventory">Buy me a Coffee.</a>
</br>
</p>
<p style="color: palevioletred !important;">Signup for Exclusive "Subscriber-only" Content</p>
<div class="emaillist">
<form action="#" method="post" class="es_subscription_form es_shortcode_form" id="es_subscription_form_1657192312" data-source="ig-es">
<div class="es-field-wrap"><label>Name*<br /><input type="text" name="name" class="ig_es_form_field_name" placeholder="" value="" required="required" /></label></div><div class="es-field-wrap"><label>Email*<br /><input class="es_required_field es_txt_email ig_es_form_field_email" type="email" name="email" value="" placeholder="" required="required" /></label></div><input type="hidden" name="lists[]" value="1" /><input type="hidden" name="form_id" value="3" />
<input type="hidden" name="es_email_page" value="5805" />
<input type="hidden" name="es_email_page_url" value="https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" />
<input type="hidden" name="status" value="Unconfirmed" />
<input type="hidden" name="es-subscribe" id="es-subscribe" value="915ddf1a10" />
<label style="position:absolute;top:-99999px;left:-99999px;z-index:-99;"><input type="email" name="es_hp_email" class="es_required_field" tabindex="-1" autocomplete="-1" value="" /></label>
<input type="submit" name="submit" class="es_subscription_form_submit es_submit_button es_textbox_button" id="es_subscription_form_submit_1657192312" value="Subscribe" />
<span class="es_spinner_image" id="spinner-image"><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Loading" data-src="../../wp-content/plugins/email-subscribers/lite/public/images/spinner.gif" loading="lazy" class="lazyload" /><noscript><img src="../../wp-content/plugins/email-subscribers/lite/public/images/spinner.gif" alt="Loading" data-eio="l" /></noscript></span>
</form>
<span class="es_subscription_message" id="es_subscription_message_1657192312"></span>
</div>
</div>
<hr>
<div class='rp4wp-related-posts'>
<h3>More from Middleware Inventory</h3>
<ul>
<li><div class='rp4wp-related-post-image'>
<a href='../deploy-tomcat-kubernetes/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="Tomcat Kubernetes" data-src="../../wp-content/uploads/2020/09/Screenshot-2020-09-29-at-8.55.24-PM-150x150.jpg" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2020/09/Screenshot-2020-09-29-at-8.55.24-PM-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Tomcat Kubernetes" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../deploy-tomcat-kubernetes/index.html'>How to Deploy Tomcat on Kubernetes Step by Step</a><p>Overview In this post, we are going to see how to deploy tomcat on Kubernetes.&nbsp; How to Deploy Tomcat based web application into Kubernetes. We are taking Google Cloud - Kubernetes Engine (GKE) for our example and creating our Kubernetes Cluster with 3 nodes You can do all these steps&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../set-heapmemory-jvm-arguments-tomcat/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" data-src="../../wp-content/uploads/2019/01/Screen-Shot-2019-01-31-at-3.46.40-PM-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/01/Screen-Shot-2019-01-31-at-3.46.40-PM-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../set-heapmemory-jvm-arguments-tomcat/index.html'>How to set HeapMemory or JVM Arguments in Tomcat</a><p>The Overview In this post, we are going to explore how and where to configure the heap memory in tomcat&nbsp;servlet container ( application server).&nbsp; How and where to set the XMX and XMS values for your Tomcat JVM and where to configure the different GC policies like Parallel GC, Concurrent&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../jenkins-tomcat-deploy-deploying-application-tomcat-using-jenkins/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" data-src="../../wp-content/uploads/2019/07/Screenshot-2019-07-02-at-5.39.23-PM-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/07/Screenshot-2019-07-02-at-5.39.23-PM-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../jenkins-tomcat-deploy-deploying-application-tomcat-using-jenkins/index.html'>Jenkins Tomcat Deploy - Deploying Application to Tomcat using Jenkins</a><p>In this post, we are going to look at the steps required to configure the Jenkins and Tomcat and achieve Continuous Deployment and Continuous Integration. Jenkins Tomcat Deploy We are going to see how to pull the code from the Source Code Management Repository -&nbsp; GITHUB and deploy it to&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../docker-tomcat-example-dockerfile-sample/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="Docker tomcat Container" data-src="../../wp-content/uploads/2019/04/ContainerSky-150x150.jpeg" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/04/ContainerSky-150x150.jpeg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Docker tomcat Container" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../docker-tomcat-example-dockerfile-sample/index.html'>Docker Tomcat Example - Dockerfile for Tomcat, Docker Tomcat Image</a><p>In this post, we are going to learn how to install a Tomcat Application Server or Web Container on Docker and Deploy web applications into the Tomcat running inside Docker.&nbsp; This post is all about Docker Tomcat and deploying war web application into tomcat docker, Sample Docker Tomcat image, Dockerfile&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../kubernetes-ingress-example/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" data-src="../../wp-content/uploads/2020/02/ting-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2020/02/ting-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../kubernetes-ingress-example/index.html'>Kubernetes Ingress Example on Google Cloud</a><p>Kubernetes Ingress We understand that as per traditional infrastructure setup, in order to load balance the client requests you are required to configure instances for each application you want to balance the load, which makes your configuration lengthy, and when moving this architecture to open source technologies it will be&hellip;</p></div>
</li>
</ul>
</div>
</div>
<footer class="entry-footer">
<div class="entry-tags clearfix">
<span class="meta-tags">
<a href="../tag/fluent-bit-kubernetes-example/index.html" rel="tag">fluent bit kubernetes example</a><a href="../tag/kubernetes-fluentd/index.html" rel="tag">kubernetes fluentd</a> </span>
</div>
<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="../cpu-and-memory-consuming-java-webapp-for-testing/index.html" rel="prev"><span class="screen-reader-text">Previous Post:</span>CPU and Memory consuming Java WebApp &#8211; For testing</a></div><div class="nav-next"><a href="../weblogic-jms-queue-creation-wlst-script-and-ansible-playbook/index.html" rel="next"><span class="screen-reader-text">Next Post:</span>Weblogic JMS Queue Creation WLST script and Ansible Playbook</a></div></div>
</nav>
</footer>
</article>
<div id="disqus_thread"></div>
</main>
</section>
<section id="secondary" class="sidebar widget-area clearfix" role="complementary">
<aside id="custom_html-18" class="widget_text widget widget_custom_html clearfix"><div class="textwidget custom-html-widget"><script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3398911159151128" crossorigin="anonymous"></script>


<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div></aside><aside id="categories-8" class="widget widget_categories clearfix"><div class="widget-header"><h3 class="widget-title">Categories</h3></div>
<ul>
<li class="cat-item cat-item-61"><a href="../category/activemq/index.html">ActiveMQ</a> (4)
</li>
<li class="cat-item cat-item-98"><a href="../category/ansible/index.html">Ansible</a> (65)
</li>
<li class="cat-item cat-item-10"><a href="../category/apache/index.html">Apache</a> (8)
</li>
<li class="cat-item cat-item-234"><a href="../category/aws/index.html">AWS</a> (28)
</li>
<li class="cat-item cat-item-452"><a href="../category/azure/index.html">Azure</a> (1)
</li>
<li class="cat-item cat-item-8"><a href="../category/best-practice/index.html">Best Practice</a> (5)
</li>
<li class="cat-item cat-item-390"><a href="../category/bitbucket/index.html">BitBucket</a> (1)
</li>
<li class="cat-item cat-item-426"><a href="../category/boto/index.html">Boto</a> (1)
</li>
<li class="cat-item cat-item-399"><a href="../category/cloud/index.html" title="Cloud is not only a concept but also a practice of using a network of remote servers hosted on the Internet to store, manage, and process data.">Cloud</a> (1)
</li>
<li class="cat-item cat-item-397"><a href="../category/database/index.html">Database</a> (1)
</li>
<li class="cat-item cat-item-95"><a href="../category/development/index.html">Development</a> (3)
</li>
<li class="cat-item cat-item-152"><a href="../category/docker/index.html">Docker</a> (11)
</li>
<li class="cat-item cat-item-422"><a href="../category/efk/index.html">EFK</a> (1)
</li>
<li class="cat-item cat-item-423"><a href="../category/elastic-search/index.html">Elastic Search</a> (1)
</li>
<li class="cat-item cat-item-59"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a> (6)
</li>
<li class="cat-item cat-item-419"><a href="../category/fluentd/index.html">FluentD</a> (2)
</li>
<li class="cat-item cat-item-424"><a href="../category/gcp-googlecloud/index.html">GCP &#8211; GoogleCloud</a> (1)
</li>
<li class="cat-item cat-item-450"><a href="../category/github-actions/index.html">Github Actions</a> (1)
</li>
<li class="cat-item cat-item-428"><a href="../category/grafana/index.html">Grafana</a> (1)
</li>
<li class="cat-item cat-item-275"><a href="../category/graphite/index.html">Graphite</a> (1)
</li>
<li class="cat-item cat-item-441"><a href="../category/ibm-cloud/index.html">IBM Cloud</a> (1)
</li>
<li class="cat-item cat-item-401"><a href="../category/ibm-websphere/index.html" title="IBM® WebSphere® Application Server provides a range of flexible and secure runtime for Java enterprise applications, lightweight web applications and microservices. You can create new applications and enhance and optimize existing application infrastructure on premises or across any public, private or hybrid cloud. In addition, by utilizing IBM Cloud Private, you can create on-premises cloud capabilities similar to public clouds to accelerate app development. The platform is built on the open source Kubernetes-based container architecture and supports both Docker containers and Cloud Foundry.">IBM Websphere</a> (2)
</li>
<li class="cat-item cat-item-354"><a href="../category/ihs-and-apache/index.html">IHS and Apache</a> (10)
</li>
<li class="cat-item cat-item-353"><a href="../category/iis/index.html">IIS</a> (4)
</li>
<li class="cat-item cat-item-388"><a href="../category/javascript/index.html">JavaScript</a> (3)
</li>
<li class="cat-item cat-item-286"><a href="../category/jenkins/index.html">Jenkins</a> (4)
</li>
<li class="cat-item cat-item-15"><a href="../category/joomla/index.html">Joomla</a> (1)
</li>
<li class="cat-item cat-item-151"><a href="../category/kubernetes/index.html">Kubernetes</a> (16)
</li>
<li class="cat-item cat-item-191"><a href="../category/middleware/index.html">Middleware</a> (3)
</li>
<li class="cat-item cat-item-322"><a href="../category/network-troubleshooting/index.html">Network Troubleshooting</a> (1)
</li>
<li class="cat-item cat-item-413"><a href="../category/networking/index.html">Networking</a> (1)
</li>
<li class="cat-item cat-item-273"><a href="../category/nodejs/index.html">NodeJS</a> (2)
</li>
<li class="cat-item cat-item-396"><a href="../category/office365/index.html">Office365</a> (1)
</li>
<li class="cat-item cat-item-148"><a href="../category/opensource/index.html">OpenSource</a> (2)
</li>
<li class="cat-item cat-item-417"><a href="../category/oracle-db/index.html">Oracle DB</a> (3)
</li>
<li class="cat-item cat-item-404"><a href="../category/oracle-weblogic/index.html" title="WebLogic is a leading Application Server product most widely used for e-commerce online transaction processing (OLTP) platform application, developed to connect users in a distributed computing environment and to facilitate the integration of mainframe applications with distributed corporate data and applications.">Oracle Weblogic</a> (2)
</li>
<li class="cat-item cat-item-232"><a href="../category/packer/index.html">Packer</a> (2)
</li>
<li class="cat-item cat-item-146"><a href="../category/perl/index.html">Perl</a> (1)
</li>
<li class="cat-item cat-item-60"><a href="../category/php/index.html">PHP</a> (1)
</li>
<li class="cat-item cat-item-453"><a href="../category/postgresql/index.html">PostgreSQL</a> (1)
</li>
<li class="cat-item cat-item-343"><a href="../category/powershell/index.html">PowerShell</a> (1)
</li>
<li class="cat-item cat-item-31"><a href="../category/weblogic/problemsolution/index.html">problem/solution</a> (8)
</li>
<li class="cat-item cat-item-427"><a href="../category/prometheus/index.html">Prometheus</a> (1)
</li>
<li class="cat-item cat-item-445"><a href="../category/pulumi/index.html">Pulumi</a> (1)
</li>
<li class="cat-item cat-item-285"><a href="../category/python-flask/index.html">Python Flask</a> (1)
</li>
<li class="cat-item cat-item-22"><a href="../category/python_scripts/index.html">python_scripts</a> (7)
</li>
<li class="cat-item cat-item-446"><a href="../category/redis/index.html">Redis</a> (1)
</li>
<li class="cat-item cat-item-451"><a href="../category/serverless/index.html">Serverless</a> (1)
</li>
<li class="cat-item cat-item-12"><a href="../category/shell-scripting/index.html">Shell Scripting</a> (6)
</li>
<li class="cat-item cat-item-125"><a href="../category/soap-web-services/index.html">SOAP Web Services</a> (1)
</li>
<li class="cat-item cat-item-13"><a href="../category/splunk/index.html">Splunk</a> (1)
</li>
<li class="cat-item cat-item-425"><a href="../category/sre/index.html">SRE</a> (1)
</li>
<li class="cat-item cat-item-274"><a href="../category/statsd/index.html">StatsD</a> (1)
</li>
<li class="cat-item cat-item-233"><a href="../category/terraform/index.html">Terraform</a> (12)
</li>
<li class="cat-item cat-item-35"><a href="../category/tomcat/index.html">tomcat</a> (7)
</li>
<li class="cat-item cat-item-147"><a href="../category/tools/index.html">tools</a> (5)
</li>
<li class="cat-item cat-item-391"><a href="../category/traefik/index.html">Traefik</a> (1)
</li>
<li class="cat-item cat-item-124"><a href="../category/troubleshooting/index.html">Troubleshooting</a> (3)
</li>
<li class="cat-item cat-item-1"><a href="../category/uncategorized/index.html">Uncategorized</a> (5)
</li>
<li class="cat-item cat-item-7"><a href="../category/unix/index.html">Unix</a> (5)
</li>
<li class="cat-item cat-item-99"><a href="../category/vagrant/index.html">Vagrant</a> (4)
</li>
<li class="cat-item cat-item-389"><a href="../category/vuejs/index.html">VueJS</a> (2)
</li>
<li class="cat-item cat-item-356"><a href="../category/vulnerabilities-fixes/index.html">Vulnerabilities &amp; Fixes</a> (21)
</li>
<li class="cat-item cat-item-21"><a href="../category/weblogic/index.html">weblogic</a> (51)
</li>
<li class="cat-item cat-item-9"><a href="../category/webserver/index.html">Webserver</a> (1)
</li>
<li class="cat-item cat-item-92"><a href="../category/websphere/index.html">Websphere</a> (8)
</li>
<li class="cat-item cat-item-321"><a href="../category/windows-server/index.html">Windows Server</a> (5)
</li>
<li class="cat-item cat-item-55"><a href="../category/wlst/index.html">wlst</a> (7)
</li>
<li class="cat-item cat-item-36"><a href="../category/wordpress/index.html">wordpress</a> (2)
</li>
<li class="cat-item cat-item-4"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a> (1)
</li>
</ul>
</aside><aside id="media_image-5" class="widget widget_media_image clearfix"><img width="267" height="400" src="../../wp-content/ewww/lazy/placeholder-267x400.png" class="image wp-image-8825  attachment-full size-full lazyload" alt="write for devopsjunction" style="max-width: 75%; height: auto;" data-src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" loading="lazy" data-srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" data-sizes="auto" /><noscript><img width="267" height="400" src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" class="image wp-image-8825  attachment-full size-full" alt="write for devopsjunction" style="max-width: 75%; height: auto;" srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" sizes="(max-width: 267px) 100vw, 267px" data-eio="l" /></noscript></aside>
</section>
</div>
<div id="footer" class="footer-wrap">
<footer id="colophon" class="site-footer container clearfix" role="contentinfo">
<div id="footer-text" class="site-info">
<span class="credit-link">Powered by <a href="../../index.html" title="Rumen Lishkov">Rumen Lishkov</a> and <a href="https://rumen.free.bg/" title="Studio-1">Studio1 Sofia</a> </span>
</div>
</footer>
</div>
</div>
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@mwinventory" />
<meta name="twitter:creator" content="@mwinventory" />
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&amp;display=swap" rel="stylesheet"><div class="simplesocialbuttons simplesocial-round-icon simplesocialbuttons-float-left-center post-5805 post  ssb_counter-activate simplesocialbuttons-slide-bottom-in">
<button class="simplesocial-fb-share" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Facebook </span> <span class="ssb_counter ssb_fbshare_counter">0</span></button>
<button class="simplesocial-twt-share" data-href="https://twitter.com/share?text=Kubernetes+Sidecar+%E2%80%93+Logging+with+FluentD+to+EFK&url=https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Twitter</span> <span class="ssb_counter ssb_twitter_counter">0</span></button>
<button target="popup" class="simplesocial-linkedin-share" data-href="https://www.linkedin.com/cws/share?url=https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">LinkedIn</span></button>
<button onclick="javascript:window.location.href = this.dataset.href;return false;" class="simplesocial-email-share" data-href="mailto:?subject=Kubernetes+Sidecar+%E2%80%93+Logging+with+FluentD+to+EFK&body=https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/"><span class="simplesocialtxt">Email</span></button>
<button onclick="javascript:window.open(this.dataset.href, '_blank' );return false;" class="simplesocial-whatsapp-share" data-href="https://web.whatsapp.com/send?text=https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/"><span class="simplesocialtxt">WhatsApp</span></button>
</div>
<script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' id='disqus_count-js-extra'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"mwinventory"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f8767.js"></script>
<script type='text/javascript' id='disqus_embed-js-extra'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.22"},"disqusIdentifier":"5805 https:\/\/www.middlewareinventory.com\/?p=5805","disqusShortname":"mwinventory","disqusTitle":"Kubernetes Sidecar \u2013 Logging with FluentD to EFK","disqusUrl":"https:\/\/www.middlewareinventory.com\/blog\/kubernetes-sidecar-logging-with-fluentd-to-efk\/","postId":"5805"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/bccbc.js"></script>
<script type='text/javascript' id='dae-download-js-extra'>
/* <![CDATA[ */
var objDaeDownload = {"ajaxUrl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"2019084a26"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/8510d.js"></script>
<script type='text/javascript' id='socialsnap-js-js-extra'>
/* <![CDATA[ */
var socialsnap_script = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","on_media_width":"250","on_media_height":"250","nonce":"b4d440853b","post_id":"5805"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/fef55.js"></script>
<script type='text/javascript' id='aicp-js-extra'>
/* <![CDATA[ */
var AICP = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"0b980bed5f","ip":"193.173.113.122","clickLimit":"1","clickCounterCookieExp":"3","banDuration":"7","countryBlockCheck":"No","banCountryList":"RU"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/ff9fe.js"></script>
<script type='text/javascript' src='https://js.stripe.com/v3/?ver=2.03' id='stripe-js'></script>
<script type='text/javascript' id='q2w3_fixed_widget-js-extra'>
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"q2w3-default-sidebar","margin_top":10,"margin_bottom":0,"stop_id":"","screen_max_width":1026,"screen_max_height":0,"width_inherit":true,"refresh_interval":1500,"window_load_hook":false,"disable_mo_api":false,"widgets":["text-32"]}];
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f2bcf.js"></script>
<script type='text/javascript' id='enlighterjs-js-after'>
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"enlighter","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
</script>
<script src="../../wp-content/cache/minify/129c2.js"></script>
<script type='text/javascript' id='ez-toc-js-js-extra'>
/* <![CDATA[ */
var ezTOC = {"smooth_scroll":"1","visibility_hide_by_default":"","width":"100%","scroll_offset":"30"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/0c713.js"></script>
<div id="ss-copy-popup" class="ss-popup-overlay">
<div class="ss-popup">
<div class="ss-popup-heading">
<span>Copy link</span>
<a href="#" id="ss-close-share-networks-modal" class="ss-close-modal" rel="nofollow"><i class="ss ss-close"></i></a>
</div>
<div class="ss-popup-content">
<div class="ss-copy-action">
<input type="text" readonly="readonly" value="https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/" class="ss-copy-action-field" />
<a href="#" class="ss-button" rel="nofollow">Copy<span class="ss-share-network-tooltip">Copied</span></a>
<i class="ss ss-copy"></i>
</div>
<div class="ss-powered-by">Powered by <a href="https://socialsnap.com/?utm_source=WordPress&amp;utm_medium=link&amp;utm_campaign=inthewild" target="_blank" rel="nofollow noopener"><i class="ss ss-socialsnap"></i>Social Snap</a></div>
</div>
</div>
</div>
<script type="text/javascript">
		document.addEventListener("DOMContentLoaded", function() {
			var if_ssb_exist = document.getElementsByClassName( "simplesocialbuttons" ).length > 0;
			if (if_ssb_exist) {
				var ssb_admin_ajax = 'https://www.middlewareinventory.com/wp-admin/admin-ajax.php';
				var ssb_post_id = 5805 ;
				var ssb_post_url = 'https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/';
				var ssb_alternate_post_url = 'https://airdata.gitlab.io/blog/blog/kubernetes-sidecar-logging-with-fluentd-to-efk/';
				jQuery( document ).ready(function(){
				var is_ssb_used = jQuery('.simplesocialbuttons');
				if( is_ssb_used ) {

					var data = {
					'action': 'ssb_fetch_data',
					'postID': ssb_post_id
				};
					jQuery.post(ssb_admin_ajax, data, function(data, textStatus, xhr) {
						var array = JSON.parse(data);
						jQuery.each( array, function( index, value ){

							if( index == 'total' ){
								jQuery('.ssb_'+ index +'_counter').html(value + '<span>Shares</span>');
							}else{
								jQuery('.ssb_'+ index +'_counter').html(value);
							}
						});

					});
				}
				})

			//ssbPlugin.fetchFacebookShares();
			}
		});

		</script><script type='text/javascript'>function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script> 
<script type="text/javascript">

			var SocialSnapURL 				= window.location.href;
			var SocialSnapShareCacheExpired = 1;
				
			if ( -1 !== SocialSnapURL.indexOf('?ss_cache_refresh') ) {

				SocialSnapShareCacheExpired = true;

			} else {

				var SocialSnapServerTimestamp 	= 1657192312;
				var SocialSnapBrowserTimestamp 	= Date.now();

				if ( ! SocialSnapBrowserTimestamp ) {
					SocialSnapBrowserTimestamp = new Date().getTime();
				}

				SocialSnapBrowserTimestamp = Math.floor( SocialSnapBrowserTimestamp / 1000 );

				SocialSnapShareCacheExpired = SocialSnapShareCacheExpired && ( SocialSnapBrowserTimestamp - SocialSnapServerTimestamp < 60 );
			}

		</script>

<div id="cookie-notice" role="banner" class="cn-bottom bootstrap" style="color: #fff; background-color: #000;"><div class="cookie-notice-container"><span id="cn-notice-text">We use cookies to ensure that we give you the best experience on our website. The Cookies collected are used only to Show customized Ads. We Hope you are fine with it.</span><a href="#" id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button bootstrap button">Ok</a><a href="#" id="cn-refuse-cookie" data-cookie-set="refuse" class="cn-set-cookie cn-button bootstrap button">No</a><a href="../../cookie-policy/index.html" target="_blank" id="cn-more-info" class="cn-more-info cn-button bootstrap button">Privacy policy</a>
</div>
<div class="cookie-notice-revoke-container"><a href="#" class="cn-revoke-cookie cn-button bootstrap button">Revoke cookies</a></div>
</div>
</body>
</html>
