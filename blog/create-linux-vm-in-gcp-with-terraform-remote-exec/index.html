<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">
<link rel="pingback" href="https://www.middlewareinventory.com/xmlrpc.php">

<title>Terraform google_compute_instance Example - with Remote Exec | Devops Junction</title>
<meta name="description" content="How to create GCP VM with Terraform and remote execute shell script or inline commands to provision the machine and install software products. Terraform GCP remote exec example." />
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<link rel="canonical" href="index.html" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Terraform google_compute_instance Example - with Remote Exec | Devops Junction" />
<meta property="og:description" content="How to create GCP VM with Terraform and remote execute shell script or inline commands to provision the machine and install software products. Terraform GCP remote exec example." />
<meta property="og:url" content="https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="article:publisher" content="http://www.facebook.com/devopsjunc" />
<meta property="article:published_time" content="2021-02-12T22:20:57+00:00" />
<meta property="article:modified_time" content="2022-05-20T16:13:11+00:00" />
<meta property="og:image" content="../../wp-content/uploads/2021/02/gcp-image.png" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="416" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@mwinventory" />
<meta name="twitter:site" content="@mwinventory" />
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://www.middlewareinventory.com/#organization","name":"Middleware Inventory","url":"https://www.middlewareinventory.com/","sameAs":["http://www.facebook.com/devopsjunc","https://www.youtube.com/channel/UCRuqBFM6ioWwviNJkgOjeWw","https://twitter.com/mwinventory"],"logo":{"@type":"ImageObject","@id":"https://www.middlewareinventory.com/#logo","inLanguage":"en-US","url":"https://www.middlewareinventory.com/wp-content/uploads/2020/09/Screenshot-2020-09-18-at-3.49.40-AM.jpg","width":300,"height":107,"caption":"Middleware Inventory"},"image":{"@id":"https://www.middlewareinventory.com/#logo"}},{"@type":"WebSite","@id":"https://www.middlewareinventory.com/#website","url":"https://www.middlewareinventory.com/","name":"Devops Junction","description":"An inventory of [i]nformation, Middleware and much more.","publisher":{"@id":"https://www.middlewareinventory.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":"https://www.middlewareinventory.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/#primaryimage","inLanguage":"en-US","url":"../../wp-content/uploads/2021/02/gcp-image.png","width":1000,"height":416,"caption":"gcp vm terraform"},{"@type":"WebPage","@id":"https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/#webpage","url":"https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/","name":"Terraform google_compute_instance Example - with Remote Exec | Devops Junction","isPartOf":{"@id":"https://www.middlewareinventory.com/#website"},"primaryImageOfPage":{"@id":"https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/#primaryimage"},"datePublished":"2021-02-12T22:20:57+00:00","dateModified":"2022-05-20T16:13:11+00:00","description":"How to create GCP VM with Terraform and remote execute shell script or inline commands to provision the machine and install software products. Terraform GCP remote exec example.","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/"]}]},{"@type":"Article","@id":"https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/#article","isPartOf":{"@id":"https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/#webpage"},"author":{"@id":"https://www.middlewareinventory.com/#/schema/person/050bf13e27b309d29d1bda45c4eb3147"},"headline":"Terraform google_compute_instance Example &#8211; with Remote Exec","datePublished":"2021-02-12T22:20:57+00:00","dateModified":"2022-05-20T16:13:11+00:00","mainEntityOfPage":{"@id":"https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/#webpage"},"commentCount":0,"publisher":{"@id":"https://www.middlewareinventory.com/#organization"},"image":{"@id":"https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/#primaryimage"},"articleSection":"Cloud,GCP - GoogleCloud,Terraform","inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/#respond"]}]},{"@type":"Person","@id":"https://www.middlewareinventory.com/#/schema/person/050bf13e27b309d29d1bda45c4eb3147","name":"Rumen Lishkov","image":{"@type":"ImageObject","@id":"https://www.middlewareinventory.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g","caption":"Rumen Lishkov"}}]}</script>

<link rel='dns-prefetch' href='https://js.stripe.com' />
<link rel='dns-prefetch' href='https://fonts.googleapis.com' />
<link rel='dns-prefetch' href='https://s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Feed" href="../../feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Comments Feed" href="../../comments/feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Terraform google_compute_instance Example &#8211; with Remote Exec Comments Feed" href="feed/index.rss" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BE71V6F634"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BE71V6F634');
</script>

<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.middlewareinventory.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.5.6"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/404f7.css" media="all" />
<style id='ez-toc-inline-css' type='text/css'>div#ez-toc-container p.ez-toc-title {font-size: 120%;}div#ez-toc-container p.ez-toc-title {font-weight: 500;}div#ez-toc-container ul li {font-size: 95%;}div#ez-toc-container {width: 100%;}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/f854f.css" media="all" />
<link rel='stylesheet' id='poseidon-default-fonts-css' href='https://fonts.googleapis.com/css?family=Ubuntu%3A400%2C400italic%2C700%2C700italic%7CRaleway%3A400%2C700&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel="stylesheet" href="../../wp-content/cache/minify/88e5e.css" media="all" />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/www.middlewareinventory.com","hash_tracking":"false"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1058f.js"></script>
<script type='text/javascript' id='cookie-notice-front-js-extra'>
/* <![CDATA[ */
var cnArgs = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","hideEffect":"fade","onScroll":"no","onScrollOffset":"100","cookieName":"cookie_notice_accepted","cookieValue":"true","cookieTime":"2592000","cookiePath":"\/","cookieDomain":"","redirection":"","cache":"1","refuse":"yes","revoke_cookies":"0","revoke_cookies_opt":"automatic","secure":"1"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/545b0.js"></script>
<script type='text/javascript' id='email-subscribers-js-extra'>
/* <![CDATA[ */
var es_data = {"messages":{"es_empty_email_notice":"Please enter email address","es_rate_limit_notice":"You need to wait for sometime before subscribing again","es_single_optin_success_message":"Successfully Subscribed.","es_email_exists_notice":"Email Address already exists!","es_unexpected_error_notice":"Oops.. Unexpected error occurred.","es_invalid_email_notice":"Invalid email address","es_try_later_notice":"Please try after some time"},"es_ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1de0a.js"></script>
<script type='text/javascript' id='ssb-front-js-js-extra'>
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"3d8661396b"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/268e7.js"></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://www.middlewareinventory.com/wp-content/themes/poseidon/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<script type='text/javascript' id='poseidon-post-slider-js-extra'>
/* <![CDATA[ */
var poseidon_slider_params = {"animation":"slide","speed":"7000"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/51af3.js"></script>
<script type='text/javascript' id='eio-lazy-load-js-extra'>
/* <![CDATA[ */
var eio_lazy_vars = {"exactdn_domain":"","skip_autoscale":"0"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/28f5b.js"></script>
<link rel="https://api.w.org/" href="../../wp-json/index.json" /><link rel="alternate" type="application/json" href="../../wp-json/wp/v2/posts/6743.json" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php-rsd.xml" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.middlewareinventory.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 5.5.6" />
<link rel='shortlink' href='index.html' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-create-linux-vm-in-gcp-with-terraform-remote-exec-.json" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-create-linux-vm-in-gcp-with-terraform-remote-exec-&amp;format=xml.xml" />
<link href='https://fonts.googleapis.com/css?family=Strait:100,200,300,400,500,600,700,800,900&amp;subset=arabic,vietnamese,hebrew,thai,bengali,latin,latin-ext,cyrillic,cyrillic-ext,greek' rel='stylesheet' type='text/css'><style>a.idcore-button,a.idcore-button:visited{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:hover,a.idcore-button:focus{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:active{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}</style><script>var idcore_ajax_url = "https://www.middlewareinventory.com/wp-admin/admin-ajax.php";</script> <style media="screen">/*inline margin*/
	
	
	
	
	
	
			 /*margin-digbar*/

	
	
	
	
	   div[class*="simplesocialbuttons-float"].simplesocialbuttons.simplesocial-round-icon button{
	 margin: ;
   }
	
	
	
</style>

<meta property="og:title" content="Terraform google_compute_instance Example &#8211; with Remote Exec - Middleware Inventory" />
<meta property="og:description" content="In this article, we are going to see how to create a Linux Virtual machine and provision it using the Terraform remote execution strategy.

We are going to be using SSH method to connect to the Virtual machine and provision it on the go by executing some startup Shell script.

We would also be discussing how to copy a file to the" />
<meta property="og:url" content="https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="og:image" content="../../wp-content/uploads/2021/02/gcp-image.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="In this article, we are going to see how to create a Linux Virtual machine and provision it using the Terraform remote execution strategy.

We are going to be using SSH method to connect to the Virtual machine and provision it on the go by executing some startup Shell script.

We would also be discussing how to copy a file to the" />
<meta name="twitter:title" content="Terraform google_compute_instance Example &#8211; with Remote Exec - Middleware Inventory" />
<meta property="twitter:image" content="../../wp-content/uploads/2021/02/gcp-image.png" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
<noscript><style>.lazyload[data-src]{display:none !important;}</style></noscript><style type="text/css" id="sns_global_styles">/* for mobile */
@media screen and (max-width: 480px) {
    #text-23 {
        display:none !important;
    }
	p,li
    {
      font-size: 20px !important;
      color: #333 !important;
      line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li a
    {
    	font-size: 20px !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  
  #afc_sidebar_4348 
{
  height: 8vh; 
  max-height: 8vh; 
  background-color: transparent;
}
}

/* for Desktop */
@media screen and (min-width: 500px) {
#afc_sidebar_4348 
{
  height: 10vh; 
  max-height: 10vh; 
  background-color: transparent;
}
  #text-23 {
        display:none !important;
    }
	p,li
    {
        font-size: 20px !important;
        color: #333 !important;
        line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  

}

.es_lablebox {
    padding-bottom: 3px;
    color: steelblue !important;
    font-weight: bold !important;
}
.widget-title span {
    line-height: 2.2;
    color: steelblue !important;
}
.sidey {
	padding: 0;
}
.sumome-contactform 
{
  display: none;
}
code { 
    font-family: courier;
    font-size: 18px;
    padding: 2px;
    background-color: #f1f1f1;
    /*box-shadow: 0 2px 4px 0 rgba(0,0,0,0.16),0 2px 10px 0 rgba(0,0,0,0.12)!important;*/
    
}

.syntaxhighlighter {
    font-size: 14px !important;
}

pre {
 font-family: Menlo, Monaco, Consolas, "Courier New", monospace !important;
}

.black-red-border
{
    border-left: 3px solid;
    background-color: black;
    color: ghostwhite;
    border-left-color: red;
} 
}

#wpdevar_comment_1 span
{
  font-family:  "Open Sans", Helvetica, Arial, sans-serif !important;
  font-size: 20px !important;
  color: #1495b5 !important;
}

#wpdevar_comment_1 
{
  margin-top: 50px;
  margin-bottom: 30px;
}

summary
{
 color: steelblue; 
}

blockquote
{
  border-left-color: #cc0f77 !important;
  border-left-width: 4px !important;
  border-left-style: solid !important;
  background-color: #f5f5f5 !important;
}

.rp4wp-related-post-image{ width: auto !important; }

.main-navigation-menu
{
  float: none !important;
}

.primary-navigation
{
  float: none !important
}

body,html{
  /* font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

.page-title, .entry-title, .site-title, .main-navigation-menu a, .widget-title
{
  /*font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

#postfollow {
  background: whitesmoke;
  padding-top: 5%;
  padding-bottom: 5%;
  padding-left: 2%;
}
div#ez-toc-container p.ez-toc-title {
    font-weight: bold;
    font-size: 24px !important;
}
div#ez-toc-container {
    margin-bottom: 15%;
}

</style><link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.middlewareinventory.com/wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-270x270.png" />
<style type="text/css">div.enlighter{
  font-size: 1.1em;  
}
article h2
{
    background-color: #29558c;
    color: white;
    padding-left: 1%;
    border-left: 15px solid crimson;
    font-weight: 400;
    font-size: 22px;
}
blockquote {
    padding: 2%;
    background-color: none !important;
}
pre
{
  display: block; 
  overflow-x: auto; 
  padding-left: 2em;
  padding-top: 3em;
  padding-bottom: 3em;
  background: #eaeef3 none repeat scroll 0% 0%; 
  color: #00193a;
}
article h3
{
    background-color: whitesmoke;
    color: black;
    padding-left: 1%;
    border-left: 10px solid black;
    font-weight: 400;
    font-size: 22px;
}
li {
    padding: 2px;
    margin-left: 2%;
}
code
{
  color: black;
}
blockquote {
    padding: 2%;
    background-color: none !important;
}
div.enlighter{
  font-size: 1.2em;  
}
.enlighter-default {
    font-family: Menlo, Monaco, Consolas, "Courier New", monospace !important;
}
</style>
<style type="text/css" id="wp-custom-css">.site-title
{
   font-size: 24px !important;
}		</style>
</head>
<body class="post-template-default single single-post postid-6743 single-format-standard wp-custom-logo cookies-not-set elementor-default">
<div id="page" class="hfeed site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<div id="header-top" class="header-bar-wrap"></div>
<header id="masthead" class="site-header clearfix" role="banner">
<div class="header-main container clearfix">
<div id="logo" class="site-branding clearfix">
<a href="../../index.html" class="custom-logo-link" rel="home"><img width="300" height="107" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 107'%3E%3C/svg%3E" class="custom-logo lazyload" alt="Middleware Inventory" data-src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" loading="lazy" /><noscript><img width="300" height="107" src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" class="custom-logo" alt="Middleware Inventory" data-eio="l" /></noscript></a>
<p class="site-title"></p>
</div>
<nav id="main-navigation" class="primary-navigation navigation clearfix" role="navigation">
<ul id="menu-primary-menu" class="main-navigation-menu"><li id="menu-item-172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-172"><a href="https://airdata.github.io/">About Me</a></li>
<li id="menu-item-3206" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-3206"><a href="../category/middleware/index.html">Middleware</a>
<ul class="sub-menu">
<li id="menu-item-1518" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1518"><a href="../category/weblogic/index.html">weblogic</a></li>
<li id="menu-item-3207" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3207"><a href="../category/was/index.html">WAS</a></li>
<li id="menu-item-3208" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3208"><a href="../category/websphere/index.html">Websphere</a></li>
<li id="menu-item-3209" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3209"><a href="../category/wlst/index.html">wlst</a></li>
<li id="menu-item-3210" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3210"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a></li>
<li id="menu-item-3211" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3211"><a href="../category/jms/index.html">JMS</a></li>
<li id="menu-item-3212" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3212"><a href="../category/activemq/index.html">ActiveMQ</a></li>
<li id="menu-item-3213" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3213"><a href="../category/troubleshooting/index.html">Troubleshooting</a></li>
<li id="menu-item-3214" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3214"><a href="../category/apache/index.html">Apache</a></li>
<li id="menu-item-3215" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3215"><a href="../category/best-practice/index.html">Best Practice</a></li>
<li id="menu-item-3222" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3222"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a></li>
</ul>
</li>
<li id="menu-item-3157" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3157"><a href="../../devops-junction/index.html">Devops</a>
<ul class="sub-menu">
<li id="menu-item-1513" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1513"><a href="../category/ansible/index.html">Ansible</a></li>
<li id="menu-item-3216" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3216"><a href="../category/aws/index.html">AWS</a></li>
<li id="menu-item-3217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3217"><a href="../category/docker/index.html">Docker</a></li>
<li id="menu-item-3218" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3218"><a href="../category/packer/index.html">Packer</a></li>
<li id="menu-item-3219" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3219"><a href="../category/splunk/index.html">Splunk</a></li>
<li id="menu-item-3220" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-3220"><a href="../category/terraform/index.html">Terraform</a></li>
<li id="menu-item-3221" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3221"><a href="../category/vagrant/index.html">Vagrant</a></li>
<li id="menu-item-3223" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3223"><a href="../category/kubernetes/index.html">Kubernetes</a></li>
</ul>
</li>
<li id="menu-item-8820" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8820"><a href="../../newsletter/index.html">Newsletter</a></li>
<li id="menu-item-8821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8821"><a href="https://rumen.free.bg/#contact">Book a Consultation</a></li>
</ul> </nav>
</div>
</header>
<div id="content" class="site-content container clearfix">
<section id="primary" class="content-area">
<main id="main" class="site-main" role="main">

<article id="post-6743" class="post-6743 post type-post status-publish format-standard has-post-thumbnail hentry category-cloud category-gcp-googlecloud category-terraform wpautop">
<header class="entry-header">
<h1 class="entry-title">Terraform google_compute_instance Example &#8211; with Remote Exec</h1>
<div class="entry-meta"><span class="meta-date"> Updated on: <a href="index.html" title="3:50 am" rel="bookmark"><time class="entry-date published updated" datetime="May 20, 2022">May 20, 2022</time></a></span><span class="meta-author"> <span class="author vcard"><a class="url fn n" href="../author/admin/index.html" title="View all posts by Rumen Lishkov" rel="author">Rumen Lishkov</a></span></span></div>
</header>
<div class="entry-content clearfix">
<div class="ss-inline-share-wrapper ss-left-inline-content ss-small-icons ss-with-spacing ss-rounded-icons">
<div class="ss-inline-share-content">
<ul class="ss-social-icons-container">
<li class="">
<a href="#" data-ss-ss-link="https://www.facebook.com/sharer.php?t=Terraform%20google_compute_instance%20Example%20%E2%80%93%20with%20Remote%20Exec&u=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fcreate-linux-vm-in-gcp-with-terraform-remote-exec%2F" class="ss-facebook-color" rel="nofollow" data-ss-ss-network-id="facebook" data-ss-ss-post-id="6743" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" data-ss-ss-type="share" data-has-api="true">
<span class="ss-share-network-content">
<i class="ss ss-facebook"></i>
<span class="ss-network-count">
0
</span>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://twitter.com/intent/tweet?text=Terraform+google_compute_instance+Example+%E2%80%93+with+Remote+Exec&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fcreate-linux-vm-in-gcp-with-terraform-remote-exec%2F" class="ss-twitter-color" rel="nofollow" data-ss-ss-network-id="twitter" data-ss-ss-post-id="6743" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-twitter"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://www.linkedin.com/shareArticle?title=Terraform%20google_compute_instance%20Example%20%E2%80%93%20with%20Remote%20Exec&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fcreate-linux-vm-in-gcp-with-terraform-remote-exec%2F&mini=true" class="ss-linkedin-color" rel="nofollow" data-ss-ss-network-id="linkedin" data-ss-ss-post-id="6743" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-linkedin"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="mailto:?body=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fcreate-linux-vm-in-gcp-with-terraform-remote-exec%2F&subject=Terraform%20google_compute_instance%20Example%20%E2%80%93%20with%20Remote%20Exec" class="ss-envelope-color" rel="nofollow" data-ss-ss-network-id="envelope" data-ss-ss-post-id="6743" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-envelope"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="#" class="ss-copy-color" rel="nofollow" data-ss-ss-network-id="copy" data-ss-ss-post-id="6743" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-copy"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<p>In this article, <strong>we are going to see how to create a Linux Virtual machine and provision it using the Terraform remote execution</strong> strategy.</p>
<p>We are going to be using SSH method to connect to the Virtual machine and provision it on the go by executing some startup Shell script.</p>
<p>We would also be discussing how to copy a file to the Linux machine during the creation and use it for provisioning.</p>
<p><a href="../../wp-content/uploads/2021/02/gcp-image.png"><img class="alignnone size-full wp-image-6782 lazyload" src="../../wp-content/ewww/lazy/placeholder-1000x416.png" alt="gcp vm terraform" width="1000" height="416" data-src="../../wp-content/uploads/2021/02/gcp-image.png" loading="lazy" data-srcset="../../wp-content/uploads/2021/02/gcp-image.png 1000w, ../../wp-content/uploads/2021/02/gcp-image-300x125.png 300w, ../../wp-content/uploads/2021/02/gcp-image-768x319.png 768w" data-sizes="auto" /><noscript><img class="alignnone size-full wp-image-6782" src="../../wp-content/uploads/2021/02/gcp-image.png" alt="gcp vm terraform" width="1000" height="416" srcset="../../wp-content/uploads/2021/02/gcp-image.png 1000w, ../../wp-content/uploads/2021/02/gcp-image-300x125.png 300w, ../../wp-content/uploads/2021/02/gcp-image-768x319.png 768w" sizes="(max-width: 1000px) 100vw, 1000px" data-eio="l" /></noscript></a></p>
<p>This would give you an idea of how to install software packages or products during the server creation and get it ready.</p>
<p>In this article, we will be using some Shell commands and Shell scripts as our provisioner. Our next article is on the making with Ansible playbook.</p>
<p>Stay connected and Let&#8217;s jump right into the objective.</p>
<p>If you have used GCP, you know that google cloud (gcp) <code>gcloud</code> CLI  is indispensable for administration and management.</p>
<p>So I presume that you have <code>gcloud</code> already installed and your profile is set up. If not, please <a href="https://cloud.google.com/sdk/docs/install">read the article</a> on how to set up <code>gcloud</code> before proceeding further.</p>
<p>For those of you wondering what to do by having a <code>google-key.json</code> file.</p>
<p>You can read this article on <a href="https://cloud.google.com/sdk/docs/authorizing">how to init gcloud with JSON</a></p>
<p>&nbsp;</p>
<h2></h2>
<div id="ez-toc-container" class="counter-hierarchy counter-decimal ez-toc-grey">
<div class="ez-toc-title-container">
<p class="ez-toc-title">Table of Contents</p>
<span class="ez-toc-title-toggle"><a class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle"><i class="ez-toc-glyphicon ez-toc-icon-toggle"></i></a></span></div>
<nav><ul class="ez-toc-list"><li><a href="#Connecting_to_GCP_with_Gcloud" title="Connecting to GCP with Gcloud">Connecting to GCP with Gcloud</a></li><li><a href="#Enabling_Compute_Engine_API" title="Enabling Compute Engine API">Enabling Compute Engine API</a></li><li><a href="#Creating_Terraform_configuration_files" title="Creating Terraform configuration files">Creating Terraform configuration files</a></li><li><a href="#Decoding_the_Terraform_manifest_file_maintf" title="Decoding the Terraform manifest file main.tf">Decoding the Terraform manifest file main.tf</a><ul><li><a href="#provider_block_Start_the_gcp_environment" title="provider block &#8211; Start the gcp environment">provider block &#8211; Start the gcp environment</a></li><li><a href="#compute_firewall_block_Allow_SSH_and_HTTPS_connections" title="compute firewall block &#8211; Allow SSH and HTTP[S] connections">compute firewall block &#8211; Allow SSH and HTTP[S] connections</a></li><li><a href="#compute_address_block_Reserving_public_IP" title="compute address block &#8211; Reserving public IP">compute address block &#8211; Reserving public IP</a></li><li><a href="#compute_instance_block_Creating_VM_and_provision_with_Shell_commands" title="compute instance block &#8211; Creating VM and provision with Shell commands">compute instance block &#8211; Creating VM and provision with Shell commands</a></li></ul></li><li><a href="#Creating_VM_and_provision_with_Shell_script_Remote_Exec" title="Creating VM and provision with Shell script &#8211; Remote Exec">Creating VM and provision with Shell script &#8211; Remote Exec</a></li><li><a href="#How_to_download_this_terraform_project_from_Github" title="How to download this terraform project from Github.">How to download this terraform project from Github.</a></li></ul></nav></div>
<h2><span class="ez-toc-section" id="Connecting_to_GCP_with_Gcloud">Connecting to GCP with Gcloud</span></h2>
<p>Let&#8217;s create a fresh google cloud project</p>
<pre>$ gcloud projects create devopsjunction
Create in progress for [https://cloudresourcemanager.googleapis.com/v1/projects/devopsjunction].
Waiting for [operations/cp.8362603842155049958] to finish...done.
Enabling service [cloudapis.googleapis.com] on project [devopsjunction]...
Operation "operations/acf.p2-187067084280-818341eb-70b2-47c1-8ad2-253a172c23e1" finished successfully.</pre>
<p>Set the project</p>
<pre>$ gcloud config set project devopsjunction</pre>
<p>Create a service account</p>
<pre>$ gcloud iam service-accounts create dj-serviceaccount --description="service account for terraform" --display-name="terraform_service_account"
</pre>
<p>To verify if the service account has been created successfully. use the following command to list the service-accounts in the current project.</p>
<pre>$ gcloud iam service-accounts list</pre>
<p>Next step is to create google key JSON file for this service account and this would help in connecting the terraform with Google Cloud.</p>
<pre>$ gcloud iam service-accounts keys create ~/google-key.json --iam-account <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="34505e19475146425d57515557575b415a40745051425b44475e415a57405d5b5a1a5d55591a53475146425d57515557575b415a401a575b59">[email&#160;protected]</a>

created key [a3ac3ab7eaf76d0355bcd12b1060100a47753043] of type [json] as [/Users/sarav/google-key.json] for [<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="b2d6d89fc1d7c0c4dbd1d7d3d1d1ddc7dcc6f2d6d7c4ddc2c1d8c7dcd1c6dbdddc9cdbd3df9cd5c1d7c0c4dbd1d7d3d1d1ddc7dcc69cd1dddf">[email&#160;protected]</a>]</pre>
<p>As you can see in the preceding snippet, it would create a new key file named <code>google-key.json</code></p>
<blockquote><p> this JSON file is going to help us authenticate with Google cloud and enable us to integrate any automation tools like Terraform, Ansible to the GCP.</p></blockquote>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Enabling_Compute_Engine_API">Enabling Compute Engine API</span></h2>
<p>Before we proceed to create a Virtual machine. we must do some prerequisite</p>
<p>We need to enable <code>Compute Engine API</code>  by visiting the APIs in Google Cloud console</p>
<p>Google Cloud has lot of APIs and they help us in managing and automating the GCP infrastructure.</p>
<p>For compute Engine.</p>
<p>you can use this URL and replace the project ID field with your valid project ID. it would directly take you there</p>
<pre>https://console.developers.google.com/apis/library/compute.googleapis.com?project=&lt;your project id&gt;</pre>
<p>It may ask you to set the billing account. (or) choose the billing account</p>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2><span class="ez-toc-section" id="Creating_Terraform_configuration_files">Creating Terraform configuration files</span></h2>
<p>Once all done with Gcloud. Our next task is to create the terraform configuration files.</p>
<p>Our terraform manifest is going to create few resources for us, I have listed them here.</p>
<ul>
<li><strong>google_compute_firewall | firewall</strong> &#8211; this is to allow port 22 for SSH to the public ( set it to single IP for security purposes)</li>
<li><strong>google_compute_firewall | webserverrule</strong> &#8211; this is to create a firewall rule to allow port 80 and 443 required by NGINX</li>
<li><strong>google_compute_address | static</strong> &#8211; this is to reserve Static External IP for the VM we are about to create</li>
<li><strong>google_compute_instance | dev</strong> &#8211; this is where we are creating a virtual machine</li>
</ul>
<p>These are all <code>terraform</code> resources, to know more about each of them you can use the <a href="https://registry.terraform.io/">terraform registry.</a></p>
<p>Here is the main terraform configuration file with the aforementioned resources.</p>
<p>Copy the following content and save in the name of <code>main.tf</code></p>
<pre class="EnlighterJSRAW" data-enlighter-language="json" data-enlighter-theme="bootstrap4" data-enlighter-linenumbers="false">provider "google" {
  project = var.project
  region  = var.region
}

resource "google_compute_firewall" "firewall" {
  name    = "gritfy-firewall-externalssh"
  network = "default"

  allow {
    protocol = "tcp"
    ports    = ["22"]
  }

  source_ranges = ["0.0.0.0/0"] # Not So Secure. Limit the Source Range
  target_tags   = ["externalssh"]
}

resource "google_compute_firewall" "webserverrule" {
  name    = "gritfy-webserver"
  network = "default"

  allow {
    protocol = "tcp"
    ports    = ["80","443"]
  }

  source_ranges = ["0.0.0.0/0"] # Not So Secure. Limit the Source Range
  target_tags   = ["webserver"]
}

# We create a public IP address for our google compute instance to utilize
resource "google_compute_address" "static" {
  name = "vm-public-address"
  project = var.project
  region = var.region
  depends_on = [ google_compute_firewall.firewall ]
}


resource "google_compute_instance" "dev" {
  name         = "devserver"
  machine_type = "f1-micro"
  zone         = "${var.region}-a"
  tags         = ["externalssh","webserver"]

  boot_disk {
    initialize_params {
      image = "centos-cloud/centos-7"
    }
  }

  network_interface {
    network = "default"

    access_config {
      nat_ip = google_compute_address.static.address
    }
  }

  provisioner "remote-exec" {
    connection {
      host        = google_compute_address.static.address
      type        = "ssh"
      user        = var.user
      timeout     = "500s"
      private_key = file(var.privatekeypath)
    }

    inline = [
      "sudo yum -y install epel-release",
      "sudo yum -y install nginx",
      "sudo nginx -v",
    ]
  }

  # Ensure firewall rule is provisioned before server, so that SSH doesn't fail.
  depends_on = [ google_compute_firewall.firewall, google_compute_firewall.webserverrule ]

  service_account {
    email  = var.email
    scopes = ["compute-ro"]
  }

  metadata = {
    ssh-keys = "${var.user}:${file(var.publickeypath)}"
  }
}</pre>
<p>&nbsp;</p>
<p>In terraform variable declaration is necessary and all the variables must be declared.</p>
<p>Copy the following content and save in the name of <code>variables.tf</code></p>
<pre class="EnlighterJSRAW" data-enlighter-language="json" data-enlighter-theme="bootstrap4">variable "region" {
    type = string
    default = "us-central"
}
variable "project" {
    type = string
}

variable "user" {
    type = string
}

variable "email" {
    type = string
}
variable "privatekeypath" {
    type = string
    default = "~/.ssh/id_rsa"
}

variable "publickeypath" {
    type = string
    default = "~/.ssh/id_rsa.pub"
}</pre>
<p>&nbsp;</p>
<p>while this variable declaration can be done in the main.tf file itself.  It is always a good practice to maintain a dedicated file, matching their purpose.</p>
<ul>
<li> Variable declaration &#8211; <strong>variables.tf</strong></li>
<li> Output specification &#8211; <strong>outputs.tf</strong></li>
<li> Provider related configuration &#8211; <strong>providers.tf</strong></li>
<li> Providers and their version dependencies &#8211; <strong>versions.tf</strong></li>
</ul>
<p>There is a one more file we need to create. that is <code>terraform.tfvars</code> file</p>
<p>This is to give values to the variables we have declared in the variables.tf file</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">project = "devopsjunction"
region = "us-central1"
user = "middlewareinvetory_gmail_com" # this should match the username set by the OS Login
email = "<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="c3a7a9eeb0a6b1b5aaa0a6a2a0a0acb6adb783a7a6b5acb3b0a9b6ada0b7aaacadedaaa2aeeda4b0a6b1b5aaa0a6a2a0a0acb6adb7eda0acae">[email&#160;protected]</a>"
</pre>
<p>You might notice that we are not defining values for all the variables ,we have declared in the <code>variables.tf</code> file.</p>
<p>It is because some of these variables have their default values configured in the <code>variables.tf</code> file itself using the <code>default</code> block.</p>
<p>In fact, there are more ways to assign values to variable. as shown in the following picture</p>
<p>&nbsp;</p>
<p><a href="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-10.48.59-PM.png"><img class="alignnone size-full wp-image-6769 lazyload" src="../../wp-content/ewww/lazy/placeholder-800x380.png" alt="" width="800" height="380" data-src="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-10.48.59-PM.png" loading="lazy" data-srcset="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-10.48.59-PM.png 800w, ../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-10.48.59-PM-300x143.png 300w, ../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-10.48.59-PM-768x365.png 768w" data-sizes="auto" /><noscript><img class="alignnone size-full wp-image-6769" src="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-10.48.59-PM.png" alt="" width="800" height="380" srcset="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-10.48.59-PM.png 800w, ../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-10.48.59-PM-300x143.png 300w, ../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-10.48.59-PM-768x365.png 768w" sizes="(max-width: 800px) 100vw, 800px" data-eio="l" /></noscript></a></p>
<p>&nbsp;</p>
<p>back to the topic,  Now we have created all the Terraform configuration files required for us to create our Google compute engine &#8211; Virtual machine.</p>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2><span class="ez-toc-section" id="Decoding_the_Terraform_manifest_file_maintf">Decoding the Terraform manifest file main.tf</span></h2>
<p>Before we proceed to create the Infrastrcuture, I must explain what is configured and what should be the expected result.</p>
<p>Let us review each block in the <code>main.tf</code> file</p>
<h3><span class="ez-toc-section" id="provider_block_Start_the_gcp_environment">provider block &#8211; Start the gcp environment</span></h3>
<p>this is to initialize the provider <code>google</code> by mentioning our project name and the region. we already did that in <code>tfvars</code> file</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="bootstrap4" data-enlighter-linenumbers="false">provider "google" {
  project = var.project
  region  = var.region
}
</pre>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="compute_firewall_block_Allow_SSH_and_HTTPS_connections">compute firewall block &#8211; Allow SSH and HTTP[S] connections</span></h3>
<p>we are creating two firewall rules here.</p>
<ul>
<li>The Former is to allow SSH incoming connections from anyone/public.</li>
<li>The Latter is to allow HTTP/HTTPS requests from anyone/public</li>
</ul>
<p>This is done by setting  the <code>source_ranges</code> to any CIDR range <code>0.0.0.0/0</code></p>
<p>you should consider using very specific IP range for security reasons.</p>
<p>If you want to allow only your computer not others. you can set your public IP as a value for the <code>source_ranges</code>  like this <code>142.78.29.12/32</code></p>
<p>You can find your public IP using this URL <a href="https://checkip.amazonaws.com"><code>https://checkip.amazonaws.com</code></a></p>
<p>the <code>/32</code> is to specify a single IP in a CIDR range. so only your public IP would be considered</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="bootstrap4" data-enlighter-linenumbers="false">resource "google_compute_firewall" "firewall" {
  name    = "gritfy-firewall-externalssh"
  network = "default"

  allow {
    protocol = "tcp"
    ports    = ["22"]
  }

  source_ranges = ["0.0.0.0/0"] # Not So Secure. Limit the Source Range
  target_tags   = ["externalssh"]
}

resource "google_compute_firewall" "webserverrule" {
  name    = "gritfy-webserver"
  network = "default"

  allow {
    protocol = "tcp"
    ports    = ["80","443"]
  }

  source_ranges = ["0.0.0.0/0"] # Not So Secure. Limit the Source Range
  target_tags   = ["webserver"]
}</pre>
<p>You might create multiple Virtual machines but how do you set this rule only for this instance or set of instances.</p>
<p><span style="color: #003366;"><strong>target_tags</strong></span></p>
<p>Google provide a feature known as <code>target_tags</code>  which helps us to map the VM to the firewall rule.</p>
<p>this rule would apply for the virtual machines which has the same tag as mentioned in the <code>target_tags</code></p>
<p>Hope the following image illustrate this right.</p>
<p><a href="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-11.33.33-PM.png"><img class="alignnone size-full wp-image-6770 lazyload" src="../../wp-content/ewww/lazy/placeholder-759x395.png" alt="" width="759" height="395" data-src="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-11.33.33-PM.png" loading="lazy" data-srcset="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-11.33.33-PM.png 759w, ../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-11.33.33-PM-300x156.png 300w" data-sizes="auto" /><noscript><img class="alignnone size-full wp-image-6770" src="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-11.33.33-PM.png" alt="" width="759" height="395" srcset="../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-11.33.33-PM.png 759w, ../../wp-content/uploads/2021/02/Screenshot-2021-02-07-at-11.33.33-PM-300x156.png 300w" sizes="(max-width: 759px) 100vw, 759px" data-eio="l" /></noscript></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="compute_address_block_Reserving_public_IP">compute address block &#8211; Reserving public IP</span></h3>
<p>In this block, we are reserving a public IP for our instance.</p>
<p>Though, this is not necessary and GCP would auto assign some public IP automatically. we need this address for our provisioning.</p>
<p>this IP address would be used for establishing a SSH connection and to run the provisioning scripts like <code>Ansible playbooks</code> , <code>Shell scripts</code> etc.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">resource "google_compute_address" "static" {
  name = "vm-public-address"
  project = var.project
  region = var.region
  depends_on = [ google_compute_firewall.firewall ]
}</pre>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="compute_instance_block_Creating_VM_and_provision_with_Shell_commands">compute instance block &#8211; Creating VM and provision with Shell commands</span></h3>
<p>So far we were creating supporting resources like firewall and public IP for our instance/vm.</p>
<p>This is a showstopper where we create the actual instance and configure it.</p>
<p>Since there are lot of components in this block. I will paste the block and add comments inline.</p>
<p>Please follow along and ask if you have any questions over the comments section</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="bootstrap4" data-enlighter-linenumbers="false">resource "google_compute_instance" "dev" {
  name         = "devserver" # name of the server
  machine_type = "f1-micro" # machine type refer google machine types
  zone         = "${var.region}-a" # `a` zone of the selected region in our case us-central-1a
  tags         = ["externalssh","webserver"] # selecting the vm instances with tags

  # to create a startup disk with an Image/ISO. 
  # here we are choosing the CentOS7 image
  boot_disk { 
    initialize_params {
      image = "centos-cloud/centos-7"
    }
  }

  # We can create our own network or use the default one like we did here
  network_interface {
    network = "default"

    # assigning the reserved public IP to this instance
    access_config {
      nat_ip = google_compute_address.static.address
    }
  }

  # This is copy the the SSH public Key to enable the SSH Key based authentication
  metadata = {
    ssh-keys = "${var.user}:${file(var.publickeypath)}"
  }

  # to connect to the instance after the creation and execute few commands for provisioning
  # here you can execute a custom Shell script or Ansible playbook
  provisioner "remote-exec" {
    connection {
      host        = google_compute_address.static.address
      type        = "ssh"
      # username of the instance would vary for each account refer the OS Login in GCP documentation
      user        = var.user 
      timeout     = "500s"
      # private_key being used to connect to the VM. ( the public key was copied earlier using metadata )
      private_key = file(var.privatekeypath)
    }

    # Commands to be executed as the instance gets ready.
    # installing nginx
    inline = [
      "sudo yum -y install epel-release",
      "sudo yum -y install nginx",
      "sudo nginx -v",
    ]
  }

  # Ensure firewall rule is provisioned before server, so that SSH doesn't fail.
  depends_on = [ google_compute_firewall.firewall, google_compute_firewall.webserverrule ]

  # Defining what service account should be used for creating the VM
  service_account {
    email  = var.email
    scopes = ["compute-ro"]
  }

  
}</pre>
<p>So, Now we have all files ready and in place for us to be able to create our infrastructure.</p>
<p>here is the tree structure of my directory. with all three necessary files.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">.
├── main.tf
├── terraform.tfvars
└── variables.tf
</pre>
<p>Before we go ahead and <code>terraform plan</code> and <code>terraform apply</code> it.</p>
<p>Let us check one more version of this same setup.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2><span class="ez-toc-section" id="Creating_VM_and_provision_with_Shell_script_Remote_Exec">Creating VM and provision with Shell script &#8211; Remote Exec</span></h2>
<p>So far we have seen how to create virtual machine in Google Cloud with terraform and run some inline Shell commands during startup.</p>
<p>What if you want to execute a shell script instead of some inline commands</p>
<p>These are the steps we should do to make it happen.</p>
<ol>
<li> Copy the shell script to the instance</li>
<li> Execute the script</li>
</ol>
<p>So we are going to use <code>file</code> and <code>remote-exec</code> provisioners of Terraform to achieve this.</p>
<p>the <code>file</code> provisioner&#8217;s job is to copy the shell script file to the newly created VM.</p>
<p><code>remote-exec</code> set the script as executable and start it up using <code>inline</code> shell commands.</p>
<p>Here is the modified terraform configuration file with these provisioners</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">provisioner "file" {
   
   # source file name on the local machine where you execute terraform plan and apply
   source      = "startupscript.sh"

   # destination is the file location on the newly created instance
   destination = "/tmp/startupscript.sh"

   connection {
     host        = google_compute_address.static.address
     type        = "ssh"
     # username of the instance would vary for each account refer the OS Login in GCP documentation
     user        = var.user 
     timeout     = "500s"
     # private_key being used to connect to the VM. ( the public key was copied earlier using metadata )
     private_key = file(var.privatekeypath)
   }

   # Commands to be executed as the instance gets ready.
   # installing nginx
   inline = [
     "chmod a+x /tmp/startupscript.sh",
     "sed -i -e 's/\r$//' /tmp/startupscript.sh",
     "sudo /tmp/startupscript.sh"
   ]
 }



 # to connect to the instance after the creation and execute few commands for provisioning
 # here you can execute a custom Shell script or Ansible playbook
 provisioner "remote-exec" {
   connection {
     host        = google_compute_address.static.address
     type        = "ssh"
     # username of the instance would vary for each account refer the OS Login in GCP documentation
     user        = var.user 
     timeout     = "500s"
     # private_key being used to connect to the VM. ( the public key was copied earlier using metadata )
     private_key = file(var.privatekeypath)
   }

   # Commands to be executed as the instance gets ready.
   # set execution permission and start the script
   inline = [
     "chmod a+x /tmp/startupscript.sh",
     "sed -i -e 's/\r$//' /tmp/startupscript.sh",
     "sudo /tmp/startupscript.sh"
   ]
 }</pre>
<p>as a prerequisite, we should make sure that the source location and the script names are valid</p>
<p>In our example, we are going to keep the script file on the same directory where our terraform configuration files are present</p>
<p>here is the tree structure of my directory.  ( new script file added )</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">.
├── main.tf
├── startupscript.sh
├── terraform.tfvars
└── variables.tf
</pre>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="How_to_download_this_terraform_project_from_Github">How to download this terraform project from Github.</span></h2>
<p>I have created a Github repo for this code and committed two branches</p>
<p><a href="https://github.com/AKSarav/gcp-vm-remote-execution.git">https://github.com/AKSarav/gcp-vm-remote-execution.git</a></p>
<p>The First approach of having inline commands and remote execution can be cloned from the <code>inline</code> branch</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone -b inline https://github.com/AKSarav/gcp-vm-remote-execution.git</pre>
<p>The second approach with Shell script can be downloaded/cloned using the <code>ShellScript</code> branch</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone -b ShellScript https://github.com/AKSarav/gcp-vm-remote-execution.git</pre>
<p>&nbsp;</p>
<div class='rp4wp-related-posts'>
<h3>More from Middleware Inventory</h3>
<ul>
<li><div class='rp4wp-related-post-image'>
<a href='../remote-server-file-system-lister/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" data-src="../../wp-content/uploads/2017/10/dflister-150x150.jpg" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2017/10/dflister-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../remote-server-file-system-lister/index.html'>Remote Server - File System Lister [Linux]</a><p>Have you ever &nbsp;had the requirement of logging in&nbsp;to the Nnumber of remote servers (without keybased authentication ) and &nbsp;get the mount point information and save it as CSV Report (or) Print it with a good console formatting. Then this is for you. Basically, It is a Shell script (&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='../weblogic-remote-code-execution-cve-2018-3191/index.html'>WEBLOGIC Remote Code Execution CVE-2018-3191 - How to Fix</a><p>Overview Oracle Weblogic Remote Code Execution vulnerability allows unauthenticated attackers with network access via T3 to compromise vulnerable Oracle WebLogic Server. Successful exploitation of it can result in takeover of Oracle WebLogic Server, hence remote code execution &nbsp; Affected versions Weblogic 10.3.6.0 Weblogic 12.1.3.0 Weblogic 12.2.1.3 &nbsp; Solution This vulnerability&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../weblogic-remote-code-execution-vulnerability/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="Apache Clickjack" data-src="../../wp-content/uploads/2019/09/meltdown-spectre-flaw-150x150.jpg" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/09/meltdown-spectre-flaw-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Apache Clickjack" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../weblogic-remote-code-execution-vulnerability/index.html'>WebLogic Remote Code Execution Vulnerability (CVE-2019-2725)</a><p>Overview Oracle WebLogic is vulnerable to a new deserialization vulnerability that could allow an attacker to execute remote commands on vulnerable hosts. This vulnerability was identified in China by China National Vulnerability Database (CNVD) published a Security Team, they have issued a bulletin about an unauthenticated remote command execution (RCE)&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../docker-run-image-as-container/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" data-src="../../wp-content/uploads/2019/04/Screen-Shot-2019-04-09-at-7.31.14-AM-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/04/Screen-Shot-2019-04-09-at-7.31.14-AM-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../docker-run-image-as-container/index.html'>Docker Run Image as Container - Create Container From Docker Image</a><p>In this post, we are going to see how to create an image and run the image as a container and manage it. Before we proceed further, it is indispensable, that we are aware of what is an Image and What is a Container. So let us begin from there.&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../create-ssh-public-key-private-key/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" data-src="../../wp-content/uploads/2018/07/Screen-Shot-2018-07-02-at-3.02.08-AM-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2018/07/Screen-Shot-2018-07-02-at-3.02.08-AM-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../create-ssh-public-key-private-key/index.html'>How to create ssh public key from private key - Vagrant & Linux</a><p>How to create SSH public Key from SSH private key is a question made me write this post. Though we would be able to achieve the SSH key-based authentication by producing the private key. Sometimes it is necessary that we must have the SSH public key. Especially when we are&hellip;</p></div>
</li>
</ul>
</div>
</div>
<footer class="entry-footer">
<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="../ansible-copy-file-or-directory-local-to-remote/index.html" rel="prev"><span class="screen-reader-text">Previous Post:</span>Ansible Copy file or Directory &#8211; Local to Remote | Devops Junction</a></div><div class="nav-next"><a href="../aws-vpc-peering-tutorial/index.html" rel="next"><span class="screen-reader-text">Next Post:</span>How to create AWS VPC Peering &#8211; Step by Step Tutorial</a></div></div>
</nav>
</footer>
</article>
<div id="disqus_thread"></div>
</main>
</section>
<section id="secondary" class="sidebar widget-area clearfix" role="complementary">
<aside id="custom_html-18" class="widget_text widget widget_custom_html clearfix"><div class="textwidget custom-html-widget"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3398911159151128" crossorigin="anonymous"></script>


<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div></aside><aside id="categories-8" class="widget widget_categories clearfix"><div class="widget-header"><h3 class="widget-title">Categories</h3></div>
<ul>
<li class="cat-item cat-item-61"><a href="../category/activemq/index.html">ActiveMQ</a> (4)
</li>
<li class="cat-item cat-item-98"><a href="../category/ansible/index.html">Ansible</a> (65)
</li>
<li class="cat-item cat-item-10"><a href="../category/apache/index.html">Apache</a> (8)
</li>
<li class="cat-item cat-item-234"><a href="../category/aws/index.html">AWS</a> (28)
</li>
<li class="cat-item cat-item-452"><a href="../category/azure/index.html">Azure</a> (1)
</li>
<li class="cat-item cat-item-8"><a href="../category/best-practice/index.html">Best Practice</a> (5)
</li>
<li class="cat-item cat-item-390"><a href="../category/bitbucket/index.html">BitBucket</a> (1)
</li>
<li class="cat-item cat-item-426"><a href="../category/boto/index.html">Boto</a> (1)
</li>
<li class="cat-item cat-item-399"><a href="../category/cloud/index.html" title="Cloud is not only a concept but also a practice of using a network of remote servers hosted on the Internet to store, manage, and process data.">Cloud</a> (1)
</li>
<li class="cat-item cat-item-397"><a href="../category/database/index.html">Database</a> (1)
</li>
<li class="cat-item cat-item-95"><a href="../category/development/index.html">Development</a> (3)
</li>
<li class="cat-item cat-item-152"><a href="../category/docker/index.html">Docker</a> (11)
</li>
<li class="cat-item cat-item-422"><a href="../category/efk/index.html">EFK</a> (1)
</li>
<li class="cat-item cat-item-423"><a href="../category/elastic-search/index.html">Elastic Search</a> (1)
</li>
<li class="cat-item cat-item-59"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a> (6)
</li>
<li class="cat-item cat-item-419"><a href="../category/fluentd/index.html">FluentD</a> (2)
</li>
<li class="cat-item cat-item-424"><a href="../category/gcp-googlecloud/index.html">GCP &#8211; GoogleCloud</a> (1)
</li>
<li class="cat-item cat-item-450"><a href="../category/github-actions/index.html">Github Actions</a> (1)
</li>
<li class="cat-item cat-item-428"><a href="../category/grafana/index.html">Grafana</a> (1)
</li>
<li class="cat-item cat-item-275"><a href="../category/graphite/index.html">Graphite</a> (1)
</li>
<li class="cat-item cat-item-441"><a href="../category/ibm-cloud/index.html">IBM Cloud</a> (1)
</li>
<li class="cat-item cat-item-401"><a href="../category/ibm-websphere/index.html" title="IBM® WebSphere® Application Server provides a range of flexible and secure runtime for Java enterprise applications, lightweight web applications and microservices. You can create new applications and enhance and optimize existing application infrastructure on premises or across any public, private or hybrid cloud. In addition, by utilizing IBM Cloud Private, you can create on-premises cloud capabilities similar to public clouds to accelerate app development. The platform is built on the open source Kubernetes-based container architecture and supports both Docker containers and Cloud Foundry.">IBM Websphere</a> (2)
</li>
<li class="cat-item cat-item-354"><a href="../category/ihs-and-apache/index.html">IHS and Apache</a> (10)
</li>
<li class="cat-item cat-item-353"><a href="../category/iis/index.html">IIS</a> (4)
</li>
<li class="cat-item cat-item-388"><a href="../category/javascript/index.html">JavaScript</a> (3)
</li>
<li class="cat-item cat-item-286"><a href="../category/jenkins/index.html">Jenkins</a> (4)
</li>
<li class="cat-item cat-item-15"><a href="../category/joomla/index.html">Joomla</a> (1)
</li>
<li class="cat-item cat-item-151"><a href="../category/kubernetes/index.html">Kubernetes</a> (16)
</li>
<li class="cat-item cat-item-191"><a href="../category/middleware/index.html">Middleware</a> (3)
</li>
<li class="cat-item cat-item-322"><a href="../category/network-troubleshooting/index.html">Network Troubleshooting</a> (1)
</li>
<li class="cat-item cat-item-413"><a href="../category/networking/index.html">Networking</a> (1)
</li>
<li class="cat-item cat-item-273"><a href="../category/nodejs/index.html">NodeJS</a> (2)
</li>
<li class="cat-item cat-item-396"><a href="../category/office365/index.html">Office365</a> (1)
</li>
<li class="cat-item cat-item-148"><a href="../category/opensource/index.html">OpenSource</a> (2)
</li>
<li class="cat-item cat-item-417"><a href="../category/oracle-db/index.html">Oracle DB</a> (3)
</li>
<li class="cat-item cat-item-404"><a href="../category/oracle-weblogic/index.html" title="WebLogic is a leading Application Server product most widely used for e-commerce online transaction processing (OLTP) platform application, developed to connect users in a distributed computing environment and to facilitate the integration of mainframe applications with distributed corporate data and applications.">Oracle Weblogic</a> (2)
</li>
<li class="cat-item cat-item-232"><a href="../category/packer/index.html">Packer</a> (2)
</li>
<li class="cat-item cat-item-146"><a href="../category/perl/index.html">Perl</a> (1)
</li>
<li class="cat-item cat-item-60"><a href="../category/php/index.html">PHP</a> (1)
</li>
<li class="cat-item cat-item-453"><a href="../category/postgresql/index.html">PostgreSQL</a> (1)
</li>
<li class="cat-item cat-item-343"><a href="../category/powershell/index.html">PowerShell</a> (1)
</li>
<li class="cat-item cat-item-31"><a href="../category/weblogic/problemsolution/index.html">problem/solution</a> (8)
</li>
<li class="cat-item cat-item-427"><a href="../category/prometheus/index.html">Prometheus</a> (1)
</li>
<li class="cat-item cat-item-445"><a href="../category/pulumi/index.html">Pulumi</a> (1)
</li>
<li class="cat-item cat-item-285"><a href="../category/python-flask/index.html">Python Flask</a> (1)
</li>
<li class="cat-item cat-item-22"><a href="../category/python_scripts/index.html">python_scripts</a> (7)
</li>
<li class="cat-item cat-item-446"><a href="../category/redis/index.html">Redis</a> (1)
</li>
<li class="cat-item cat-item-451"><a href="../category/serverless/index.html">Serverless</a> (1)
</li>
<li class="cat-item cat-item-12"><a href="../category/shell-scripting/index.html">Shell Scripting</a> (6)
</li>
<li class="cat-item cat-item-125"><a href="../category/soap-web-services/index.html">SOAP Web Services</a> (1)
</li>
<li class="cat-item cat-item-13"><a href="../category/splunk/index.html">Splunk</a> (1)
</li>
<li class="cat-item cat-item-425"><a href="../category/sre/index.html">SRE</a> (1)
</li>
<li class="cat-item cat-item-274"><a href="../category/statsd/index.html">StatsD</a> (1)
</li>
<li class="cat-item cat-item-233"><a href="../category/terraform/index.html">Terraform</a> (12)
</li>
<li class="cat-item cat-item-35"><a href="../category/tomcat/index.html">tomcat</a> (7)
</li>
<li class="cat-item cat-item-147"><a href="../category/tools/index.html">tools</a> (5)
</li>
<li class="cat-item cat-item-391"><a href="../category/traefik/index.html">Traefik</a> (1)
</li>
<li class="cat-item cat-item-124"><a href="../category/troubleshooting/index.html">Troubleshooting</a> (3)
</li>
<li class="cat-item cat-item-1"><a href="../category/uncategorized/index.html">Uncategorized</a> (5)
</li>
<li class="cat-item cat-item-7"><a href="../category/unix/index.html">Unix</a> (5)
</li>
<li class="cat-item cat-item-99"><a href="../category/vagrant/index.html">Vagrant</a> (4)
</li>
<li class="cat-item cat-item-389"><a href="../category/vuejs/index.html">VueJS</a> (2)
</li>
<li class="cat-item cat-item-356"><a href="../category/vulnerabilities-fixes/index.html">Vulnerabilities &amp; Fixes</a> (21)
</li>
<li class="cat-item cat-item-21"><a href="../category/weblogic/index.html">weblogic</a> (51)
</li>
<li class="cat-item cat-item-9"><a href="../category/webserver/index.html">Webserver</a> (1)
</li>
<li class="cat-item cat-item-92"><a href="../category/websphere/index.html">Websphere</a> (8)
</li>
<li class="cat-item cat-item-321"><a href="../category/windows-server/index.html">Windows Server</a> (5)
</li>
<li class="cat-item cat-item-55"><a href="../category/wlst/index.html">wlst</a> (7)
</li>
<li class="cat-item cat-item-36"><a href="../category/wordpress/index.html">wordpress</a> (2)
</li>
<li class="cat-item cat-item-4"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a> (1)
</li>
</ul>
</aside><aside id="media_image-5" class="widget widget_media_image clearfix"><img width="267" height="400" src="../../wp-content/ewww/lazy/placeholder-267x400.png" class="image wp-image-8825  attachment-full size-full lazyload" alt="write for devopsjunction" style="max-width: 100%; height: auto;" data-src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" loading="lazy" data-srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" data-sizes="auto" /><noscript><img width="267" height="400" src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" class="image wp-image-8825  attachment-full size-full" alt="write for devopsjunction" style="max-width: 100%; height: auto;" srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" sizes="(max-width: 267px) 100vw, 267px" data-eio="l" /></noscript></aside>
</section>
</div>
<div id="footer" class="footer-wrap">
<footer id="colophon" class="site-footer container clearfix" role="contentinfo">
<div id="footer-text" class="site-info">
<span class="credit-link">Powered by <a href="../../index.html" title="Rumen Lishkov">Rumen Lishkov</a> and <a href="https://rumen.free.bg/" title="Studio-1">Studio1 Sofia</a> </span>
</div>
</footer>
</div>
</div>
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@mwinventory" />
<meta name="twitter:creator" content="@mwinventory" />
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&amp;display=swap" rel="stylesheet"><div class="simplesocialbuttons simplesocial-round-icon simplesocialbuttons-float-left-center post-6743 post  ssb_counter-activate simplesocialbuttons-slide-bottom-in">
<button class="simplesocial-fb-share" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Facebook </span> <span class="ssb_counter ssb_fbshare_counter">0</span></button>
<button class="simplesocial-twt-share" data-href="https://twitter.com/share?text=Terraform+google_compute_instance+Example+%E2%80%93+with+Remote+Exec&url=https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Twitter</span> <span class="ssb_counter ssb_twitter_counter">0</span></button>
<button target="popup" class="simplesocial-linkedin-share" data-href="https://www.linkedin.com/cws/share?url=https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">LinkedIn</span></button>
<button onclick="javascript:window.location.href = this.dataset.href;return false;" class="simplesocial-email-share" data-href="mailto:?subject=Terraform+google_compute_instance+Example+%E2%80%93+with+Remote+Exec&body=https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/"><span class="simplesocialtxt">Email</span></button>
<button onclick="javascript:window.open(this.dataset.href, '_blank' );return false;" class="simplesocial-whatsapp-share" data-href="https://web.whatsapp.com/send?text=https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/"><span class="simplesocialtxt">WhatsApp</span></button>
</div>
<script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' id='disqus_count-js-extra'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"mwinventory"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f8767.js"></script>
<script type='text/javascript' id='disqus_embed-js-extra'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.22"},"disqusIdentifier":"6743 https:\/\/www.middlewareinventory.com\/?p=6743","disqusShortname":"mwinventory","disqusTitle":"Terraform google_compute_instance Example \u2013 with Remote Exec","disqusUrl":"https:\/\/www.middlewareinventory.com\/blog\/create-linux-vm-in-gcp-with-terraform-remote-exec\/","postId":"6743"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/bccbc.js"></script>
<script type='text/javascript' id='dae-download-js-extra'>
/* <![CDATA[ */
var objDaeDownload = {"ajaxUrl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"2019084a26"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/8510d.js"></script>
<script type='text/javascript' id='socialsnap-js-js-extra'>
/* <![CDATA[ */
var socialsnap_script = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","on_media_width":"250","on_media_height":"250","nonce":"b4d440853b","post_id":"6743"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/fef55.js"></script>
<script type='text/javascript' id='aicp-js-extra'>
/* <![CDATA[ */
var AICP = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"0b980bed5f","ip":"5.147.232.184","clickLimit":"1","clickCounterCookieExp":"3","banDuration":"7","countryBlockCheck":"No","banCountryList":"RU"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/ff9fe.js"></script>
<script type='text/javascript' src='https://js.stripe.com/v3/?ver=2.03' id='stripe-js'></script>
<script type='text/javascript' id='q2w3_fixed_widget-js-extra'>
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"q2w3-default-sidebar","margin_top":10,"margin_bottom":0,"stop_id":"","screen_max_width":1026,"screen_max_height":0,"width_inherit":true,"refresh_interval":1500,"window_load_hook":false,"disable_mo_api":false,"widgets":["text-32"]}];
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f2bcf.js"></script>
<script type='text/javascript' id='enlighterjs-js-after'>
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"enlighter","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
</script>
<script src="../../wp-content/cache/minify/129c2.js"></script>
<script type='text/javascript' id='ez-toc-js-js-extra'>
/* <![CDATA[ */
var ezTOC = {"smooth_scroll":"1","visibility_hide_by_default":"","width":"100%","scroll_offset":"30"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/0c713.js"></script>
<div id="ss-copy-popup" class="ss-popup-overlay">
<div class="ss-popup">
<div class="ss-popup-heading">
<span>Copy link</span>
<a href="#" id="ss-close-share-networks-modal" class="ss-close-modal" rel="nofollow"><i class="ss ss-close"></i></a>
</div>
<div class="ss-popup-content">
<div class="ss-copy-action">
<input type="text" readonly="readonly" value="https://www.middlewareinventory.com/blog/create-linux-vm-in-gcp-with-terraform-remote-exec/" class="ss-copy-action-field" />
<a href="#" class="ss-button" rel="nofollow">Copy<span class="ss-share-network-tooltip">Copied</span></a>
<i class="ss ss-copy"></i>
</div>
<div class="ss-powered-by">Powered by <a href="https://socialsnap.com/?utm_source=WordPress&amp;utm_medium=link&amp;utm_campaign=inthewild" target="_blank" rel="nofollow noopener"><i class="ss ss-socialsnap"></i>Social Snap</a></div>
</div>
</div>
</div>
<script type='text/javascript'>function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script> 
<script type="text/javascript">

			var SocialSnapURL 				= window.location.href;
			var SocialSnapShareCacheExpired = 0;
				
			if ( -1 !== SocialSnapURL.indexOf('?ss_cache_refresh') ) {

				SocialSnapShareCacheExpired = true;

			} else {

				var SocialSnapServerTimestamp 	= 1657191027;
				var SocialSnapBrowserTimestamp 	= Date.now();

				if ( ! SocialSnapBrowserTimestamp ) {
					SocialSnapBrowserTimestamp = new Date().getTime();
				}

				SocialSnapBrowserTimestamp = Math.floor( SocialSnapBrowserTimestamp / 1000 );

				SocialSnapShareCacheExpired = SocialSnapShareCacheExpired && ( SocialSnapBrowserTimestamp - SocialSnapServerTimestamp < 60 );
			}

		</script>

<div id="cookie-notice" role="banner" class="cn-bottom bootstrap" style="color: #fff; background-color: #000;"><div class="cookie-notice-container"><span id="cn-notice-text">We use cookies to ensure that we give you the best experience on our website. The Cookies collected are used only to Show customized Ads. We Hope you are fine with it.</span><a href="#" id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button bootstrap button">Ok</a><a href="#" id="cn-refuse-cookie" data-cookie-set="refuse" class="cn-set-cookie cn-button bootstrap button">No</a><a href="../../cookie-policy/index.html" target="_blank" id="cn-more-info" class="cn-more-info cn-button bootstrap button">Privacy policy</a>
</div>
<div class="cookie-notice-revoke-container"><a href="#" class="cn-revoke-cookie cn-button bootstrap button">Revoke cookies</a></div>
</div>
</body>
</html>
