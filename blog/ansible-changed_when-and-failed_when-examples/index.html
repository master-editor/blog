<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">
<link rel="pingback" href="https://www.middlewareinventory.com/xmlrpc.php">

<title>Ansible changed_when and failed_when examples | Devops Junction</title>
<meta name="description" content="In this post, we are going to see how to use conditional statements of Ansible such as when, changed_when, failed_when and where to use them appropriately and how it works. with real time examples. Ansible conditional statements practical examples. Multiple Playbooks examples for when, changed_when and failed_when" />
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<link rel="canonical" href="index.html" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Ansible changed_when and failed_when examples | Devops Junction" />
<meta property="og:description" content="In this post, we are going to see how to use conditional statements of Ansible such as when, changed_when, failed_when and where to use them appropriately and how it works. with real time examples. Ansible conditional statements practical examples. Multiple Playbooks examples for when, changed_when and failed_when" />
<meta property="og:url" content="https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="article:publisher" content="http://www.facebook.com/devopsjunc" />
<meta property="article:published_time" content="2018-09-23T02:17:31+00:00" />
<meta property="article:modified_time" content="2022-04-05T15:08:13+00:00" />
<meta property="og:image" content="https://www.middlewareinventory.com/wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-8.13.12-AM.png" />
<meta property="og:image:width" content="1197" />
<meta property="og:image:height" content="528" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@mwinventory" />
<meta name="twitter:site" content="@mwinventory" />
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://www.middlewareinventory.com/#organization","name":"Middleware Inventory","url":"https://www.middlewareinventory.com/","sameAs":["http://www.facebook.com/devopsjunc","https://www.youtube.com/channel/UCRuqBFM6ioWwviNJkgOjeWw","https://twitter.com/mwinventory"],"logo":{"@type":"ImageObject","@id":"https://www.middlewareinventory.com/#logo","inLanguage":"en-US","url":"https://www.middlewareinventory.com/wp-content/uploads/2020/09/Screenshot-2020-09-18-at-3.49.40-AM.jpg","width":300,"height":107,"caption":"Middleware Inventory"},"image":{"@id":"https://www.middlewareinventory.com/#logo"}},{"@type":"WebSite","@id":"https://www.middlewareinventory.com/#website","url":"https://www.middlewareinventory.com/","name":"Devops Junction","description":"An inventory of [i]nformation, Middleware and much more.","publisher":{"@id":"https://www.middlewareinventory.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":"https://www.middlewareinventory.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/#primaryimage","inLanguage":"en-US","url":"https://www.middlewareinventory.com/wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-8.13.12-AM.png","width":1197,"height":528},{"@type":"WebPage","@id":"https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/#webpage","url":"https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/","name":"Ansible changed_when and failed_when examples | Devops Junction","isPartOf":{"@id":"https://www.middlewareinventory.com/#website"},"primaryImageOfPage":{"@id":"https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/#primaryimage"},"datePublished":"2018-09-23T02:17:31+00:00","dateModified":"2022-04-05T15:08:13+00:00","description":"In this post, we are going to see how to use conditional statements of Ansible\u00a0such as\u00a0when, changed_when, failed_when and where to use them appropriately and how it works. with real time examples. Ansible conditional statements practical examples. Multiple Playbooks examples for when, changed_when and failed_when","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/"]}]},{"@type":"Article","@id":"https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/#article","isPartOf":{"@id":"https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/#webpage"},"author":{"@id":"https://www.middlewareinventory.com/#/schema/person/050bf13e27b309d29d1bda45c4eb3147"},"headline":"Ansible changed_when and failed_when examples","datePublished":"2018-09-23T02:17:31+00:00","dateModified":"2022-04-05T15:08:13+00:00","mainEntityOfPage":{"@id":"https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/#webpage"},"commentCount":0,"publisher":{"@id":"https://www.middlewareinventory.com/#organization"},"image":{"@id":"https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/#primaryimage"},"articleSection":"Ansible","inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/#respond"]}]},{"@type":"Person","@id":"https://www.middlewareinventory.com/#/schema/person/050bf13e27b309d29d1bda45c4eb3147","name":"Rumen Lishkov","image":{"@type":"ImageObject","@id":"https://www.middlewareinventory.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/c22e4a54d67750291a9892531f94ffb3?s=96&d=mm&r=g","caption":"Rumen Lishkov"}}]}</script>

<link rel='dns-prefetch' href='https://js.stripe.com' />
<link rel='dns-prefetch' href='https://fonts.googleapis.com' />
<link rel='dns-prefetch' href='https://s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Feed" href="../../feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Comments Feed" href="../../comments/feed/index.rss" />
<link rel="alternate" type="application/rss+xml" title="Middleware Inventory &raquo; Ansible changed_when and failed_when examples Comments Feed" href="feed/index.rss" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-6674956-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-6674956-8');
</script>

<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.middlewareinventory.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.5.6"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/404f7.css" media="all" />
<style id='ez-toc-inline-css' type='text/css'>div#ez-toc-container p.ez-toc-title {font-size: 120%;}div#ez-toc-container p.ez-toc-title {font-weight: 500;}div#ez-toc-container ul li {font-size: 95%;}div#ez-toc-container {width: 100%;}
</style>
<link rel="stylesheet" href="../../wp-content/cache/minify/f854f.css" media="all" />
<link rel='stylesheet' id='poseidon-default-fonts-css' href='https://fonts.googleapis.com/css?family=Ubuntu%3A400%2C400italic%2C700%2C700italic%7CRaleway%3A400%2C700&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel="stylesheet" href="../../wp-content/cache/minify/88e5e.css" media="all" />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/www.middlewareinventory.com","hash_tracking":"false"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1058f.js"></script>
<script type='text/javascript' id='cookie-notice-front-js-extra'>
/* <![CDATA[ */
var cnArgs = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","hideEffect":"fade","onScroll":"no","onScrollOffset":"100","cookieName":"cookie_notice_accepted","cookieValue":"true","cookieTime":"2592000","cookiePath":"\/","cookieDomain":"","redirection":"","cache":"1","refuse":"yes","revoke_cookies":"0","revoke_cookies_opt":"automatic","secure":"1"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/545b0.js"></script>
<script type='text/javascript' id='email-subscribers-js-extra'>
/* <![CDATA[ */
var es_data = {"messages":{"es_empty_email_notice":"Please enter email address","es_rate_limit_notice":"You need to wait for sometime before subscribing again","es_single_optin_success_message":"Successfully Subscribed.","es_email_exists_notice":"Email Address already exists!","es_unexpected_error_notice":"Oops.. Unexpected error occurred.","es_invalid_email_notice":"Invalid email address","es_try_later_notice":"Please try after some time"},"es_ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/1de0a.js"></script>
<script type='text/javascript' id='ssb-front-js-js-extra'>
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"3d8661396b"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/268e7.js"></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://www.middlewareinventory.com/wp-content/themes/poseidon/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<script type='text/javascript' id='poseidon-post-slider-js-extra'>
/* <![CDATA[ */
var poseidon_slider_params = {"animation":"slide","speed":"7000"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/51af3.js"></script>
<script type='text/javascript' id='eio-lazy-load-js-extra'>
/* <![CDATA[ */
var eio_lazy_vars = {"exactdn_domain":"","skip_autoscale":"0"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/28f5b.js"></script>
<link rel="https://api.w.org/" href="../../wp-json/index.json" /><link rel="alternate" type="application/json" href="../../wp-json/wp/v2/posts/1768.json" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php-rsd.xml" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.middlewareinventory.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 5.5.6" />
<link rel='shortlink' href='index.html' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-ansible-changed_when-and-failed_when-examples-.json" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed-url=https---www.middlewareinventory.com-blog-ansible-changed_when-and-failed_when-examples-&amp;format=xml.xml" />
<script>
    document.cookie = "cookie_notice_accepted=true;max-age=" + 3600*24*365 + "; path=/" + ";secure;";
    document.cookie = "cookie_notice_accepted=true;max-age=" + 3600*24*365 + "; path=/";
    if ( ! /(^|;)\s*cca_is_eu=/.test(document.cookie) ) {  // if check prevents reload loop
		  document.cookie = "cca_is_eu=false;max-age=" + 3600*24*364 + "; path=/";
      var ccaURL = window.location.protocol + '//',
      hostname = window.location.host + '/' + window.location.pathname;
			if ( '0' === '1' ) {
        window.location.reload( true );
      }
   }
</script>
<link href='https://fonts.googleapis.com/css?family=Strait:100,200,300,400,500,600,700,800,900&amp;subset=arabic,vietnamese,hebrew,thai,bengali,latin,latin-ext,cyrillic,cyrillic-ext,greek' rel='stylesheet' type='text/css'><style>a.idcore-button,a.idcore-button:visited{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:hover,a.idcore-button:focus{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}a.idcore-button:active{font-family:'Strait','arial';font-size:20px;color:#ffffff;font-weight:normal;font-style:normal;text-decoration:none !important;text-transform:uppercase;padding-top:16px;padding-bottom:16px;padding-left:32px;padding-right:32px;background-color:rgba(212, 7, 72, 1);background-image:linear-gradient(to bottom,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 50%,rgba(0,0,0,.05) 51%,rgba(0,0,0,.05) 100%);border-width:1px;border-style:solid;border-color:#d4150b;border-radius:3px;box-shadow: 2px 2px 0px 0px rgba(68, 68, 68, 0.2);}</style><script>var idcore_ajax_url = "https://www.middlewareinventory.com/wp-admin/admin-ajax.php";</script> <style media="screen">/*inline margin*/
	
	
	
	
	
	
			 /*margin-digbar*/

	
	
	
	
	   div[class*="simplesocialbuttons-float"].simplesocialbuttons.simplesocial-round-icon button{
	 margin: ;
   }
	
	
	
</style>

<meta property="og:title" content="Ansible changed_when and failed_when examples - Middleware Inventory" />
<meta property="og:description" content="In this post, we are going to see how to use conditional statements of Ansible such as when, changed_when, failed_when and where to use them appropriately and how it works. By these conditional modules, Ansible provides a way for us to define when should ansible run a certain task or consider the executed task as Success or failure.

Long Story Short, These modules" />
<meta property="og:url" content="https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" />
<meta property="og:site_name" content="Middleware Inventory" />
<meta property="og:image" content="https://www.middlewareinventory.com/wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-8.13.12-AM.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="In this post, we are going to see how to use conditional statements of Ansible such as when, changed_when, failed_when and where to use them appropriately and how it works. By these conditional modules, Ansible provides a way for us to define when should ansible run a certain task or consider the executed task as Success or failure.

Long Story Short, These modules" />
<meta name="twitter:title" content="Ansible changed_when and failed_when examples - Middleware Inventory" />
<meta property="twitter:image" content="https://www.middlewareinventory.com/wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-8.13.12-AM.png" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
<noscript><style>.lazyload[data-src]{display:none !important;}</style></noscript><style type="text/css" id="sns_global_styles">/* for mobile */
@media screen and (max-width: 480px) {
    #text-23 {
        display:none !important;
    }
	p,li
    {
      font-size: 20px !important;
      color: #333 !important;
      line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li a
    {
    	font-size: 20px !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  
  #afc_sidebar_4348 
{
  height: 8vh; 
  max-height: 8vh; 
  background-color: transparent;
}
}

/* for Desktop */
@media screen and (min-width: 500px) {
#afc_sidebar_4348 
{
  height: 10vh; 
  max-height: 10vh; 
  background-color: transparent;
}
  #text-23 {
        display:none !important;
    }
	p,li
    {
        font-size: 20px !important;
        color: #333 !important;
        line-height: 1.68 !important;;
    }
    .article-inner
    {
    	padding-right: 5% !important;
    	padding-left: 5% !important;
    }
    ul.related_post li
    {
    	width: 100% !important;
    }
    ul.related_post li small {
    font-size: 100%;
    }
  

}

.es_lablebox {
    padding-bottom: 3px;
    color: steelblue !important;
    font-weight: bold !important;
}
.widget-title span {
    line-height: 2.2;
    color: steelblue !important;
}
.sidey {
	padding: 0;
}
.sumome-contactform 
{
  display: none;
}
code { 
    font-family: courier;
    font-size: 18px;
    padding: 2px;
    background-color: #f1f1f1;
    /*box-shadow: 0 2px 4px 0 rgba(0,0,0,0.16),0 2px 10px 0 rgba(0,0,0,0.12)!important;*/
    
}

.syntaxhighlighter {
    font-size: 14px !important;
}

pre {
 font-family: Menlo, Monaco, Consolas, "Courier New", monospace !important;
}

.black-red-border
{
    border-left: 3px solid;
    background-color: black;
    color: ghostwhite;
    border-left-color: red;
} 
}

#wpdevar_comment_1 span
{
  font-family:  "Open Sans", Helvetica, Arial, sans-serif !important;
  font-size: 20px !important;
  color: #1495b5 !important;
}

#wpdevar_comment_1 
{
  margin-top: 50px;
  margin-bottom: 30px;
}

summary
{
 color: steelblue; 
}

blockquote
{
  border-left-color: #cc0f77 !important;
  border-left-width: 4px !important;
  border-left-style: solid !important;
  background-color: #f5f5f5 !important;
}

.rp4wp-related-post-image{ width: auto !important; }

.main-navigation-menu
{
  float: none !important;
}

.primary-navigation
{
  float: none !important
}

body,html{
  /* font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

.page-title, .entry-title, .site-title, .main-navigation-menu a, .widget-title
{
  /*font-family: 'Poppins', sans-serif; */
  font-family: "Source Sans Pro","Arial",sans-serif
}

#postfollow {
  background: whitesmoke;
  padding-top: 5%;
  padding-bottom: 5%;
  padding-left: 2%;
}
div#ez-toc-container p.ez-toc-title {
    font-weight: bold;
    font-size: 24px !important;
}
div#ez-toc-container {
    margin-bottom: 15%;
}

</style><link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.middlewareinventory.com/wp-content/uploads/2017/12/cropped-Screen-Shot-2017-12-22-at-12.16.54-PM-3-270x270.png" />
<style type="text/css">article h3
{
    background-color: whitesmoke;
    color: black;
    padding-left: 1%;
    border-left: 10px solid black;
    font-weight: 400;
    font-size: 22px;
}
code
{
  color: rgb(232, 44, 88);
}

pre {
    border-radius: 6px;
    background-color: #fafafa !important;
    border: 1px solid #ececec;
    line-height: 20px;
}
blockquote {
    padding: 2%;
}
</style>
<style type="text/css" id="wp-custom-css">.site-title
{
   font-size: 24px !important;
}		</style>
</head>
<body class="post-template-default single single-post postid-1768 single-format-standard wp-custom-logo cookies-not-set elementor-default">
<div id="page" class="hfeed site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<div id="header-top" class="header-bar-wrap"></div>
<header id="masthead" class="site-header clearfix" role="banner">
<div class="header-main container clearfix">
<div id="logo" class="site-branding clearfix">
<a href="../../index.html" class="custom-logo-link" rel="home"><img width="300" height="107" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 107'%3E%3C/svg%3E" class="custom-logo lazyload" alt="Middleware Inventory" data-src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" loading="lazy" /><noscript><img width="300" height="107" src="../../wp-content/uploads/2020/09/cropped-Screenshot-2020-09-18-at-3.49.40-AM.jpg" class="custom-logo" alt="Middleware Inventory" data-eio="l" /></noscript></a>
<p class="site-title"></p>
</div>
<nav id="main-navigation" class="primary-navigation navigation clearfix" role="navigation">
<ul id="menu-primary-menu" class="main-navigation-menu"><li id="menu-item-172" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-172"><a href="https://airdata.github.io/">About Me</a></li>
<li id="menu-item-3206" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-3206"><a href="../category/middleware/index.html">Middleware</a>
<ul class="sub-menu">
<li id="menu-item-1518" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1518"><a href="../category/weblogic/index.html">weblogic</a></li>
<li id="menu-item-3207" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3207"><a href="../category/was/index.html">WAS</a></li>
<li id="menu-item-3208" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3208"><a href="../category/websphere/index.html">Websphere</a></li>
<li id="menu-item-3209" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3209"><a href="../category/wlst/index.html">wlst</a></li>
<li id="menu-item-3210" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3210"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a></li>
<li id="menu-item-3211" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3211"><a href="../category/jms/index.html">JMS</a></li>
<li id="menu-item-3212" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3212"><a href="../category/activemq/index.html">ActiveMQ</a></li>
<li id="menu-item-3213" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3213"><a href="../category/troubleshooting/index.html">Troubleshooting</a></li>
<li id="menu-item-3214" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3214"><a href="../category/apache/index.html">Apache</a></li>
<li id="menu-item-3215" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3215"><a href="../category/best-practice/index.html">Best Practice</a></li>
<li id="menu-item-3222" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3222"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a></li>
</ul>
</li>
<li id="menu-item-3157" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3157"><a href="../../devops-junction/index.html">Devops</a>
<ul class="sub-menu">
<li id="menu-item-1513" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1513"><a href="../category/ansible/index.html">Ansible</a></li>
<li id="menu-item-3216" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3216"><a href="../category/aws/index.html">AWS</a></li>
<li id="menu-item-3217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3217"><a href="../category/docker/index.html">Docker</a></li>
<li id="menu-item-3218" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3218"><a href="../category/packer/index.html">Packer</a></li>
<li id="menu-item-3219" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3219"><a href="../category/splunk/index.html">Splunk</a></li>
<li id="menu-item-3220" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3220"><a href="../category/terraform/index.html">Terraform</a></li>
<li id="menu-item-3221" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3221"><a href="../category/vagrant/index.html">Vagrant</a></li>
<li id="menu-item-3223" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3223"><a href="../category/kubernetes/index.html">Kubernetes</a></li>
</ul>
</li>
<li id="menu-item-8820" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8820"><a href="../../newsletter/index.html">Newsletter</a></li>
<li id="menu-item-8821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8821"><a href="https://rumen.free.bg/#contact">Book a Consultation</a></li>
</ul> </nav>
</div>
</header>
<div id="content" class="site-content container clearfix">
<section id="primary" class="content-area">
<main id="main" class="site-main" role="main">

<article id="post-1768" class="post-1768 post type-post status-publish format-standard has-post-thumbnail hentry category-ansible wpautop">
<header class="entry-header">
<h1 class="entry-title">Ansible changed_when and failed_when examples</h1>
<div class="entry-meta"><span class="meta-date"> Updated on: <a href="index.html" title="7:47 am" rel="bookmark"><time class="entry-date published updated" datetime="April 5, 2022">April 5, 2022</time></a></span><span class="meta-author"> <span class="author vcard"><a class="url fn n" href="../author/admin/index.html" title="View all posts by Rumen Lishkov" rel="author">Rumen Lishkov</a></span></span></div>
</header>
<div class="entry-content clearfix">
<div class="ss-inline-share-wrapper ss-left-inline-content ss-small-icons ss-with-spacing ss-rounded-icons">
<div class="ss-inline-share-content">
<ul class="ss-social-icons-container">
<li class="">
<a href="#" data-ss-ss-link="https://www.facebook.com/sharer.php?t=Ansible%20changed_when%20and%20failed_when%20examples&u=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fansible-changed_when-and-failed_when-examples%2F" class="ss-facebook-color" rel="nofollow" data-ss-ss-network-id="facebook" data-ss-ss-post-id="1768" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" data-ss-ss-type="share" data-has-api="true">
<span class="ss-share-network-content">
<i class="ss ss-facebook"></i>
<span class="ss-network-count">
0
</span>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://twitter.com/intent/tweet?text=Ansible+changed_when+and+failed_when+examples&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fansible-changed_when-and-failed_when-examples%2F" class="ss-twitter-color" rel="nofollow" data-ss-ss-network-id="twitter" data-ss-ss-post-id="1768" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-twitter"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="https://www.linkedin.com/shareArticle?title=Ansible%20changed_when%20and%20failed_when%20examples&url=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fansible-changed_when-and-failed_when-examples%2F&mini=true" class="ss-linkedin-color" rel="nofollow" data-ss-ss-network-id="linkedin" data-ss-ss-post-id="1768" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-linkedin"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="mailto:?body=https%3A%2F%2Fwww.middlewareinventory.com%2Fblog%2Fansible-changed_when-and-failed_when-examples%2F&subject=Ansible%20changed_when%20and%20failed_when%20examples" class="ss-envelope-color" rel="nofollow" data-ss-ss-network-id="envelope" data-ss-ss-post-id="1768" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-envelope"></i>
</span>
</a>
</li>
<li class="">
<a href="#" data-ss-ss-link="#" class="ss-copy-color" rel="nofollow" data-ss-ss-network-id="copy" data-ss-ss-post-id="1768" data-ss-ss-location="inline_content" data-ss-ss-permalink="https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" data-ss-ss-type="share">
<span class="ss-share-network-content">
<i class="ss ss-copy"></i>
</span>
</a>
</li>
</ul>
</div>
</div>
<p>In this post, we are going to see how to use conditional statements of Ansible such as <strong>when</strong>, <strong>changed_when</strong>, <strong>failed_when</strong> and where to use them appropriately and how it works. By these conditional modules, Ansible provides a way for us to define when should ansible run a certain task or consider the executed task as Success or failure.</p>
<p>Long Story Short, These modules give us a way to make ansible do something when a certain condition is met or satisfied</p>
<p>let us cover each conditional statements one by one with examples.</p>
<p>We presume that you have all the basic knowledge of Ansible. If not, we highly recommend you to refer the following articles and come back.</p>
<p>Ansible Basics: <a href="../ansible-ad-hoc-commands/index.html">What is Ansible, Ad hoc commands and Playbooks</a></p>
<p>Ansible In Action:  <a href="../vagrant-ansible-example/index.html">How setup your own ansible infrastructure using Vagrant and run your playbook</a></p>
<p>These articles can help you to get started with Ansible.</p>
<p>Find more<a href="../ansible-playbook-example/index.html"> ansible playbook examples</a> here</p>
<p>&nbsp;</p>
<div id="ez-toc-container" class="counter-hierarchy counter-decimal ez-toc-grey">
<div class="ez-toc-title-container">
<p class="ez-toc-title">Table of Contents</p>
<span class="ez-toc-title-toggle"><a class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle"><i class="ez-toc-glyphicon ez-toc-icon-toggle"></i></a></span></div>
<nav><ul class="ez-toc-list"><li><a href="#The_Ansible_when_Statement" title="The Ansible when Statement">The Ansible when Statement</a></li><li><a href="#How_to_use_ansible_when_Statement" title="How to use ansible when Statement">How to use ansible when Statement</a><ul><li><a href="#Example_1_Shutdown_the_Debian_flavoured_servers" title="Example 1:  Shutdown the Debian flavoured servers">Example 1:  Shutdown the Debian flavoured servers</a></li><li><a href="#Example_2_Install_HTTPD_when_httpd_is_not_installed_already" title="Example 2:  Install HTTPD when httpd is not installed already">Example 2:  Install HTTPD when httpd is not installed already</a></li><li><a href="#Example_3_Multiple_Conditions_in_Single_when_statement_Shutdown_only_CentOS-6_and_Debian-7" title="Example 3: [Multiple Conditions in Single when statement] Shutdown only CentOS-6 and Debian-7 ">Example 3: [Multiple Conditions in Single when statement] Shutdown only CentOS-6 and Debian-7 </a></li></ul></li><li><a href="#The_Ansible_failed_when_and_changed_when_Statements" title="The Ansible failed_when and changed_when Statements">The Ansible failed_when and changed_when Statements</a></li><li><a href="#How_to_use_ansible_changed_when_Statement" title="How to use ansible changed_when Statement">How to use ansible changed_when Statement</a><ul><li><a href="#Example_1_Start_the_HTTPD_or_Apache_Server_which_is_already_started" title="Example 1:  Start the HTTPD (or) Apache Server which is already started">Example 1:  Start the HTTPD (or) Apache Server which is already started</a></li></ul></li><li><a href="#Example_2_Install_Dependencies_via_PHP_Composer" title="Example 2:  Install Dependencies via PHP Composer">Example 2:  Install Dependencies via PHP Composer</a></li><li><a href="#How_to_use_ansible_failed_when_Statement" title="How to use ansible failed_when Statement">How to use ansible failed_when Statement</a><ul><li><a href="#Example_1_System_Requirement_Prerequisite_check_before_Installation" title="Example 1:  System Requirement / Prerequisite check before Installation">Example 1:  System Requirement / Prerequisite check before Installation</a></li></ul></li></ul></nav></div>
<h2><span class="ez-toc-section" id="The_Ansible_when_Statement">The Ansible <span style="color: #e32434;">when</span> Statement</span></h2>
<p>Ansible when statement is more like if statement in any given programming language. It evaluates if a condition is met or satisfied.</p>
<p>Consider yourself having any of the following requirements</p>
<ol>
<li>You want to run a task only in a specific box</li>
<li>You want to run a task based on the output of another task</li>
<li>You want to skip or proceed with an installation when the OS version is Linux or Ubuntu</li>
<li>You want to perform some disk clean up tasks when a threshold is reached</li>
<li>You want to control the execution when a certain value is reached in Loop</li>
</ol>
<p>More and more.  These are all the few test cases or real-time usage scenarios, I could think of.  I am certain, there would be more explored and unexplored possibilities for these conditional statements.</p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="How_to_use_ansible_when_Statement">How to use ansible <span style="color: #e32434;">when</span> Statement</span></h2>
<p>We are going to provide various examples of how to use ansible when statement , You can choose to read whichever example you would like to read</p>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Example_1_Shutdown_the_Debian_flavoured_servers">Example 1:  Shutdown the Debian flavoured servers</span></h3>
<p>In the following playbook,  we have used a when statement and a command to execute. The Command will only execute when the defined condition is satisfied, which is exactly <em>when the Operating system of the host is Debian</em></p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000;">tasks</span><span style="color: #000000; font-weight: bold;">:</span>
  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"shut</span> <span style="color: #4e9a06;">down</span> <span style="color: #4e9a06;">Debian</span> <span style="color: #4e9a06;">flavored</span> <span style="color: #4e9a06;">systems"</span>
    <span style="color: #000000;">command</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">/sbin/shutdown -t now</span>
    <span style="color: #000000;">when</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">ansible_os_family == "Debian"</span>
</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Example_2_Install_HTTPD_when_httpd_is_not_installed_already">Example 2:  Install HTTPD when httpd is not installed already</span></h3>
<p>Being aware that shell would return <strong>not found </strong>error message when the given command is not installed. We are using it as our search keyword to determine the installation of httpd.In this example, we are first making sure whether &#8220;Apache httpd&#8221; is already installed by running the httpd command over the shell.  The output of the command is saved into a register variable named &#8220;<code>validatedhttpd</code>&#8221;</p>
<p>When we run the following playbook, The first task will run the command httpd and the result of the command will be stored in &#8220;<code>validatehttpd</code>&#8221; register variable.</p>
<p>Then the second task, which is to install httpd using yum module. Will first execute the when condition we have specified and see if it is TRUE.</p>
<p>Therefore, If there is a &#8220;not found&#8221; error in the register variable. The HTTPD will be installed. If there is anything else.  HTTPD will not be installed and the task will be skipped.</p>
<p></p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000;">---</span> 
<span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">hosts</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">web</span>
  <span style="color: #000000;">tasks</span><span style="color: #000000; font-weight: bold;">:</span>
  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"Determine</span> <span style="color: #4e9a06;">if</span> <span style="color: #4e9a06;">the</span> <span style="color: #4e9a06;">HTTPD</span> <span style="color: #4e9a06;">is</span> <span style="color: #4e9a06;">installed"</span>
    <span style="color: #000000;">register</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">validatehttpd</span>
    <span style="color: #000000;">shell</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">httpd</span>

  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">Ensure Apache is at the Latest version</span>
    <span style="color: #000000;">become</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">yes</span>
    <span style="color: #000000;">become_user</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">root</span>
    <span style="color: #000000;">yum</span><span style="color: #000000; font-weight: bold;">:</span>
      <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">httpd</span>
      <span style="color: #000000;">state</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">latest</span>
    <span style="color: #000000;">when</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">'not</span> <span style="color: #4e9a06;">found'</span> <span style="color: #000000;">in validatehttpd.stdout</span>
</pre>
</div>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Example_3_Multiple_Conditions_in_Single_when_statement_Shutdown_only_CentOS-6_and_Debian-7">Example 3: [Multiple Conditions in Single when statement] Shutdown only <span style="font-family: 'andale mono', monospace;">CentOS-6</span> and <span style="font-family: 'andale mono', monospace;">Debian-7 </span></span></h3>
<p>Our requirement here is to shut down only CentOS6 and Debian7 version flavoured systems. So our conditional statement should be as followsAs said earlier,  when is more like an if statement so it should support the multiple conditions in a single validation.</p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000;">(ansible_distribution == "CentOS" and ansible_distribution_major_version == "6") or</span>
<span style="color: #000000;">(ansible_distribution == "Debian" and ansible_distribution_major_version == "7")</span>
</pre>
</div>
<p>&nbsp;</p>
<blockquote><p>Here we have used parenthesis ( ) for a grouping</p></blockquote>
<p>The Playbook is given below</p>
<p></p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000;">---</span>
<span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">hosts</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">all</span>
  <span style="color: #000000;">tasks</span><span style="color: #000000; font-weight: bold;">:</span>
  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"shut</span> <span style="color: #4e9a06;">down</span> <span style="color: #4e9a06;">CentOS</span> <span style="color: #4e9a06;">6</span> <span style="color: #4e9a06;">and</span> <span style="color: #4e9a06;">Debian</span> <span style="color: #4e9a06;">7</span> <span style="color: #4e9a06;">systems"</span>
    <span style="color: #000000;">command</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">/sbin/shutdown -t now</span>
    <span style="color: #000000;">when</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">(ansible_distribution == "CentOS" and ansible_distribution_major_version == "6") or</span>
          <span style="color: #000000;">(ansible_distribution == "Debian" and ansible_distribution_major_version == "7")</span>
</pre>
</div>
<p>&nbsp;</p>
<p>If our requirement is just to validate, If the OS distribution is <strong>CentOS</strong> and version is <strong>6 </strong>, We could write it like this</p>
<p></p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000;">tasks</span><span style="color: #000000; font-weight: bold;">:</span>
  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"shut</span> <span style="color: #4e9a06;">down</span> <span style="color: #4e9a06;">CentOS</span> <span style="color: #4e9a06;">6</span> <span style="color: #4e9a06;">systems"</span>
    <span style="color: #000000;">command</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">/sbin/shutdown -t now</span>
    <span style="color: #000000;">when</span><span style="color: #000000; font-weight: bold;">:</span>
      <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">ansible_distribution == "CentOS"</span>
      <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">ansible_distribution_major_version == "6"</span></pre>
</div>
<p>&nbsp;</p>
<p>What we do here is mentioning our conditions in a list and <em>ALL SHOULD BE TRUE </em> for this task to run</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<h2><span class="ez-toc-section" id="The_Ansible_failed_when_and_changed_when_Statements">The Ansible <span style="color: #e32434;">failed_when </span>and<span style="color: #e32434;"> changed_when</span> Statements</span></h2>
<p>Ansible failed_when and changed_when statements are similar to ansible when statement.  The only difference is that It will mark the task as <strong>failed</strong> or <strong>Success</strong>[changed], when the condition defined, is met or satisfied.</p>
<p>The primary purpose of the <code>failed_when</code> and <code>changed_when</code> statements are to determine whether the task is actually successful or failure</p>
<p>Consider you are running a <code>command</code> or <code>shell</code> module with some complex script or a simple command.</p>
<blockquote><p>Ansible would report it as <code>changed</code> as long as the command (or) script give ZERO return code.</p></blockquote>
<p>But how would you decide whether the command or script ran successfully? or met your needs?</p>
<p>For example,  When you are starting a Weblogic (or) Tomcat servers using some shell script or command. Ansible would invoke the script and consider it as done (or) changed. But you would never know whether its actually true until you re-validate with <code>wait_for</code> or  <code>debug</code> module</p>
<p>Let us see some real time practical examples for both failed_when and changed_when statements in the upcoming section</p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="How_to_use_ansible_changed_when_Statement">How to use ansible <span style="color: #e32434;">changed_when</span> Statement</span></h2>
<p>&nbsp;</p>
<h3><span class="ez-toc-section" id="Example_1_Start_the_HTTPD_or_Apache_Server_which_is_already_started">Example 1:  Start the HTTPD (or) Apache Server which is already started</span></h3>
<p>Having said that, Let&#8217;s start with our trialWe are going to start the HTTPD (or) Apache Server which is already running. Ideally, If it is already running it should not report as <strong>changed</strong></p>
<p><strong>Step 1:</strong> Making sure it is already running by invoking the <code>ps -eaf|grep -i httpd</code> command as <code>ad-hoc</code></p>
<p><a href="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.24.43-AM.png"><img class="alignnone wp-image-1825 size-full lazyload" src="../../wp-content/ewww/lazy/placeholder-772x184.png" alt="ansibled failed_when example" width="772" height="184" data-src="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.24.43-AM.png" loading="lazy" data-srcset="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.24.43-AM.png 772w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.24.43-AM-300x72.png 300w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.24.43-AM-768x183.png 768w" data-sizes="auto" /><noscript><img class="alignnone wp-image-1825 size-full" src="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.24.43-AM.png" alt="ansibled failed_when example" width="772" height="184" srcset="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.24.43-AM.png 772w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.24.43-AM-300x72.png 300w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.24.43-AM-768x183.png 768w" sizes="(max-width: 772px) 100vw, 772px" data-eio="l" /></noscript></a></p>
<p><strong>Step 2:</strong>  Use the following playbook with the task to start the HTTPD  server</p>
<p></p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000;">---</span> 
<span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">hosts</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">web</span>
  <span style="color: #000000;">tasks</span><span style="color: #000000; font-weight: bold;">:</span>
   <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"Start</span> <span style="color: #4e9a06;">the</span> <span style="color: #4e9a06;">Apache</span> <span style="color: #4e9a06;">HTTPD</span> <span style="color: #4e9a06;">Server"</span>
     <span style="color: #000000;">become</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">true</span>
     <span style="color: #000000;">become_user</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">root</span>
     <span style="color: #000000;">shell</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"httpd</span> <span style="color: #4e9a06;">-k</span> <span style="color: #4e9a06;">start"</span>
</pre>
</div>
<p>&nbsp;</p>
<p><a href="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.30.58-AM.png"><img class="alignnone wp-image-1826 size-full lazyload" src="../../wp-content/ewww/lazy/placeholder-931x216.png" alt="" width="931" height="216" data-src="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.30.58-AM.png" loading="lazy" data-srcset="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.30.58-AM.png 931w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.30.58-AM-300x70.png 300w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.30.58-AM-768x178.png 768w" data-sizes="auto" /><noscript><img class="alignnone wp-image-1826 size-full" src="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.30.58-AM.png" alt="" width="931" height="216" srcset="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.30.58-AM.png 931w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.30.58-AM-300x70.png 300w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.30.58-AM-768x178.png 768w" sizes="(max-width: 931px) 100vw, 931px" data-eio="l" /></noscript></a></p>
<p>As you could see in the preceding execution output snapshot,  The task to start the httpd server has been marked as changed despite it did not actually start the apache and it was already running.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p><strong>Step 2a:</strong>  Modified Playbook with Debug Enabled</p>
<p>To know the truth, you should modify the playbook with a debug and register as follows</p>
<p></p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000;">---</span> 
<span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">hosts</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">web</span>
  <span style="color: #000000;">tasks</span><span style="color: #000000; font-weight: bold;">:</span>
    <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"Start</span> <span style="color: #4e9a06;">the</span> <span style="color: #4e9a06;">Apache</span> <span style="color: #4e9a06;">HTTPD</span> <span style="color: #4e9a06;">Server"</span>
      <span style="color: #000000;">become</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">true</span>
      <span style="color: #000000;">become_user</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">root</span>
      <span style="color: #000000;">register</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">starthttpdout</span>
      <span style="color: #000000;">shell</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"httpd</span> <span style="color: #4e9a06;">-k</span> <span style="color: #4e9a06;">start"</span>
      

    <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">debug</span><span style="color: #000000; font-weight: bold;">:</span>
        <span style="color: #000000;">msg</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"{{starthttpdout.stdout}}"</span>
</pre>
</div>
<p>&nbsp;</p>
<p>The execution output of the preceding playbook is given below</p>
<p><a href="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.37.52-AM.png"><img class="size-full wp-image-1827 alignleft lazyload" src="../../wp-content/ewww/lazy/placeholder-776x308.png" alt="" width="776" height="308" data-src="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.37.52-AM.png" loading="lazy" data-srcset="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.37.52-AM.png 776w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.37.52-AM-300x119.png 300w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.37.52-AM-768x305.png 768w" data-sizes="auto" /><noscript><img class="size-full wp-image-1827 alignleft" src="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.37.52-AM.png" alt="" width="776" height="308" srcset="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.37.52-AM.png 776w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.37.52-AM-300x119.png 300w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.37.52-AM-768x305.png 768w" sizes="(max-width: 776px) 100vw, 776px" data-eio="l" /></noscript></a></p>
<p>&nbsp;</p>
<p>Hope the execution output is already self-explanatory.   You could see the ansible considering the task as changed when it has not actually started it</p>
<p>Here comes the <code>changed_when</code> to explicitly tell ansible when to consider the task as Successful (or) changed</p>
<p>Let us re modify our same Playbook with <code>changed_when</code></p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;"><strong>Step 3:</strong> The Modified Playbook with <span style="color: #ff007b;">changed_when</span></span></p>
<p></p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000;">---</span> 
<span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">hosts</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">web</span>
  <span style="color: #000000;">tasks</span><span style="color: #000000; font-weight: bold;">:</span>
  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"Start</span> <span style="color: #4e9a06;">the</span> <span style="color: #4e9a06;">Apache</span> <span style="color: #4e9a06;">HTTPD</span> <span style="color: #4e9a06;">Server"</span>
    <span style="color: #000000;">become</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">true</span>
    <span style="color: #000000;">become_user</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">root</span>
    <span style="color: #000000;">register</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">starthttpdout</span>
    <span style="color: #000000;">shell</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"httpd</span> <span style="color: #4e9a06;">-k</span> <span style="color: #4e9a06;">start"</span>
    <span style="color: #000000;">changed_when</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"'already</span> <span style="color: #4e9a06;">running'</span> <span style="color: #4e9a06;">not</span> <span style="color: #4e9a06;">in</span> <span style="color: #4e9a06;">starthttpdout.stdout"</span>

  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">debug</span><span style="color: #000000; font-weight: bold;">:</span>
      <span style="color: #000000;">msg</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"{{starthttpdout.stdout}}"</span>
</pre>
</div>
<p>&nbsp;</p>
<p>We have just added a single line to our previous version of playbook.</p>
<blockquote><p>changed_when: &#8220;&#8216;already running&#8217; is not in starthttpdout.stdout&#8221;</p></blockquote>
<p>The Execution Output of our new playbook is given below</p>
<p><a href="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.51.01-AM.png"><img class="alignnone size-full wp-image-1828 lazyload" src="../../wp-content/ewww/lazy/placeholder-794x334.png" alt="ansible changed_when example" width="794" height="334" data-src="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.51.01-AM.png" loading="lazy" data-srcset="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.51.01-AM.png 794w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.51.01-AM-300x126.png 300w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.51.01-AM-768x323.png 768w" data-sizes="auto" /><noscript><img class="alignnone size-full wp-image-1828" src="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.51.01-AM.png" alt="ansible changed_when example" width="794" height="334" srcset="../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.51.01-AM.png 794w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.51.01-AM-300x126.png 300w, ../../wp-content/uploads/2018/09/Screen-Shot-2018-09-23-at-12.51.01-AM-768x323.png 768w" sizes="(max-width: 794px) 100vw, 794px" data-eio="l" /></noscript></a></p>
<p>Now you can notice that the task is <span style="color: #339966;">GREEN</span>, not <span style="color: #ffcc00;">YELLOW</span>. In other words, It is <strong>unchanged</strong></p>
<p>&nbsp;</p>
<h2><span class="ez-toc-section" id="Example_2_Install_Dependencies_via_PHP_Composer">Example 2:  Install Dependencies via PHP Composer</span></h2>
<div class="page" title="Page 103">
<div class="layoutArea">
<div class="column">
<p>When using PHP Composer as a command to install project dependencies, it’s useful to know when Composer installed something, or when nothing changed. Here’s an example:</p>
<p></p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">Install dependencies via Composer.</span>
  <span style="color: #000000;">command</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"/usr/local/bin/composer</span> <span style="color: #4e9a06;">global</span> <span style="color: #4e9a06;">require</span> <span style="color: #4e9a06;">phpunit/phpunit</span> <span style="color: #4e9a06;">--prefer-dist"</span>
  <span style="color: #000000;">register</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">composer</span>
  <span style="color: #000000;">changed_when</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"'Nothing</span> <span style="color: #4e9a06;">to</span> <span style="color: #4e9a06;">install</span> <span style="color: #4e9a06;">or</span> <span style="color: #4e9a06;">update'</span> <span style="color: #4e9a06;">not</span> <span style="color: #4e9a06;">in</span> <span style="color: #4e9a06;">composer.stdout"</span>
</pre>
</div>
<p>&nbsp;</p>
</div>
</div>
<div class="layoutArea">
<div class="column">
<p>You can see we used  <code>register</code> to store the results of the command, then we checked whether a certain string was in the registered variable’s stdout.</p>
<p>Only when Composer doesn’t do anything it will print “Nothing to install or update”, so we use that string to determine or to tell Ansible if the task resulted in a change.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3398911159151128" data-ad-slot="1946393371"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
</div>
<h2><span class="ez-toc-section" id="How_to_use_ansible_failed_when_Statement">How to use ansible <span style="color: #e32434;">failed_when</span> Statement</span></h2>
<h3><span class="ez-toc-section" id="Example_1_System_Requirement_Prerequisite_check_before_Installation">Example 1:  System Requirement / Prerequisite check before Installation</span></h3>
<div class="page" title="Page 103">
<div class="layoutArea">
<div class="column">
<p>This one is a more real-time scenario every one of us might have come across, During the installation of software, in midway, the installation wizard will fail stating that there is no enough memory (or) the minimum system requirements to install that specific software is not met</p>
<p>As we all know, Every Software needs some minimum system requirements. When they are not met, The installation would fail.</p>
<p>In our case, We are going to take weblogic application server installation as an example.</p>
<p>As per oracle recommendation for weblogic 12c to function properly and for hassle-free installation, The system must meet the following requirement</p>
<ul style="list-style-type: square;">
<li>2 GB of Physical Memory ( RAM)</li>
<li>Minimum 4 GB of Disk space in Domain Directory <code>/opt</code></li>
<li>Minimum 1 GB of disk space in <code>/tmp</code> directory</li>
</ul>
<p>Now we are going to perform a quick pre-requisite check using ansible <strong>failed_when </strong>and determine whether the system requirement specified above are met</p>
<p>Consider the following playbook</p>
<p></p>
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #000000;">---</span>
<span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">hosts</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">app</span>
  <span style="color: #000000;">tasks</span><span style="color: #000000; font-weight: bold;">:</span>
  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">Making sure the /tmp has more than 1gb</span>
    <span style="color: #000000;">shell</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"df</span> <span style="color: #4e9a06;">-h</span> <span style="color: #4e9a06;">/tmp|grep</span> <span style="color: #4e9a06;">-v</span> <span style="color: #4e9a06;">Filesystem|awk</span> <span style="color: #4e9a06;">'{print</span> <span style="color: #4e9a06;">$4}'|cut</span> <span style="color: #4e9a06;">-d</span> <span style="color: #4e9a06;">G</span> <span style="color: #4e9a06;">-f1"</span>
    <span style="color: #000000;">register</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">tmpspace</span>
    <span style="color: #000000;">failed_when</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"tmpspace.stdout|float</span> <span style="color: #4e9a06;">&lt;</span> <span style="color: #4e9a06;">1"</span>

  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">Making sure the /opt has more than 4gb</span>
    <span style="color: #000000;">shell</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"df</span> <span style="color: #4e9a06;">-h</span> <span style="color: #4e9a06;">/opt|grep</span> <span style="color: #4e9a06;">-v</span> <span style="color: #4e9a06;">Filesystem|awk</span> <span style="color: #4e9a06;">'{print</span> <span style="color: #4e9a06;">$4}'|cut</span> <span style="color: #4e9a06;">-d</span> <span style="color: #4e9a06;">G</span> <span style="color: #4e9a06;">-f1"</span>
    <span style="color: #000000;">register</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">tmpspace</span>
    <span style="color: #000000;">failed_when</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"tmpspace.stdout|float</span> <span style="color: #4e9a06;">&lt;</span> <span style="color: #4e9a06;">4"</span>

  <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000;">name</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">Making sure the Physical Memory more than 2gb</span>
    <span style="color: #000000;">shell</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"cat</span> <span style="color: #4e9a06;">/proc/meminfo|grep</span> <span style="color: #4e9a06;">-i</span> <span style="color: #4e9a06;">memtotal|awk</span> <span style="color: #4e9a06;">'{print</span> <span style="color: #4e9a06;">$2/1024/1024}'"</span>
    <span style="color: #000000;">register</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #000000;">memory</span>
    <span style="color: #000000;">failed_when</span><span style="color: #000000; font-weight: bold;">:</span> <span style="color: #4e9a06;">"memory.stdout|float</span> <span style="color: #4e9a06;">&lt;</span> <span style="color: #4e9a06;">2"</span>
</pre>
</div>
<p>&nbsp;</p>
</div>
</div>
</div>
<p>The playbook has been created exactly to validate if the system is meeting the oracle recommended System Requirements.</p>
<p>The tasks are programmed to fail when they are not meeting the requirements. This is done using failed_when and a simple math.</p>
<p>Execution Output of the playbook is given below</p>
<p><a href="../../wp-content/uploads/2018/09/ansible_failedwhen.png"><img class="alignnone size-full wp-image-1842 lazyload" src="../../wp-content/ewww/lazy/placeholder-1440x357.png" alt="" width="1440" height="357" data-src="../../wp-content/uploads/2018/09/ansible_failedwhen.png" loading="lazy" data-srcset="../../wp-content/uploads/2018/09/ansible_failedwhen.png 1440w, ../../wp-content/uploads/2018/09/ansible_failedwhen-300x74.png 300w, ../../wp-content/uploads/2018/09/ansible_failedwhen-768x190.png 768w, ../../wp-content/uploads/2018/09/ansible_failedwhen-1024x254.png 1024w" data-sizes="auto" /><noscript><img class="alignnone size-full wp-image-1842" src="../../wp-content/uploads/2018/09/ansible_failedwhen.png" alt="" width="1440" height="357" srcset="../../wp-content/uploads/2018/09/ansible_failedwhen.png 1440w, ../../wp-content/uploads/2018/09/ansible_failedwhen-300x74.png 300w, ../../wp-content/uploads/2018/09/ansible_failedwhen-768x190.png 768w, ../../wp-content/uploads/2018/09/ansible_failedwhen-1024x254.png 1024w" sizes="(max-width: 1440px) 100vw, 1440px" data-eio="l" /></noscript></a></p>
<p>as shown in the preceding snapshot, The final requirement, The Physical memory is not enough (or) not meeting our requirement of 2gb. You can notice that the system is built with 1gb in the <code>stdout</code> of the error message</p>
<p>We come to a conclusion, as we have already discussed about all three conditional statements like when, failed_when and changed_when in detail with examples</p>
<p>Hope it is useful and make sense.</p>
<a href="../../wp-content/uploads/2021/09/DaaS.svg"><img class="post-img lazyload" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1047 415'%3E%3C/svg%3E" alt="gritfy" width="1047" height="415" class="post-img lazyload" data-src="../../wp-content/uploads/2021/09/DaaS.svg" loading="lazy" /><noscript><img class="post-img" src="../../wp-content/uploads/2021/09/DaaS.svg" alt="gritfy" width="1047" height="415" class="alignnone size-full wp-image-6623" data-eio="l" /></noscript></a>
<p>Thanks</p>
<p>Rumen Lishkov</p>
<div id="postfollow">
<a href='https://ko-fi.com/O4O51FG7C' target='_blank'><img height='46' style='border:0px;height:46px;width: 186px' src='data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==' border='0' alt='Buy Me a Coffee at ko-fi.com' data-src="https://az743702.vo.msecnd.net/cdn/kofi3.png?v=2" loading="lazy" class="lazyload" /><noscript><img height='46' style='border:0px;height:46px;width: 186px' src='https://az743702.vo.msecnd.net/cdn/kofi3.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' data-eio="l" /></noscript></a>
<p>Follow us on<a href="https://www.facebook.com/rumenlishkov">Facebook</a> or<a href="https://www.twitter.com/mwinventory">Twitter</a>
</br>
For more practical videos and tutorials. <a href="https://www.youtube.com/kiss2mark">Subscribe to our channel</a>
</br>
Find me on Linkedin <a href="https://www.linkedin.com/in/rumen-lishkov/">My Profile</a>
</br>
</i>For any Consultation or to hire us <a href="../../cdn-cgi/l/email-protection.html#38505d545457785f4a514c5e41165b5755"> <span class="__cf_email__" data-cfemail="dcb4b9b0b0b39cbbaeb5a8baa5f2bfb3b1">[email&#160;protected]</span></a>
</br>
If you like this article. Show your Support! <a href="https://ko-fi.com/middlewareinventory">Buy me a Coffee.</a>
</br>
</p>
<p style="color: palevioletred !important;">Signup for Exclusive "Subscriber-only" Content</p>
<div class="emaillist">
<form action="#" method="post" class="es_subscription_form es_shortcode_form" id="es_subscription_form_1657190865" data-source="ig-es">
<div class="es-field-wrap"><label>Name*<br /><input type="text" name="name" class="ig_es_form_field_name" placeholder="" value="" required="required" /></label></div><div class="es-field-wrap"><label>Email*<br /><input class="es_required_field es_txt_email ig_es_form_field_email" type="email" name="email" value="" placeholder="" required="required" /></label></div><input type="hidden" name="lists[]" value="1" /><input type="hidden" name="form_id" value="3" />
<input type="hidden" name="es_email_page" value="1768" />
<input type="hidden" name="es_email_page_url" value="https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" />
<input type="hidden" name="status" value="Unconfirmed" />
<input type="hidden" name="es-subscribe" id="es-subscribe" value="915ddf1a10" />
<label style="position:absolute;top:-99999px;left:-99999px;z-index:-99;"><input type="email" name="es_hp_email" class="es_required_field" tabindex="-1" autocomplete="-1" value="" /></label>
<input type="submit" name="submit" class="es_subscription_form_submit es_submit_button es_textbox_button" id="es_subscription_form_submit_1657190865" value="Subscribe" />
<span class="es_spinner_image" id="spinner-image"><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Loading" data-src="../../wp-content/plugins/email-subscribers/lite/public/images/spinner.gif" loading="lazy" class="lazyload" /><noscript><img src="../../wp-content/plugins/email-subscribers/lite/public/images/spinner.gif" alt="Loading" data-eio="l" /></noscript></span>
</form>
<span class="es_subscription_message" id="es_subscription_message_1657190865"></span>
</div>
</div>
<hr>
<p>&nbsp;</p>
<div class='rp4wp-related-posts'>
<h3>More from Middleware Inventory</h3>
<ul>
<li><div class='rp4wp-related-post-image'>
<a href='../ansible-when-variable-is-defined-or-undefined-examples/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" data-src="../../wp-content/uploads/2018/12/Screen-Shot-2018-12-01-at-7.06.23-AM-150x150.png.html" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2018/12/Screen-Shot-2018-12-01-at-7.06.23-AM-150x150.png.html" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../ansible-when-variable-is-defined-or-undefined-examples/index.html'>Ansible When Variable is defined or undefined Examples</a><p>The Purpose The purpose of this post is to give you a real-time example and explanation of how ansible variable is defined and not defined (undefined) conditionals are working along with "when"&nbsp;conditional statement and how it controls the flow of the task and the play. The following ansible playbook is&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../ansible-command-examples/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="Ansible Command" data-src="../../wp-content/uploads/2019/04/AnsibleCommand-1-150x150.jpeg" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/04/AnsibleCommand-1-150x150.jpeg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Ansible Command" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../ansible-command-examples/index.html'>Ansible Command Module Examples</a><p>Ansible Command Module Introduction Ansible Command module is used to execute commands on a remote node. The Command module, is used mostly to run simple Linux commands on a remote node/server which is part of a host group or Stand alone server mentioned in the host group. If you want&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../ansible-ad-hoc-commands/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="" data-src="../../wp-content/uploads/2019/01/Screen-Shot-2019-01-16-at-4.23.23-AM-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/01/Screen-Shot-2019-01-16-at-4.23.23-AM-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../ansible-ad-hoc-commands/index.html'>Ansible AD HOC Command Examples - Ansible Cheat Sheet | Devops Junction</a><p>Ansible ad hoc commands are one-liners designed to achieve a very specific task they are like quick snippets and your compact swiss army knife when you want to do a quick task across multiple machines. To put simply, Ansible ad hoc commands are one-liner Linux shell commands and playbooks are&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../ansible-replace-line-in-file-ansible-replace-examples/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="Ansible replace examples" data-src="../../wp-content/uploads/2019/02/Screen-Shot-2019-02-07-at-3.21.33-PM-1-150x150.png" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/02/Screen-Shot-2019-02-07-at-3.21.33-PM-1-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Ansible replace examples" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../ansible-replace-line-in-file-ansible-replace-examples/index.html'>Ansible replace line in file - Ansible Replace Examples | Devops Junction</a><p>This article is about "how to replace a line in file using ansible and seeing various other examples of ansible replace module".&nbsp; Ansible facilitates us with a dedicated module named as replace&nbsp;The working principle of this module is more like find and replace&nbsp;in your favourite editor and it also supports&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-image'>
<a href='../ansible-wait_for-examples/index.html'><img width="150" height="150" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 150'%3E%3C/svg%3E" class="attachment-thumbnail size-thumbnail wp-post-image lazyload" alt="ansible wait_for examples" data-src="../../wp-content/uploads/2019/01/wait-for-150x150.jpeg" loading="lazy" /><noscript><img width="150" height="150" src="../../wp-content/uploads/2019/01/wait-for-150x150.jpeg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="ansible wait_for examples" data-eio="l" /></noscript></a></div>
<div class='rp4wp-related-post-content'>
<a href='../ansible-wait_for-examples/index.html'>Ansible wait_for module examples - How to | Devops Junction</a><p>Introduction to Ansible wait_for module Ansible wait_for&nbsp;module can be used to pause your playbook execution and to wait for many different things or conditions before continuing with the execution. The wait_for module of ansible is to make your playbook or task execution halt or pause for various reasons and for&hellip;</p></div>
</li>
</ul>
</div>
</div>
<footer class="entry-footer">
<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="../ansible-facts-list-how-to-use-ansible-facts/index.html" rel="prev"><span class="screen-reader-text">Previous Post:</span>Ansible Facts and How to use them &#8211; Ansible Variable list</a></div><div class="nav-next"><a href="../let-m-read-controlled-read-access-to-linux-users/index.html" rel="next"><span class="screen-reader-text">Next Post:</span>LET-M-READ &#8211; Controlled Read Access to Linux Users</a></div></div>
</nav>
</footer>
</article>
<div id="disqus_thread"></div>
</main>
</section>
<section id="secondary" class="sidebar widget-area clearfix" role="complementary">
<aside id="custom_html-18" class="widget_text widget widget_custom_html clearfix"><div class="textwidget custom-html-widget"><script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3398911159151128" crossorigin="anonymous"></script>


<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div></aside><aside id="categories-8" class="widget widget_categories clearfix"><div class="widget-header"><h3 class="widget-title">Categories</h3></div>
<ul>
<li class="cat-item cat-item-61"><a href="../category/activemq/index.html">ActiveMQ</a> (4)
</li>
<li class="cat-item cat-item-98"><a href="../category/ansible/index.html">Ansible</a> (65)
</li>
<li class="cat-item cat-item-10"><a href="../category/apache/index.html">Apache</a> (8)
</li>
<li class="cat-item cat-item-234"><a href="../category/aws/index.html">AWS</a> (28)
</li>
<li class="cat-item cat-item-452"><a href="../category/azure/index.html">Azure</a> (1)
</li>
<li class="cat-item cat-item-8"><a href="../category/best-practice/index.html">Best Practice</a> (5)
</li>
<li class="cat-item cat-item-390"><a href="../category/bitbucket/index.html">BitBucket</a> (1)
</li>
<li class="cat-item cat-item-426"><a href="../category/boto/index.html">Boto</a> (1)
</li>
<li class="cat-item cat-item-399"><a href="../category/cloud/index.html" title="Cloud is not only a concept but also a practice of using a network of remote servers hosted on the Internet to store, manage, and process data.">Cloud</a> (1)
</li>
<li class="cat-item cat-item-397"><a href="../category/database/index.html">Database</a> (1)
</li>
<li class="cat-item cat-item-95"><a href="../category/development/index.html">Development</a> (3)
</li>
<li class="cat-item cat-item-152"><a href="../category/docker/index.html">Docker</a> (11)
</li>
<li class="cat-item cat-item-422"><a href="../category/efk/index.html">EFK</a> (1)
</li>
<li class="cat-item cat-item-423"><a href="../category/elastic-search/index.html">Elastic Search</a> (1)
</li>
<li class="cat-item cat-item-59"><a href="../category/f5-big-ip/index.html">F5-Big-IP</a> (6)
</li>
<li class="cat-item cat-item-419"><a href="../category/fluentd/index.html">FluentD</a> (2)
</li>
<li class="cat-item cat-item-424"><a href="../category/gcp-googlecloud/index.html">GCP &#8211; GoogleCloud</a> (1)
</li>
<li class="cat-item cat-item-450"><a href="../category/github-actions/index.html">Github Actions</a> (1)
</li>
<li class="cat-item cat-item-428"><a href="../category/grafana/index.html">Grafana</a> (1)
</li>
<li class="cat-item cat-item-275"><a href="../category/graphite/index.html">Graphite</a> (1)
</li>
<li class="cat-item cat-item-441"><a href="../category/ibm-cloud/index.html">IBM Cloud</a> (1)
</li>
<li class="cat-item cat-item-401"><a href="../category/ibm-websphere/index.html" title="IBM® WebSphere® Application Server provides a range of flexible and secure runtime for Java enterprise applications, lightweight web applications and microservices. You can create new applications and enhance and optimize existing application infrastructure on premises or across any public, private or hybrid cloud. In addition, by utilizing IBM Cloud Private, you can create on-premises cloud capabilities similar to public clouds to accelerate app development. The platform is built on the open source Kubernetes-based container architecture and supports both Docker containers and Cloud Foundry.">IBM Websphere</a> (2)
</li>
<li class="cat-item cat-item-354"><a href="../category/ihs-and-apache/index.html">IHS and Apache</a> (10)
</li>
<li class="cat-item cat-item-353"><a href="../category/iis/index.html">IIS</a> (4)
</li>
<li class="cat-item cat-item-388"><a href="../category/javascript/index.html">JavaScript</a> (3)
</li>
<li class="cat-item cat-item-286"><a href="../category/jenkins/index.html">Jenkins</a> (4)
</li>
<li class="cat-item cat-item-15"><a href="../category/joomla/index.html">Joomla</a> (1)
</li>
<li class="cat-item cat-item-151"><a href="../category/kubernetes/index.html">Kubernetes</a> (16)
</li>
<li class="cat-item cat-item-191"><a href="../category/middleware/index.html">Middleware</a> (3)
</li>
<li class="cat-item cat-item-322"><a href="../category/network-troubleshooting/index.html">Network Troubleshooting</a> (1)
</li>
<li class="cat-item cat-item-413"><a href="../category/networking/index.html">Networking</a> (1)
</li>
<li class="cat-item cat-item-273"><a href="../category/nodejs/index.html">NodeJS</a> (2)
</li>
<li class="cat-item cat-item-396"><a href="../category/office365/index.html">Office365</a> (1)
</li>
<li class="cat-item cat-item-148"><a href="../category/opensource/index.html">OpenSource</a> (2)
</li>
<li class="cat-item cat-item-417"><a href="../category/oracle-db/index.html">Oracle DB</a> (3)
</li>
<li class="cat-item cat-item-404"><a href="../category/oracle-weblogic/index.html" title="WebLogic is a leading Application Server product most widely used for e-commerce online transaction processing (OLTP) platform application, developed to connect users in a distributed computing environment and to facilitate the integration of mainframe applications with distributed corporate data and applications.">Oracle Weblogic</a> (2)
</li>
<li class="cat-item cat-item-232"><a href="../category/packer/index.html">Packer</a> (2)
</li>
<li class="cat-item cat-item-146"><a href="../category/perl/index.html">Perl</a> (1)
</li>
<li class="cat-item cat-item-60"><a href="../category/php/index.html">PHP</a> (1)
</li>
<li class="cat-item cat-item-453"><a href="../category/postgresql/index.html">PostgreSQL</a> (1)
</li>
<li class="cat-item cat-item-343"><a href="../category/powershell/index.html">PowerShell</a> (1)
</li>
<li class="cat-item cat-item-31"><a href="../category/weblogic/problemsolution/index.html">problem/solution</a> (8)
</li>
<li class="cat-item cat-item-427"><a href="../category/prometheus/index.html">Prometheus</a> (1)
</li>
<li class="cat-item cat-item-445"><a href="../category/pulumi/index.html">Pulumi</a> (1)
</li>
<li class="cat-item cat-item-285"><a href="../category/python-flask/index.html">Python Flask</a> (1)
</li>
<li class="cat-item cat-item-22"><a href="../category/python_scripts/index.html">python_scripts</a> (7)
</li>
<li class="cat-item cat-item-446"><a href="../category/redis/index.html">Redis</a> (1)
</li>
<li class="cat-item cat-item-451"><a href="../category/serverless/index.html">Serverless</a> (1)
</li>
<li class="cat-item cat-item-12"><a href="../category/shell-scripting/index.html">Shell Scripting</a> (6)
</li>
<li class="cat-item cat-item-125"><a href="../category/soap-web-services/index.html">SOAP Web Services</a> (1)
</li>
<li class="cat-item cat-item-13"><a href="../category/splunk/index.html">Splunk</a> (1)
</li>
<li class="cat-item cat-item-425"><a href="../category/sre/index.html">SRE</a> (1)
</li>
<li class="cat-item cat-item-274"><a href="../category/statsd/index.html">StatsD</a> (1)
</li>
<li class="cat-item cat-item-233"><a href="../category/terraform/index.html">Terraform</a> (12)
</li>
<li class="cat-item cat-item-35"><a href="../category/tomcat/index.html">tomcat</a> (7)
</li>
<li class="cat-item cat-item-147"><a href="../category/tools/index.html">tools</a> (5)
</li>
<li class="cat-item cat-item-391"><a href="../category/traefik/index.html">Traefik</a> (1)
</li>
<li class="cat-item cat-item-124"><a href="../category/troubleshooting/index.html">Troubleshooting</a> (3)
</li>
<li class="cat-item cat-item-1"><a href="../category/uncategorized/index.html">Uncategorized</a> (5)
</li>
<li class="cat-item cat-item-7"><a href="../category/unix/index.html">Unix</a> (5)
</li>
<li class="cat-item cat-item-99"><a href="../category/vagrant/index.html">Vagrant</a> (4)
</li>
<li class="cat-item cat-item-389"><a href="../category/vuejs/index.html">VueJS</a> (2)
</li>
<li class="cat-item cat-item-356"><a href="../category/vulnerabilities-fixes/index.html">Vulnerabilities &amp; Fixes</a> (21)
</li>
<li class="cat-item cat-item-21"><a href="../category/weblogic/index.html">weblogic</a> (51)
</li>
<li class="cat-item cat-item-9"><a href="../category/webserver/index.html">Webserver</a> (1)
</li>
<li class="cat-item cat-item-92"><a href="../category/websphere/index.html">Websphere</a> (8)
</li>
<li class="cat-item cat-item-321"><a href="../category/windows-server/index.html">Windows Server</a> (5)
</li>
<li class="cat-item cat-item-55"><a href="../category/wlst/index.html">wlst</a> (7)
</li>
<li class="cat-item cat-item-36"><a href="../category/wordpress/index.html">wordpress</a> (2)
</li>
<li class="cat-item cat-item-4"><a href="../category/wsadmin-scripts/index.html">wsadmin scripts</a> (1)
</li>
</ul>
</aside><aside id="media_image-5" class="widget widget_media_image clearfix"><img width="267" height="400" src="../../wp-content/ewww/lazy/placeholder-267x400.png" class="image wp-image-8825  attachment-full size-full lazyload" alt="write for devopsjunction" style="max-width: 100%; height: auto;" data-src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" loading="lazy" data-srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" data-sizes="auto" /><noscript><img width="267" height="400" src="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png" class="image wp-image-8825  attachment-full size-full" alt="write for devopsjunction" style="max-width: 100%; height: auto;" srcset="../../wp-content/uploads/2022/07/write-for-us-devopsjunction.png 267w, ../../wp-content/uploads/2022/07/write-for-us-devopsjunction-200x300.png 200w" sizes="(max-width: 267px) 100vw, 267px" data-eio="l" /></noscript></aside>
</section>
</div>
<div id="footer" class="footer-wrap">
<footer id="colophon" class="site-footer container clearfix" role="contentinfo">
<div id="footer-text" class="site-info">
<span class="credit-link">Powered by <a href="../../index.html" title="Rumen Lishkov">Rumen Lishkov</a> and <a href="https://rumen.free.bg/" title="Studio-1">Studio1 Sofia</a> </span>
</div>
</footer>
</div>
</div>
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@mwinventory" />
<meta name="twitter:creator" content="@mwinventory" />
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&amp;display=swap" rel="stylesheet"><div class="simplesocialbuttons simplesocial-round-icon simplesocialbuttons-float-left-center post-1768 post  ssb_counter-activate simplesocialbuttons-slide-bottom-in">
<button class="simplesocial-fb-share" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Facebook </span> <span class="ssb_counter ssb_fbshare_counter">0</span></button>
<button class="simplesocial-twt-share" data-href="https://twitter.com/share?text=Ansible+changed_when+and+failed_when+examples&url=https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">Twitter</span> <span class="ssb_counter ssb_twitter_counter">0</span></button>
<button target="popup" class="simplesocial-linkedin-share" data-href="https://www.linkedin.com/cws/share?url=https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><span class="simplesocialtxt">LinkedIn</span></button>
<button onclick="javascript:window.location.href = this.dataset.href;return false;" class="simplesocial-email-share" data-href="mailto:?subject=Ansible+changed_when+and+failed_when+examples&body=https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/"><span class="simplesocialtxt">Email</span></button>
<button onclick="javascript:window.open(this.dataset.href, '_blank' );return false;" class="simplesocial-whatsapp-share" data-href="https://web.whatsapp.com/send?text=https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/"><span class="simplesocialtxt">WhatsApp</span></button>
</div>
<script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' id='disqus_count-js-extra'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"mwinventory"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f8767.js"></script>
<script type='text/javascript' id='disqus_embed-js-extra'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.22"},"disqusIdentifier":"1768 http:\/\/www.middlewareinventory.com\/?p=1768","disqusShortname":"mwinventory","disqusTitle":"Ansible changed_when and failed_when examples","disqusUrl":"https:\/\/www.middlewareinventory.com\/blog\/ansible-changed_when-and-failed_when-examples\/","postId":"1768"};
/* ]]> */
</script>

<script src="../../wp-content/cache/minify/bccbc.js"></script>
<script type='text/javascript' id='dae-download-js-extra'>
/* <![CDATA[ */
var objDaeDownload = {"ajaxUrl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"2019084a26"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/8510d.js"></script>
<script type='text/javascript' id='socialsnap-js-js-extra'>
/* <![CDATA[ */
var socialsnap_script = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","on_media_width":"250","on_media_height":"250","nonce":"b4d440853b","post_id":"1768"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/fef55.js"></script>
<script type='text/javascript' id='aicp-js-extra'>
/* <![CDATA[ */
var AICP = {"ajaxurl":"https:\/\/www.middlewareinventory.com\/wp-admin\/admin-ajax.php","nonce":"0b980bed5f","ip":"196.15.23.22","clickLimit":"1","clickCounterCookieExp":"3","banDuration":"7","countryBlockCheck":"No","banCountryList":"RU"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/ff9fe.js"></script>
<script type='text/javascript' src='https://js.stripe.com/v3/?ver=2.03' id='stripe-js'></script>
<script type='text/javascript' id='q2w3_fixed_widget-js-extra'>
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"q2w3-default-sidebar","margin_top":10,"margin_bottom":0,"stop_id":"","screen_max_width":1026,"screen_max_height":0,"width_inherit":true,"refresh_interval":1500,"window_load_hook":false,"disable_mo_api":false,"widgets":["text-32"]}];
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/f2bcf.js"></script>
<script type='text/javascript' id='enlighterjs-js-after'>
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"enlighter","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
</script>
<script src="../../wp-content/cache/minify/129c2.js"></script>
<script type='text/javascript' id='ez-toc-js-js-extra'>
/* <![CDATA[ */
var ezTOC = {"smooth_scroll":"1","visibility_hide_by_default":"","width":"100%","scroll_offset":"30"};
/* ]]> */
</script>
<script src="../../wp-content/cache/minify/0c713.js"></script>
<div id="ss-copy-popup" class="ss-popup-overlay">
<div class="ss-popup">
<div class="ss-popup-heading">
<span>Copy link</span>
<a href="#" id="ss-close-share-networks-modal" class="ss-close-modal" rel="nofollow"><i class="ss ss-close"></i></a>
</div>
<div class="ss-popup-content">
<div class="ss-copy-action">
<input type="text" readonly="readonly" value="https://www.middlewareinventory.com/blog/ansible-changed_when-and-failed_when-examples/" class="ss-copy-action-field" />
<a href="#" class="ss-button" rel="nofollow">Copy<span class="ss-share-network-tooltip">Copied</span></a>
<i class="ss ss-copy"></i>
</div>
<div class="ss-powered-by">Powered by <a href="https://socialsnap.com/?utm_source=WordPress&amp;utm_medium=link&amp;utm_campaign=inthewild" target="_blank" rel="nofollow noopener"><i class="ss ss-socialsnap"></i>Social Snap</a></div>
</div>
</div>
</div>
<script type='text/javascript'>function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script> 
<script type="text/javascript">

			var SocialSnapURL 				= window.location.href;
			var SocialSnapShareCacheExpired = 0;
				
			if ( -1 !== SocialSnapURL.indexOf('?ss_cache_refresh') ) {

				SocialSnapShareCacheExpired = true;

			} else {

				var SocialSnapServerTimestamp 	= 1657190865;
				var SocialSnapBrowserTimestamp 	= Date.now();

				if ( ! SocialSnapBrowserTimestamp ) {
					SocialSnapBrowserTimestamp = new Date().getTime();
				}

				SocialSnapBrowserTimestamp = Math.floor( SocialSnapBrowserTimestamp / 1000 );

				SocialSnapShareCacheExpired = SocialSnapShareCacheExpired && ( SocialSnapBrowserTimestamp - SocialSnapServerTimestamp < 60 );
			}

		</script>

<div id="cookie-notice" role="banner" class="cn-bottom bootstrap" style="color: #fff; background-color: #000;"><div class="cookie-notice-container"><span id="cn-notice-text">We use cookies to ensure that we give you the best experience on our website. The Cookies collected are used only to Show customized Ads. We Hope you are fine with it.</span><a href="#" id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button bootstrap button">Ok</a><a href="../../cookie-policy/index.html" target="_blank" id="cn-more-info" class="cn-more-info cn-button bootstrap button">Privacy policy</a>
</div>
</div>
</body>
</html>
